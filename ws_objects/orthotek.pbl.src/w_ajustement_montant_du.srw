$PBExportHeader$w_ajustement_montant_du.srw
forward
global type w_ajustement_montant_du from w_child
end type
type ole_pb from olecustomcontrol within w_ajustement_montant_du
end type
type cb_2 from commandbutton within w_ajustement_montant_du
end type
type cb_1 from commandbutton within w_ajustement_montant_du
end type
type dw_factures_traitements from u_dw within w_ajustement_montant_du
end type
type dw_sommaire_paiement from u_dw within w_ajustement_montant_du
end type
type dw_traitements_patient from u_dw within w_ajustement_montant_du
end type
end forward

global type w_ajustement_montant_du from w_child
integer x = 727
integer y = 676
integer width = 1490
integer height = 328
boolean titlebar = false
boolean controlmenu = false
boolean minbox = false
boolean maxbox = false
boolean resizable = false
boolean border = false
boolean ib_isupdateable = false
ole_pb ole_pb
cb_2 cb_2
cb_1 cb_1
dw_factures_traitements dw_factures_traitements
dw_sommaire_paiement dw_sommaire_paiement
dw_traitements_patient dw_traitements_patient
end type
global w_ajustement_montant_du w_ajustement_montant_du

event open;//SQLCA
dw_factures_traitements.SetTransObject(SQLCA)
dw_sommaire_paiement.SetTransObject(SQLCA)
dw_traitements_patient.SetTransObject(SQLCA)

end event

on w_ajustement_montant_du.create
int iCurrent
call super::create
this.ole_pb=create ole_pb
this.cb_2=create cb_2
this.cb_1=create cb_1
this.dw_factures_traitements=create dw_factures_traitements
this.dw_sommaire_paiement=create dw_sommaire_paiement
this.dw_traitements_patient=create dw_traitements_patient
iCurrent=UpperBound(this.Control)
this.Control[iCurrent+1]=this.ole_pb
this.Control[iCurrent+2]=this.cb_2
this.Control[iCurrent+3]=this.cb_1
this.Control[iCurrent+4]=this.dw_factures_traitements
this.Control[iCurrent+5]=this.dw_sommaire_paiement
this.Control[iCurrent+6]=this.dw_traitements_patient
end on

on w_ajustement_montant_du.destroy
call super::destroy
destroy(this.ole_pb)
destroy(this.cb_2)
destroy(this.cb_1)
destroy(this.dw_factures_traitements)
destroy(this.dw_sommaire_paiement)
destroy(this.dw_traitements_patient)
end on

type ole_pb from olecustomcontrol within w_ajustement_montant_du
event mousemove ( integer button,  integer shift,  long ocx_x,  long ocx_y )
event mousedown ( integer button,  integer shift,  long ocx_x,  long ocx_y )
event mouseup ( integer button,  integer shift,  long ocx_x,  long ocx_y )
integer x = 23
integer y = 60
integer taborder = 20
borderstyle borderstyle = stylelowered!
string binarykey = "w_ajustement_montant_du.win"
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
end type

type cb_2 from commandbutton within w_ajustement_montant_du
integer x = 18
integer y = 188
integer width = 722
integer height = 108
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Lancer"
end type

event clicked;// Déclaration de variables
long nb_enr, i
dec{2} v_montant_paye, v_montant
//Nombre enregistrements
dw_traitements_patient.retrieve()
nb_enr = dw_traitements_patient.rowcount()
//ole_pb.object.maxvalue = nb_enr
dw_traitements_patient.scrolltorow(1)
// Calcul montants
for i = 1 to nb_enr
//	ole_pb.object.value = i
	if dw_factures_traitements.rowcount() > 0 then
		if dw_sommaire_paiement.rowcount() > 0 then
			v_montant_paye = dw_sommaire_paiement.object.total_recus[1]
			dw_traitements_patient.setitem(i,"montant_paye",v_montant_paye)
		else
			v_montant_paye = 0
		end if
		v_montant = dw_factures_traitements.object.total_factures[1]
		dw_traitements_patient.setitem(i,"montant_du",v_montant - v_montant_paye)
	end if
	dw_traitements_patient.scrollnextrow()
next
if dw_traitements_patient.Update() = 1 then
	commit using SQLCA;
	messagebox("Ajustement","Ajustement montant du effectué!!!")
else
	rollback using SQLCA;
	messagebox("Information","Aucune modification n'a été enregistrée!",information!)
end if
end event

type cb_1 from commandbutton within w_ajustement_montant_du
integer x = 741
integer y = 188
integer width = 722
integer height = 108
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Fermer"
end type

event clicked;close(parent)
end event

type dw_factures_traitements from u_dw within w_ajustement_montant_du
boolean visible = false
integer x = 736
integer y = 24
integer width = 187
integer height = 164
integer taborder = 60
string dataobject = "d_factures_traitements_aj"
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

type dw_sommaire_paiement from u_dw within w_ajustement_montant_du
boolean visible = false
integer x = 439
integer y = 24
integer width = 283
integer height = 164
integer taborder = 50
string dataobject = "d_sommaire_paiement"
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

type dw_traitements_patient from u_dw within w_ajustement_montant_du
boolean visible = false
integer x = 27
integer y = 28
integer width = 370
integer height = 156
integer taborder = 10
string dataobject = "d_traitements_patient_ajustement"
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event rowfocuschanged;// Inititalisation
long id
// Numero d'enregistrement
// N'entre pas dans le IF si nouvel enr et aucun enr
// Mise-à-jour des DW
if dw_traitements_patient.rowcount() > 0 then 
	id = dw_traitements_patient.getitemnumber(dw_traitements_patient.getrow(),"traitement_id")
	if id > 0 then
		// Retrieve
		dw_factures_traitements.retrieve(id)
		dw_sommaire_paiement.retrieve(id)
		// Propriété Enabled des boutons ajustée
	end if
end if
end event


Start of PowerBuilder Binary Data Section : Do NOT Edit
05w_ajustement_montant_du.bin 
2F00001a00e011cfd0e11ab1a1000000000000000000000000000000000003003e0009fffe000000060000000000000000000000010000000100000000000010000000000200000001fffffffe0000000000000000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd00000004fffffffe00000005fffffffe000000060000000700000008000000090000000a0000000bfffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff006f00520074006f004500200074006e00790072000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050016ffffffffffffffff000000010000000000000000000000000000000000000000000000000000000078ef9b4001c5f5bd0000000300000f800000000000500003004f0042005800430054005300450052004d0041000000000000000000000000000000000000000000000000000000000000000000000000000000000102001affffffff00000002ffffffff000000000000000000000000000000000000000000000000000000000000000000000000fffffffe0000000000000000004200500043004f00530058004f00540041005200450047000000000000000000000000000000000000000000000000000000000000000000000000000000000001001affffffffffffffff00000004f86ff34511ceee4a7d9cfc9d19c9b2370000000078ef9b4001c5f5bd78ef9b4001c5f5bd000000000000000000000000004f00010065006c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000affffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000001400000000fffffffe00000002fffffffe0000000400000005000000060000000700000008000000090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d0000001e0000001f000000200000002100000022000000230000002400000025000000260000002700000028000000290000002a0000002b0000002c0000002d0000002e0000002f000000300000003100000032000000330000003400000035000000360000003700000038000000390000003a0000003b0000003c0000003dfffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
28ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff02000001000000000000000000000000000000000065007200750074006e007200200073006f006c0067006e005b002000620070005f006d007200640067006100010000000020740000022c00000044e3520300ce8f910b00e39d11b84b00aa00000151c00190000d0001d45320534d20736e6169726553ffff01660064000000000000ffffff01ff000000808080000000000000750000006e007200200073006f006c0067006e005b002000620070005f006d00720064006700610065006cffffffff000000030000000400000004ffffffff0000000700000000000004220000066800000e5e00090001072f03000001000000000621000400000103000000050008020b00000000000000000005003e020c000500280201000000ffffff00000005000002090004000001070000006500010b410000008800c600200020000000000020002000040000000000280000002000000020000100010000000000000000000000000000000000000000000000000000000000ffffffffffffff030000fc030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8030000f8070000f80f0000f81f0000f83f0000f87f0000f8ff0000f8ff0100f8ff0300f800000004006f00430074006e006e006500730074000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010200120000000300000005ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000010000005500000000004f00020065006c007200500073006500300030000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000020018ffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000300000e86000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010107000000050001020900050000020100000000000100000005ffff0201000500ff020900000000000000000004000301070000062100460b41002000660000002000200000000000200028000400200000002000000001000000000018000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffff
2Bffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffff7f7f7f00000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000ff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000ffffffffffffffffffffffffff007f7f7f0000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000ffffffffffffffffff7f7f7fff000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000ffffffffff7f7fffff0000007f000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000ff7fffffff00007f7f0000000000000000000000000000000000000000000000000000000000000000
280000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000ff007f7f7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000010700000005000102090000000000010000000500010201000a0000062600000009000f6e6f6349796c6e4f000500000209000000000000000000040001010200000014fff602fb000000050190000000000000200200005320534d20736e616972655300040066000000040000012d000000040006012e0000000b00240a320000001400000004002800000004003e012e00000013000106260000001c000f575c3a434f444e49535c5357455453594c4f5c4d2e323345004c4c4400000006000f06260030000200000003007500000074006c00200073002000290072002000740065007200750073006e006900200074006e006700650072006500700000006300660076005f006c00610064006900740061006f00690020006e00200028006f007000650077006f0072006a0062006300650020007400700061005f006f006f00630074006e006f0072005b006c0020005d002000290072002000740065007200750073006e006900200074006e006700650072006500700000006300660061005f0063006300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
15w_ajustement_montant_du.bin 
End of PowerBuilder Binary Data Section : No Source Expected After This Point
