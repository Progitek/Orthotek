$PBExportHeader$m_principal.srm
forward
global type m_principal from menu
end type
type m_app from menu within m_principal
end type
type m_listecontacts from menu within m_app
end type
type m_listerappels from menu within m_app
end type
type m_listedossier from menu within m_app
end type
type m_listeboite from menu within m_app
end type
type m_horaire from menu within m_app
end type
type m_listeanniversaires from menu within m_app
end type
type m_listpatsarchive from menu within m_app
end type
type m_journalevents from menu within m_app
end type
type m_moniteur from menu within m_app
end type
type m_console from menu within m_app
end type
type m_console2 from menu within m_app
end type
type m_imagerie from menu within m_app
end type
type m_cincout from menu within m_app
end type
type m_patterm from menu within m_app
end type
type m_listenoire from menu within m_app
end type
type m_enremp from menu within m_app
end type
type m_feuilledemployees from menu within m_app
end type
type m_- from menu within m_app
end type
type m_backup from menu within m_app
end type
type m_quitter from menu within m_app
end type
type m_app from menu within m_principal
m_listecontacts m_listecontacts
m_listerappels m_listerappels
m_listedossier m_listedossier
m_listeboite m_listeboite
m_horaire m_horaire
m_listeanniversaires m_listeanniversaires
m_listpatsarchive m_listpatsarchive
m_journalevents m_journalevents
m_moniteur m_moniteur
m_console m_console
m_console2 m_console2
m_imagerie m_imagerie
m_cincout m_cincout
m_patterm m_patterm
m_listenoire m_listenoire
m_enremp m_enremp
m_feuilledemployees m_feuilledemployees
m_- m_-
m_backup m_backup
m_quitter m_quitter
end type
type m_affichage from menu within m_principal
end type
type m_-0 from menu within m_affichage
end type
type m_affichage from menu within m_principal
m_-0 m_-0
end type
type m_correspondance from menu within m_principal
end type
type m_labels from menu within m_correspondance
end type
type m_ententefin from menu within m_correspondance
end type
type m_ententefin2 from menu within m_correspondance
end type
type m_questmed from menu within m_correspondance
end type
type m_lettrespat from menu within m_correspondance
end type
type m_lettresref from menu within m_correspondance
end type
type m_lettresdet from menu within m_correspondance
end type
type m_billetabs from menu within m_correspondance
end type
type m_assurance from menu within m_correspondance
end type
type m_ref from menu within m_correspondance
end type
type m_dentistes from menu within m_correspondance
end type
type m_lettrefusion from menu within m_correspondance
end type
type m_formtransfert from menu within m_correspondance
end type
type m_traiturg from menu within m_correspondance
end type
type m_corrletter from menu within m_correspondance
end type
type m_questionnaire from menu within m_correspondance
end type
type m_listetraitementrequisnonsigne from menu within m_correspondance
end type
type m_correspondance from menu within m_principal
m_labels m_labels
m_ententefin m_ententefin
m_ententefin2 m_ententefin2
m_questmed m_questmed
m_lettrespat m_lettrespat
m_lettresref m_lettresref
m_lettresdet m_lettresdet
m_billetabs m_billetabs
m_assurance m_assurance
m_ref m_ref
m_dentistes m_dentistes
m_lettrefusion m_lettrefusion
m_formtransfert m_formtransfert
m_traiturg m_traiturg
m_corrletter m_corrletter
m_questionnaire m_questionnaire
m_listetraitementrequisnonsigne m_listetraitementrequisnonsigne
end type
type m_stat from menu within m_principal
end type
type m_mref from menu within m_stat
end type
type m_rapportdespatientsparréférent from menu within m_mref
end type
type m_listeref from menu within m_mref
end type
type m_listerefopendoss from menu within m_mref
end type
type m_mref from menu within m_stat
m_rapportdespatientsparréférent m_rapportdespatientsparréférent
m_listeref m_listeref
m_listerefopendoss m_listerefopendoss
end type
type m_dentist from menu within m_stat
end type
type m_rapportdespatientspardentiste from menu within m_dentist
end type
type m_listedentdebtrait from menu within m_dentist
end type
type m_listedendateouvdos from menu within m_dentist
end type
type m_dentist from menu within m_stat
m_rapportdespatientspardentiste m_rapportdespatientspardentiste
m_listedentdebtrait m_listedentdebtrait
m_listedendateouvdos m_listedendateouvdos
end type
type m_consultation from menu within m_stat
end type
type m_consbaserdv from menu within m_consultation
end type
type m_consbasefact from menu within m_consultation
end type
type m_consultation from menu within m_stat
m_consbaserdv m_consbaserdv
m_consbasefact m_consbasefact
end type
type m_mstatuts from menu within m_stat
end type
type m_statutpat from menu within m_mstatuts
end type
type m_patstatuts from menu within m_mstatuts
end type
type m_rapporannuelstatuts from menu within m_mstatuts
end type
type m_rapportannueletatsdoss from menu within m_mstatuts
end type
type m_stats1 from menu within m_mstatuts
end type
type m_mstatuts from menu within m_stat
m_statutpat m_statutpat
m_patstatuts m_patstatuts
m_rapporannuelstatuts m_rapporannuelstatuts
m_rapportannueletatsdoss m_rapportannueletatsdoss
m_stats1 m_stats1
end type
type m_mfinances from menu within m_stat
end type
type m_productivitecomparative from menu within m_mfinances
end type
type m_statprod from menu within m_mfinances
end type
type m_listetraitement from menu within m_mfinances
end type
type m_historiquefinancier from menu within m_mfinances
end type
type m_mfinances from menu within m_stat
m_productivitecomparative m_productivitecomparative
m_statprod m_statprod
m_listetraitement m_listetraitement
m_historiquefinancier m_historiquefinancier
end type
type m_mrdv from menu within m_stat
end type
type m_listerdvpat from menu within m_mrdv
end type
type m_patsansrdv from menu within m_mrdv
end type
type m_listedespatientsparphase from menu within m_mrdv
end type
type m_listedesrdvconsultation from menu within m_mrdv
end type
type m_listedesdiagnostics from menu within m_mrdv
end type
type m_listedesmisesenbouches from menu within m_mrdv
end type
type m_dureetrait from menu within m_mrdv
end type
type m_listepatproc from menu within m_mrdv
end type
type m_etatdesrendez-vous from menu within m_mrdv
end type
type m_listspatpers from menu within m_mrdv
end type
type m_1 from menu within m_mrdv
end type
type m_listedespatientsparopérateur from menu within m_mrdv
end type
type m_mrdv from menu within m_stat
m_listerdvpat m_listerdvpat
m_patsansrdv m_patsansrdv
m_listedespatientsparphase m_listedespatientsparphase
m_listedesrdvconsultation m_listedesrdvconsultation
m_listedesdiagnostics m_listedesdiagnostics
m_listedesmisesenbouches m_listedesmisesenbouches
m_dureetrait m_dureetrait
m_listepatproc m_listepatproc
m_etatdesrendez-vous m_etatdesrendez-vous
m_listspatpers m_listspatpers
m_1 m_1
m_listedespatientsparopérateur m_listedespatientsparopérateur
end type
type m_patients from menu within m_stat
end type
type m_suividespatients from menu within m_patients
end type
type m_listedespatientsparsatellites from menu within m_patients
end type
type m_2 from menu within m_patients
end type
type m_listpatage from menu within m_patients
end type
type m_nbrepatcp from menu within m_patients
end type
type m_patients from menu within m_stat
m_suividespatients m_suividespatients
m_listedespatientsparsatellites m_listedespatientsparsatellites
m_2 m_2
m_listpatage m_listpatage
m_nbrepatcp m_nbrepatcp
end type
type m_etatdossier from menu within m_stat
end type
type m_patientparetatdossier from menu within m_etatdossier
end type
type m_etatdossier from menu within m_stat
m_patientparetatdossier m_patientparetatdossier
end type
type m_statistiquepatient from menu within m_stat
end type
type m_employees from menu within m_stat
end type
type m_feuillesdetemps from menu within m_employees
end type
type m_employees from menu within m_stat
m_feuillesdetemps m_feuillesdetemps
end type
type m_corresp from menu within m_stat
end type
type m_listdocnonbarre from menu within m_corresp
end type
type m_corresp from menu within m_stat
m_listdocnonbarre m_listdocnonbarre
end type
type m_stat from menu within m_principal
m_mref m_mref
m_dentist m_dentist
m_consultation m_consultation
m_mstatuts m_mstatuts
m_mfinances m_mfinances
m_mrdv m_mrdv
m_patients m_patients
m_etatdossier m_etatdossier
m_statistiquepatient m_statistiquepatient
m_employees m_employees
m_corresp m_corresp
end type
type m_fonctionscomptable from menu within m_principal
end type
type m_dossfin from menu within m_fonctionscomptable
end type
type m_revenus from menu within m_fonctionscomptable
end type
type m_journaldeshonoraires from menu within m_revenus
end type
type m_chquespostdats from menu within m_revenus
end type
type m_journaldesencaissements from menu within m_revenus
end type
type m_journaldesrevenus from menu within m_revenus
end type
type m_jrevenuscomb from menu within m_revenus
end type
type m_listecomparative from menu within m_revenus
end type
type m_listecompper from menu within m_revenus
end type
type m_revenus from menu within m_fonctionscomptable
m_journaldeshonoraires m_journaldeshonoraires
m_chquespostdats m_chquespostdats
m_journaldesencaissements m_journaldesencaissements
m_journaldesrevenus m_journaldesrevenus
m_jrevenuscomb m_jrevenuscomb
m_listecomparative m_listecomparative
m_listecompper m_listecompper
end type
type m_depots from menu within m_fonctionscomptable
end type
type m_journaldepot from menu within m_depots
end type
type m_depotlot from menu within m_depots
end type
type m_journaldepotscompact from menu within m_depots
end type
type m_journaldepotscpd from menu within m_depots
end type
type m_journaldepotanc from menu within m_depots
end type
type m_depots from menu within m_fonctionscomptable
m_journaldepot m_journaldepot
m_depotlot m_depotlot
m_journaldepotscompact m_journaldepotscompact
m_journaldepotscpd m_journaldepotscpd
m_journaldepotanc m_journaldepotanc
end type
type m_recevables from menu within m_fonctionscomptable
end type
type m_agedescomptes from menu within m_recevables
end type
type m_etatdecompte from menu within m_recevables
end type
type m_comptesrecevables from menu within m_recevables
end type
type m_comptesrecsoldeant from menu within m_recevables
end type
type m_comptesclients from menu within m_recevables
end type
type m_paiementsouffrance from menu within m_recevables
end type
type m_comptepercevoir from menu within m_recevables
end type
type m_recevables from menu within m_fonctionscomptable
m_agedescomptes m_agedescomptes
m_etatdecompte m_etatdecompte
m_comptesrecevables m_comptesrecevables
m_comptesrecsoldeant m_comptesrecsoldeant
m_comptesclients m_comptesclients
m_paiementsouffrance m_paiementsouffrance
m_comptepercevoir m_comptepercevoir
end type
type m_pourc from menu within m_fonctionscomptable
end type
type m_entrer from menu within m_pourc
end type
type m_pourcentages from menu within m_pourc
end type
type m_pourcentagebasésurcoûtdutraitement from menu within m_pourc
end type
type m_pourc from menu within m_fonctionscomptable
m_entrer m_entrer
m_pourcentages m_pourcentages
m_pourcentagebasésurcoûtdutraitement m_pourcentagebasésurcoûtdutraitement
end type
type m_rapports from menu within m_fonctionscomptable
end type
type m_taxform from menu within m_rapports
end type
type m_nonzerodueamount from menu within m_rapports
end type
type m_rapportdumois from menu within m_rapports
end type
type m_rapportnsf from menu within m_rapports
end type
type m_rappcred from menu within m_rapports
end type
type m_raptrait from menu within m_rapports
end type
type m_nonzerobalance from menu within m_rapports
end type
type m_rapports from menu within m_fonctionscomptable
m_taxform m_taxform
m_nonzerodueamount m_nonzerodueamount
m_rapportdumois m_rapportdumois
m_rapportnsf m_rapportnsf
m_rappcred m_rappcred
m_raptrait m_raptrait
m_nonzerobalance m_nonzerobalance
end type
type m_fonctionscomptable from menu within m_principal
m_dossfin m_dossfin
m_revenus m_revenus
m_depots m_depots
m_recevables m_recevables
m_pourc m_pourc
m_rapports m_rapports
end type
type m_couleurs from menu within m_principal
end type
type m_parametres from menu within m_principal
end type
type m_dosspat from menu within m_parametres
end type
type m_activites from menu within m_dosspat
end type
type m_satellites from menu within m_dosspat
end type
type m_familles from menu within m_dosspat
end type
type m_dosspat from menu within m_parametres
m_activites m_activites
m_satellites m_satellites
m_familles m_familles
end type
type m_corr from menu within m_parametres
end type
type m_condtrait from menu within m_corr
end type
type m_typesal from menu within m_corr
end type
type m_typecontact from menu within m_corr
end type
type m_intro-conc from menu within m_corr
end type
type m_listedecourrielprédéfini from menu within m_corr
end type
type m_contrat from menu within m_corr
end type
type m_sujet from menu within m_corr
end type
type m_plantrait from menu within m_corr
end type
type m_odontogrammetype from menu within m_corr
end type
type m_questionnaire0 from menu within m_corr
end type
type m_corr from menu within m_parametres
m_condtrait m_condtrait
m_typesal m_typesal
m_typecontact m_typecontact
m_intro-conc m_intro-conc
m_listedecourrielprédéfini m_listedecourrielprédéfini
m_contrat m_contrat
m_sujet m_sujet
m_plantrait m_plantrait
m_odontogrammetype m_odontogrammetype
m_questionnaire0 m_questionnaire0
end type
type m_comp from menu within m_parametres
end type
type m_typephase from menu within m_comp
end type
type m_listestatuts from menu within m_comp
end type
type m_etatpat from menu within m_comp
end type
type m_comp from menu within m_parametres
m_typephase m_typephase
m_listestatuts m_listestatuts
m_etatpat m_etatpat
end type
type m_horaire0 from menu within m_parametres
end type
type m_typestrait from menu within m_horaire0
end type
type m_typesrappels from menu within m_horaire0
end type
type m_procedures from menu within m_horaire0
end type
type m_horaire0 from menu within m_parametres
m_typestrait m_typestrait
m_typesrappels m_typesrappels
m_procedures m_procedures
end type
type m_cartedetraitement from menu within m_parametres
end type
type m_categoriedephrases from menu within m_cartedetraitement
end type
type m_typesdappareils from menu within m_cartedetraitement
end type
type m_instructiondappareil from menu within m_cartedetraitement
end type
type m_typesderadiographies from menu within m_cartedetraitement
end type
type m_typesdefils from menu within m_cartedetraitement
end type
type m_typematpourfil from menu within m_cartedetraitement
end type
type m_dureeelastiques from menu within m_cartedetraitement
end type
type m_forceselastiques from menu within m_cartedetraitement
end type
type m_typesdelastiques from menu within m_cartedetraitement
end type
type m_typesdempreintes from menu within m_cartedetraitement
end type
type m_cartedetraitement from menu within m_parametres
m_categoriedephrases m_categoriedephrases
m_typesdappareils m_typesdappareils
m_instructiondappareil m_instructiondappareil
m_typesderadiographies m_typesderadiographies
m_typesdefils m_typesdefils
m_typematpourfil m_typematpourfil
m_dureeelastiques m_dureeelastiques
m_forceselastiques m_forceselastiques
m_typesdelastiques m_typesdelastiques
m_typesdempreintes m_typesdempreintes
end type
type m_listespeciality from menu within m_parametres
end type
type m_parametres from menu within m_principal
m_dosspat m_dosspat
m_corr m_corr
m_comp m_comp
m_horaire0 m_horaire0
m_cartedetraitement m_cartedetraitement
m_listespeciality m_listespeciality
end type
type m_util from menu within m_principal
end type
type m_connectionsupport from menu within m_util
end type
type m_imprecusauto from menu within m_util
end type
type m_impformulaires from menu within m_util
end type
type m_logs from menu within m_util
end type
type m_fournisseurs from menu within m_util
end type
type m_exportacomba from menu within m_util
end type
type m_refreshrdv from menu within m_util
end type
type m_ftpbackup from menu within m_util
end type
type m_caller from menu within m_util
end type
type m_migration from menu within m_util
end type
type m_orthocom from menu within m_migration
end type
type m_focus from menu within m_migration
end type
type m_ctrl from menu within m_migration
end type
type m_ad2000 from menu within m_migration
end type
type m_autre from menu within m_migration
end type
type m_migration from menu within m_util
m_orthocom m_orthocom
m_focus m_focus
m_ctrl m_ctrl
m_ad2000 m_ad2000
m_autre m_autre
end type
type m_exportationverssimplecomptable from menu within m_util
end type
type m_moneris from menu within m_util
end type
type m_exportationversorthocom from menu within m_util
end type
type m_systemedemessagerie from menu within m_util
end type
type m_boîtederéception from menu within m_systemedemessagerie
end type
type m_ecrireunnouveaumessage from menu within m_systemedemessagerie
end type
type m_systemedemessagerie from menu within m_util
m_boîtederéception m_boîtederéception
m_ecrireunnouveaumessage m_ecrireunnouveaumessage
end type
type m_envoidedébitspréautorisés from menu within m_util
end type
type m_util from menu within m_principal
m_connectionsupport m_connectionsupport
m_imprecusauto m_imprecusauto
m_impformulaires m_impformulaires
m_logs m_logs
m_fournisseurs m_fournisseurs
m_exportacomba m_exportacomba
m_refreshrdv m_refreshrdv
m_ftpbackup m_ftpbackup
m_caller m_caller
m_migration m_migration
m_exportationverssimplecomptable m_exportationverssimplecomptable
m_moneris m_moneris
m_exportationversorthocom m_exportationversorthocom
m_systemedemessagerie m_systemedemessagerie
m_envoidedébitspréautorisés m_envoidedébitspréautorisés
end type
type m_config from menu within m_principal
end type
type m_gestionimprimantes from menu within m_config
end type
type m_options from menu within m_config
end type
type m_optionspersonnel from menu within m_config
end type
type m_autoupdate from menu within m_config
end type
type m_nouveautes from menu within m_config
end type
type m_edit from menu within m_config
end type
type m_gestionpers from menu within m_edit
end type
type m_groupes from menu within m_edit
end type
type m_persbarreoutils from menu within m_edit
end type
type m_entrerortho from menu within m_edit
end type
type m_couleurs0 from menu within m_edit
end type
type m_labeledit from menu within m_edit
end type
type m_générateurderapport from menu within m_edit
end type
type m_edit from menu within m_config
m_gestionpers m_gestionpers
m_groupes m_groupes
m_persbarreoutils m_persbarreoutils
m_entrerortho m_entrerortho
m_couleurs0 m_couleurs0
m_labeledit m_labeledit
m_générateurderapport m_générateurderapport
end type
type m_pwd from menu within m_config
end type
type m_passsupppat from menu within m_pwd
end type
type m_passlogon from menu within m_pwd
end type
type m_passpaie from menu within m_pwd
end type
type m_pwd from menu within m_config
m_passsupppat m_passsupppat
m_passlogon m_passlogon
m_passpaie m_passpaie
end type
type m_ftpbackupfolder from menu within m_config
end type
type m_registration from menu within m_config
end type
type m_cachefactpaie from menu within m_config
end type
type m_routinecachefactpaie from menu within m_config
end type
type m_promaintenance from menu within m_config
end type
type m_config from menu within m_principal
m_gestionimprimantes m_gestionimprimantes
m_options m_options
m_optionspersonnel m_optionspersonnel
m_autoupdate m_autoupdate
m_nouveautes m_nouveautes
m_edit m_edit
m_pwd m_pwd
m_ftpbackupfolder m_ftpbackupfolder
m_registration m_registration
m_cachefactpaie m_cachefactpaie
m_routinecachefactpaie m_routinecachefactpaie
m_promaintenance m_promaintenance
end type
type m_apropos from menu within m_principal
end type
type m_4 from menu within m_principal
end type
global type m_principal from menu
m_app m_app
m_affichage m_affichage
m_correspondance m_correspondance
m_stat m_stat
m_fonctionscomptable m_fonctionscomptable
m_couleurs m_couleurs
m_parametres m_parametres
m_util m_util
m_config m_config
m_apropos m_apropos
m_4 m_4
end type
end forward

global type m_principal from menu
m_app m_app
m_affichage m_affichage
m_correspondance m_correspondance
m_stat m_stat
m_fonctionscomptable m_fonctionscomptable
m_couleurs m_couleurs
m_parametres m_parametres
m_util m_util
m_config m_config
m_apropos m_apropos
m_4 m_4
end type
global m_principal m_principal

on m_principal.create
m_principal=this
call super::create
this.text = "m_principal1"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_app=create m_app
this.m_affichage=create m_affichage
this.m_correspondance=create m_correspondance
this.m_stat=create m_stat
this.m_fonctionscomptable=create m_fonctionscomptable
this.m_couleurs=create m_couleurs
this.m_parametres=create m_parametres
this.m_util=create m_util
this.m_config=create m_config
this.m_apropos=create m_apropos
this.m_4=create m_4
this.Item[UpperBound(this.Item)+1]=this.m_app
this.Item[UpperBound(this.Item)+1]=this.m_affichage
this.Item[UpperBound(this.Item)+1]=this.m_correspondance
this.Item[UpperBound(this.Item)+1]=this.m_stat
this.Item[UpperBound(this.Item)+1]=this.m_fonctionscomptable
this.Item[UpperBound(this.Item)+1]=this.m_couleurs
this.Item[UpperBound(this.Item)+1]=this.m_parametres
this.Item[UpperBound(this.Item)+1]=this.m_util
this.Item[UpperBound(this.Item)+1]=this.m_config
this.Item[UpperBound(this.Item)+1]=this.m_apropos
this.Item[UpperBound(this.Item)+1]=this.m_4
end on

on m_principal.destroy
call super::destroy
destroy(this.m_app)
destroy(this.m_affichage)
destroy(this.m_correspondance)
destroy(this.m_stat)
destroy(this.m_fonctionscomptable)
destroy(this.m_couleurs)
destroy(this.m_parametres)
destroy(this.m_util)
destroy(this.m_config)
destroy(this.m_apropos)
destroy(this.m_4)
end on

event clicked;opensheet(w_migctrl,w_principal,2,layered!)
w_migctrl.title = "Migration CTRL"
end event

type m_app from menu within m_principal
m_listecontacts m_listecontacts
m_listerappels m_listerappels
m_listedossier m_listedossier
m_listeboite m_listeboite
m_horaire m_horaire
m_listeanniversaires m_listeanniversaires
m_listpatsarchive m_listpatsarchive
m_journalevents m_journalevents
m_moniteur m_moniteur
m_console m_console
m_console2 m_console2
m_imagerie m_imagerie
m_cincout m_cincout
m_patterm m_patterm
m_listenoire m_listenoire
m_enremp m_enremp
m_feuilledemployees m_feuilledemployees
m_- m_-
m_backup m_backup
m_quitter m_quitter
end type

on m_app.create
call super::create
this.text = "Général"
this.microhelp = "Général"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.menutitletext = "general"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_listecontacts=create m_listecontacts
this.m_listerappels=create m_listerappels
this.m_listedossier=create m_listedossier
this.m_listeboite=create m_listeboite
this.m_horaire=create m_horaire
this.m_listeanniversaires=create m_listeanniversaires
this.m_listpatsarchive=create m_listpatsarchive
this.m_journalevents=create m_journalevents
this.m_moniteur=create m_moniteur
this.m_console=create m_console
this.m_console2=create m_console2
this.m_imagerie=create m_imagerie
this.m_cincout=create m_cincout
this.m_patterm=create m_patterm
this.m_listenoire=create m_listenoire
this.m_enremp=create m_enremp
this.m_feuilledemployees=create m_feuilledemployees
this.m_-=create m_-
this.m_backup=create m_backup
this.m_quitter=create m_quitter
this.Item[UpperBound(this.Item)+1]=this.m_listecontacts
this.Item[UpperBound(this.Item)+1]=this.m_listerappels
this.Item[UpperBound(this.Item)+1]=this.m_listedossier
this.Item[UpperBound(this.Item)+1]=this.m_listeboite
this.Item[UpperBound(this.Item)+1]=this.m_horaire
this.Item[UpperBound(this.Item)+1]=this.m_listeanniversaires
this.Item[UpperBound(this.Item)+1]=this.m_listpatsarchive
this.Item[UpperBound(this.Item)+1]=this.m_journalevents
this.Item[UpperBound(this.Item)+1]=this.m_moniteur
this.Item[UpperBound(this.Item)+1]=this.m_console
this.Item[UpperBound(this.Item)+1]=this.m_console2
this.Item[UpperBound(this.Item)+1]=this.m_imagerie
this.Item[UpperBound(this.Item)+1]=this.m_cincout
this.Item[UpperBound(this.Item)+1]=this.m_patterm
this.Item[UpperBound(this.Item)+1]=this.m_listenoire
this.Item[UpperBound(this.Item)+1]=this.m_enremp
this.Item[UpperBound(this.Item)+1]=this.m_feuilledemployees
this.Item[UpperBound(this.Item)+1]=this.m_-
this.Item[UpperBound(this.Item)+1]=this.m_backup
this.Item[UpperBound(this.Item)+1]=this.m_quitter
end on

on m_app.destroy
call super::destroy
destroy(this.m_listecontacts)
destroy(this.m_listerappels)
destroy(this.m_listedossier)
destroy(this.m_listeboite)
destroy(this.m_horaire)
destroy(this.m_listeanniversaires)
destroy(this.m_listpatsarchive)
destroy(this.m_journalevents)
destroy(this.m_moniteur)
destroy(this.m_console)
destroy(this.m_console2)
destroy(this.m_imagerie)
destroy(this.m_cincout)
destroy(this.m_patterm)
destroy(this.m_listenoire)
destroy(this.m_enremp)
destroy(this.m_feuilledemployees)
destroy(this.m_-)
destroy(this.m_backup)
destroy(this.m_quitter)
end on

type m_listecontacts from menu within m_app
end type

event clicked;if v_no_ortho > 0 then
	OpenSheet(w_contacts,w_principal,2,layered!)
	w_contacts.title = "Liste des contact"
else
	error_type(54)
end if
end event

on m_listecontacts.create
call super::create
this.text = "Liste des contacts"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listecontacts.destroy
call super::destroy
end on

type m_listerappels from menu within m_app
event clicked ( )
end type

event clicked;if v_no_ortho > 0 then
	OpenSheet(w_liste_des_rappels_retentions,w_principal,2,layered!)
	w_liste_des_rappels_retentions.title = "Liste des rappels"
else
	error_type(54)
end if

end event

on m_listerappels.create
call super::create
this.text = "&Liste des rappels rétention~tCtrl+L"
this.shortcut = 332
this.microhelp = "Liste des rappels rétention"
this.toolbaritemname = "Report5!"
this.toolbaritemtext = "Rappels"
this.toolbaritemorder = 3
this.menuimage = "Report5!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listerappels.destroy
call super::destroy
end on

type m_listedossier from menu within m_app
event clicked ( )
end type

event clicked;if v_no_ortho > 0 then
	OpenSheet(w_liste_no_dossier,w_principal,2,layered!)
	w_liste_no_dossier.title = "Liste des numéros de dossier"
else
	error_type(54)
end if
end event

on m_listedossier.create
call super::create
this.text = "Liste des numéros de &dossier~tCtrl+D"
this.shortcut = 324
this.microhelp = "Liste des numéros de dossier"
this.toolbaritemtext = "Liste des numéros de dossier"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listedossier.destroy
call super::destroy
end on

type m_listeboite from menu within m_app
end type

event clicked;if v_no_ortho > 0 then
	OpenSheet(w_listenoboite,w_principal,2,layered!)
	w_listenoboite.title = "Liste des numéros de boîte"
else
	error_type(54)
end if
end event

on m_listeboite.create
call super::create
this.text = "Liste des numéros de boîte"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listeboite.destroy
call super::destroy
end on

type m_horaire from menu within m_app
event clicked ( )
end type

event clicked;integer vartest
setnull(vartest)
if v_no_ortho > 0 then
	opensheetwithparm(w_horaire,string(today()),w_principal,2,layered!)
	w_principal.SetMicroHelp('Grille horaire')
else
	error_type(105)
end if


end event

on m_horaire.create
call super::create
this.text = "&Grille des rendez-vous~tCtrl+G"
this.shortcut = 327
this.microhelp = "Grille des rendez-vous"
this.toolbaritemname = "custom023!"
this.toolbaritemtext = "Horaire"
this.toolbaritemorder = 2
this.menuimage = "Custom023!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_horaire.destroy
call super::destroy
end on

type m_listeanniversaires from menu within m_app
event clicked ( )
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	opensheet(w_liste_anniversaires,w_principal,2,layered!)
	w_liste_anniversaires.title = "Liste des anniversaires"
else
	error_type(54)
end if
end event

on m_listeanniversaires.create
call super::create
this.text = "Liste des anniversaires~tCtrl+B"
this.shortcut = 322
this.microhelp = "Liste des anniversaires"
this.toolbaritemvisible = false
this.toolbaritemname = "how!"
this.toolbaritemtext = "Anniversaires"
this.toolbaritemorder = 6
this.menuimage = "HOW!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listeanniversaires.destroy
call super::destroy
end on

type m_listpatsarchive from menu within m_app
event clicked ( )
end type

event clicked;opensheet(w_patarchiver,w_principal,2,layered!)
w_patarchiver.SetMicroHelp('Patients archivés')
end event

on m_listpatsarchive.create
call super::create
this.text = "Liste des patients archivés"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listpatsarchive.destroy
call super::destroy
end on

type m_journalevents from menu within m_app
end type

event clicked;opensheet(w_events,w_principal,2,layered!)
w_events.title = "Journal des événements"
end event

on m_journalevents.create
call super::create
this.text = "Journal des événements"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_journalevents.destroy
call super::destroy
end on

type m_moniteur from menu within m_app
end type

event clicked;opensheet(w_cincoutmonitor,w_principal,2,layered!)
w_cincoutmonitor.title = "Moniteur"

end event

on m_moniteur.create
call super::create
this.text = "Moniteur"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_moniteur.destroy
call super::destroy
end on

type m_console from menu within m_app
end type

event clicked;opensheet(w_cincoutconsole,w_principal,2,layered!)
w_cincoutconsole.title = "Moniteur"
end event

on m_console.create
call super::create
this.visible = false
this.text = "Console"
this.enabled = false
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_console.destroy
call super::destroy
end on

type m_console2 from menu within m_app
end type

on m_console2.create
call super::create
this.text = "Console avancée"
this.toolbaritemname = "tab!"
this.toolbaritemtext = "Console"
this.toolbaritemorder = 1
this.toolbaritemspace = 1
this.menuimage = "tab!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_console2.destroy
call super::destroy
end on

event clicked;long ll_hormodele

select isnull(hormodele,0) into :ll_hormodele from t_options where ortho_id = :v_no_ortho;

CHOOSE CASE ll_hormodele
	CASE 1,3,4
		opensheet(w_cincoutver2,w_principal,2,layered!)
		w_cincout.title = "Console avancé"
	CASE ELSE
		opensheet(w_cincout,w_principal,2,layered!)
		w_cincout.title = "Console avancé"
END CHOOSE
end event

type m_imagerie from menu within m_app
end type

event clicked;run('C:\Program Files\ACD Systems\ACDSee\acdsee.exe',maximized!)
end event

on m_imagerie.create
call super::create
this.text = "Imagerie"
this.enabled = false
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_imagerie.destroy
call super::destroy
end on

type m_cincout from menu within m_app
end type

event clicked;openwithparm(w_cincoutreg,v_no_ortho)
close(w_principal)
end event

on m_cincout.create
call super::create
this.text = "Cincout"
this.enabled = false
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_cincout.destroy
call super::destroy
end on

type m_patterm from menu within m_app
end type

event clicked;open(w_cincoutpatrelache)
end event

on m_patterm.create
call super::create
this.text = "Patient terminé"
this.microhelp = "Patient terminé"
this.toolbaritemvisible = false
this.toolbaritemname = "addwatch!"
this.toolbaritemtext = "Patient"
this.toolbaritemorder = 10
this.menuimage = "addwatch!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_patterm.destroy
call super::destroy
end on

type m_listenoire from menu within m_app
end type

on m_listenoire.create
call super::create
this.text = "Liste noire"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listenoire.destroy
call super::destroy
end on

event clicked;opensheet(w_blacklist,w_principal,2,layered!)
if v_langue = 'an' then
	w_blacklist.title = 'Black list'
else
	w_blacklist.title = 'Liste noire'
end if
end event

type m_enremp from menu within m_app
end type

event clicked;//open(w_enremp, w_principal)
opensheet(w_biopunch,w_principal,2,layered!)

end event

on m_enremp.create
call super::create
this.text = "Enregistrement des employés"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_enremp.destroy
call super::destroy
end on

type m_feuilledemployees from menu within m_app
end type

on m_feuilledemployees.create
call super::create
this.text = "Feuille de temps employé(es)"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_feuilledemployees.destroy
call super::destroy
end on

event clicked;opensheet(w_feuillestempsemp,w_principal,2,layered!)
end event

type m_- from menu within m_app
end type

on m_-.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_-.destroy
call super::destroy
end on

type m_backup from menu within m_app
end type

event clicked;integer li_log
string ls_line,ls_command,ls_drive

select commandline,log,destdrive into :ls_command,:li_log,:ls_drive from t_backup;
if li_log = 1 then
	ls_line = string("dbbackup -y -x -c ~"" + ls_command + "~" " + ls_drive + ":\")
else
	ls_line = string("dbbackup -y -c ~"" + ls_command + "~" " + ls_drive + ":\")
end if
//messagebox('',string("dbbackup -y -c ~"" + ls_command + "~" " + ls_drive + ":\"))
if Run(ls_line) = 1 then
	update t_backup set datebackup = today();
	commit;
end if
end event

on m_backup.create
call super::create
this.text = "Backup"
this.toolbaritemname = "custom008!"
this.toolbaritemtext = "Backup"
this.toolbaritemorder = 60
this.toolbaritemspace = 1
this.menuimage = "custom008!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_backup.destroy
call super::destroy
end on

type m_quitter from menu within m_app
event clicked ( )
end type

event clicked;delete from t_transhoraire;
//Close (w_principal)
f_close()
end event

on m_quitter.create
call super::create
this.text = "Quitter"
this.microhelp = "Quitter"
this.toolbaritemvisible = false
this.toolbaritemname = "exit!"
this.toolbaritemtext = "Quitter"
this.toolbaritemorder = 71
this.toolbaritemspace = 2
this.menuimage = "Exit!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_quitter.destroy
call super::destroy
end on

type m_affichage from menu within m_principal
m_-0 m_-0
end type

on m_affichage.create
call super::create
this.text = "Affichage"
this.microhelp = "Affichage"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_-0=create m_-0
this.Item[UpperBound(this.Item)+1]=this.m_-0
end on

on m_affichage.destroy
call super::destroy
destroy(this.m_-0)
end on

type m_-0 from menu within m_affichage
end type

on m_-0.create
call super::create
this.text = "Fenêtres actives"
this.enabled = false
this.microhelp = "Fenêtres actives"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_-0.destroy
call super::destroy
end on

type m_correspondance from menu within m_principal
m_labels m_labels
m_ententefin m_ententefin
m_ententefin2 m_ententefin2
m_questmed m_questmed
m_lettrespat m_lettrespat
m_lettresref m_lettresref
m_lettresdet m_lettresdet
m_billetabs m_billetabs
m_assurance m_assurance
m_ref m_ref
m_dentistes m_dentistes
m_lettrefusion m_lettrefusion
m_formtransfert m_formtransfert
m_traiturg m_traiturg
m_corrletter m_corrletter
m_questionnaire m_questionnaire
m_listetraitementrequisnonsigne m_listetraitementrequisnonsigne
end type

on m_correspondance.create
call super::create
this.text = "Correspondances"
this.microhelp = "Correspondances"
this.menuitemtype = menuitemtypeabout!
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_labels=create m_labels
this.m_ententefin=create m_ententefin
this.m_ententefin2=create m_ententefin2
this.m_questmed=create m_questmed
this.m_lettrespat=create m_lettrespat
this.m_lettresref=create m_lettresref
this.m_lettresdet=create m_lettresdet
this.m_billetabs=create m_billetabs
this.m_assurance=create m_assurance
this.m_ref=create m_ref
this.m_dentistes=create m_dentistes
this.m_lettrefusion=create m_lettrefusion
this.m_formtransfert=create m_formtransfert
this.m_traiturg=create m_traiturg
this.m_corrletter=create m_corrletter
this.m_questionnaire=create m_questionnaire
this.m_listetraitementrequisnonsigne=create m_listetraitementrequisnonsigne
this.Item[UpperBound(this.Item)+1]=this.m_labels
this.Item[UpperBound(this.Item)+1]=this.m_ententefin
this.Item[UpperBound(this.Item)+1]=this.m_ententefin2
this.Item[UpperBound(this.Item)+1]=this.m_questmed
this.Item[UpperBound(this.Item)+1]=this.m_lettrespat
this.Item[UpperBound(this.Item)+1]=this.m_lettresref
this.Item[UpperBound(this.Item)+1]=this.m_lettresdet
this.Item[UpperBound(this.Item)+1]=this.m_billetabs
this.Item[UpperBound(this.Item)+1]=this.m_assurance
this.Item[UpperBound(this.Item)+1]=this.m_ref
this.Item[UpperBound(this.Item)+1]=this.m_dentistes
this.Item[UpperBound(this.Item)+1]=this.m_lettrefusion
this.Item[UpperBound(this.Item)+1]=this.m_formtransfert
this.Item[UpperBound(this.Item)+1]=this.m_traiturg
this.Item[UpperBound(this.Item)+1]=this.m_corrletter
this.Item[UpperBound(this.Item)+1]=this.m_questionnaire
this.Item[UpperBound(this.Item)+1]=this.m_listetraitementrequisnonsigne
end on

on m_correspondance.destroy
call super::destroy
destroy(this.m_labels)
destroy(this.m_ententefin)
destroy(this.m_ententefin2)
destroy(this.m_questmed)
destroy(this.m_lettrespat)
destroy(this.m_lettresref)
destroy(this.m_lettresdet)
destroy(this.m_billetabs)
destroy(this.m_assurance)
destroy(this.m_ref)
destroy(this.m_dentistes)
destroy(this.m_lettrefusion)
destroy(this.m_formtransfert)
destroy(this.m_traiturg)
destroy(this.m_corrletter)
destroy(this.m_questionnaire)
destroy(this.m_listetraitementrequisnonsigne)
end on

type m_labels from menu within m_correspondance
event clicked ( )
end type

event clicked;window activesheet
activesheet = w_principal.GetActiveSheet()
if w_patient.dw_details_patient.getrow() > 0 then
	if IsValid(activesheet) then
		if activesheet.title = "Liste des rappels" then
			OpensheetWithParm (w_etiquettes,w_liste_des_rappels_retentions.dw_rappel_retention.getitemnumber(w_liste_des_rappels_retentions.dw_rappel_retention.getrow(),"patient_patient_id"), w_principal, 2, layered!)
	   else
			OpensheetWithParm (w_etiquettes,w_patient.il_patid, w_principal, 2, layered!)
		end if
	else
		OpensheetWithParm (w_etiquettes,w_patient.il_patid, w_principal, 2, layered!)
	end if
else
	error_type(55)
end if
end event

on m_labels.create
call super::create
this.text = "&Étiquettes~tCtrl+E"
this.shortcut = 325
this.microhelp = "Étiquettes"
this.toolbaritemname = "custom074!"
this.toolbaritemtext = "Étiquettes"
this.toolbaritemorder = 10
this.toolbaritemspace = 2
this.menuimage = "Custom074!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_labels.destroy
call super::destroy
end on

type m_ententefin from menu within m_correspondance
event clicked ( )
end type

event clicked;long ll_idcontact
string ls_langue

SetPointer(HourGlass!)
ls_langue = w_patient.dw_details_patient.getitemstring(w_patient.dw_details_patient.getrow(),"langue")
if isnull(ls_langue) = true then 
	error_type(112)
else
	if w_patient.il_patid > 0 then
		select id_contact into :ll_idcontact from t_contact where patient_id = :w_patient.il_patid;
		OpensheetWithParm(w_entente_financiere,ll_idcontact,w_principal,2,layered!)
		w_entente_financiere.title = "Entente financière"
	else
		error_type(55)
	end if
end if
SetPointer(HourGlass!)
end event

on m_ententefin.create
call super::create
this.text = "E&ntente financière~tCtrl+N"
this.shortcut = 334
this.microhelp = "Entente financière"
this.toolbaritemvisible = false
this.toolbaritemname = "computepage!"
this.toolbaritemtext = "Entente"
this.toolbaritemorder = 12
this.menuimage = "ComputePage!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_ententefin.destroy
call super::destroy
end on

type m_ententefin2 from menu within m_correspondance
event clicked ( )
end type

event clicked;opensheetwithparm(w_entente_financiere2,w_patient.il_patid,w_principal,2,layered!)
w_entente_financiere2.title = "Entente financière"
end event

on m_ententefin2.create
call super::create
this.text = "Entente financière 2~tCtrl+T"
this.shortcut = 340
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_ententefin2.destroy
call super::destroy
end on

type m_questmed from menu within m_correspondance
event clicked ( )
end type

event clicked;string langue,v_word,v_doc, ls_zip, ls_telres
integer age
long enr //, ll_patid
date date_naiss
SetPointer(HourGlass!)
enr = w_patient.dw_details_patient.getrow()
if enr > 0 then
	select word into :v_word from t_lettres where id = 1;
	if v_word = '' or isnull(v_word) = true then
		messagebox("Avertissement","donnez l'emplacement de word dans lettre aux patients")
	else
//		ll_patid = w_patient.dw_patient_master.getitemnumber(enr,"patient_id")
		datastore ds_questmed
		ds_questmed = create datastore
		ds_questmed.dataobject = "d_questmed"
		ds_questmed.SetTransObject(SQLCA)
		ds_questmed.retrieve(w_patient.il_patid)
		ls_zip = ds_questmed.getItemString(ds_questmed.getRow(),'code_postale')
		ls_telres = ds_questmed.getItemString(ds_questmed.getRow(),'tel_maison')
		ds_questmed.setItem(ds_questmed.getRow(),'code_postale', string(ls_zip,'@@@ @@@'))
		ds_questmed.setItem(ds_questmed.getRow(),'tel_maison', string(ls_telres,'(@@@) @@@-@@@@'))
		if ds_questmed.SaveAs("c:\ii4net\orthotek\correspondances\patients.xls", Excel5!, TRUE) <> 1 then
			messagebox('Error','FAIL!',stopsign!)
		end if
		
		langue = w_patient.dw_details_patient.getitemstring(enr,"langue")
		date_naiss = w_patient.dw_details_patient.getitemdate(enr,"date_naissance")
		age = daysafter(date_naiss,today())/365
		if age > 0 then
			if langue = "F" then
				if age > 18 then
					v_doc = v_word + ' ' + 'c:\ii4net\orthotek\correspondances\questadultfr.doc'
					run(v_doc,maximized!)
				else
					v_doc = v_word + ' ' + 'c:\ii4net\orthotek\correspondances\questenffr.doc'
					run(v_doc,maximized!)
				end if
			elseif langue = "A" then 
				if age > 18 then
					v_doc = v_word + ' ' + 'c:\ii4net\orthotek\correspondances\questadultan.doc'
					run(v_doc,maximized!)
				else
					v_doc = v_word + ' ' + 'c:\ii4net\orthotek\correspondances\questenfan.doc'
					run(v_doc,maximized!)
				end if
			else
				error_type(112)
			end if
		else
			error_type(111)
		end if
	end if
else
	error_type(55)
end if
SetPointer(HourGlass!)
destroy ds_questmed
end event

on m_questmed.create
call super::create
this.text = "&Questionnaire médical~tCtrl+Q"
this.shortcut = 337
this.microhelp = "Questionnaire médical"
this.toolbaritemvisible = false
this.toolbaritemname = "DosEdit5!"
this.toolbaritemtext = "Questionnaire"
this.toolbaritemorder = 13
this.menuimage = "dosedit5!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_questmed.destroy
call super::destroy
end on

type m_lettrespat from menu within m_correspondance
event clicked ( )
end type

event clicked;long enr, patient

SetPointer(HourGlass!)
enr = w_patient.dw_details_patient.getrow()
if enr > 0 then
	patient = w_patient.dw_details_patient.getitemnumber(enr,"patient_id")	
	OpenSheetWithParm (w_lettres_patients,patient, w_principal,2,layered!)
	w_lettres_patients.title = "Lettres aux patients"
else
	error_type(55)
end if
SetPointer(HourGlass!)
end event

on m_lettrespat.create
call super::create
this.text = "Lettres aux &patients~tCtrl+P"
this.shortcut = 336
this.microhelp = "Lettres aux patients"
this.toolbaritemvisible = false
this.toolbaritemtext = "Lettres aux patients"
this.toolbaritemorder = 15
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_lettrespat.destroy
call super::destroy
end on

type m_lettresref from menu within m_correspondance
end type

on m_lettresref.create
call super::create
this.text = "Lettres aux référents"
this.toolbaritemvisible = false
this.toolbaritemtext = "Lettres aux référents"
this.toolbaritemorder = 16
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_lettresref.destroy
call super::destroy
end on

event clicked;long enr, patient

SetPointer(HourGlass!)
enr = w_patient.dw_details_patient.getrow()
if enr > 0 then
	patient = w_patient.dw_details_patient.getitemnumber(enr,"patient_id")	
	OpenSheetWithParm (w_lettresreferants,patient, w_principal,2,layered!)
	w_lettresreferants.title = "Lettres aux référants"
else
	error_type(55)
end if
SetPointer(HourGlass!)
end event

type m_lettresdet from menu within m_correspondance
end type

event clicked;s_corrletter s_corr
long ll_dentist
boolean lb_2k3 = false
integer li_FileNum, li_result
string ls_corrpath, ls_versword

setPointer(HourGlass!)

select corrpath into :ls_corrpath from t_options where ortho_id = :v_no_ortho;

li_result = RegistryGet("HKEY_CLASSES_ROOT\Word.Application\CurVer", "", RegString!, ls_versword)

if li_result = 1 then
	if not isNull(ls_versword) then
		if ls_versword = "Word.Application.11" then lb_2k3 = true
	end if
end if

s_corr.patid = 0
s_corr.letter = ''
s_corr.flag = 'w'
s_corr.mode = 'd'

DECLARE curDentistes CURSOR FOR
  SELECT id_dentist
	 FROM t_dentists
	WHERE actif = 1
	  AND inclist = 1
ORDER BY det_nom ASC,
			det_prenom ASC;

OPEN curDentistes;

FETCH curDentistes INTO :ll_dentist;

if SQLCA.SQLCode = 0 then
//	gf_det2excel(ll_dentist, false, lb_2k3)
	
	FETCH curDentistes INTO :ll_dentist;
	
	do while SQLCA.SQLCode = 0
//		gf_det2excel(ll_dentist, true, lb_2k3)
		
		FETCH curDentistes INTO :ll_dentist;
	loop
end if

CLOSE curDentistes;
	  
if fileExists("C:\ii4net\orthotek\img.xml") then fileDelete("C:\ii4net\orthotek\img.xml")
li_FileNum = fileOpen("C:\ii4net\orthotek\filedel.bat", LineMode!, Write!, lockReadWrite!, replace!)
fileWrite(li_FileNum, 'del /F ' + ls_corrpath + '\dentistes\.*.doc~r~nexit')
fileClose(li_FileNum)

run("C:\ii4net\orthotek\filedel.bat",minimized!)

sleep(2)

openwithparm(w_dosspatcorrletters,s_corr,w_principal)

end event

on m_lettresdet.create
call super::create
this.text = "Lettres aux dentistes"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_lettresdet.destroy
call super::destroy
end on

type m_billetabs from menu within m_correspondance
event clicked ( )
end type

event clicked;long ll_patid
string ls_langue
string ls_tag
window activesheet

activesheet = w_principal.GetActiveSheet()

IF IsValid(activesheet) THEN
	ls_tag = activesheet.Tag
ELSE
	ls_tag = 'Unknow windows'
END IF

// Recherche de la clé primaire
choose case ls_tag
	case 'Horaire'
		ll_patid = w_horaire.il_patid
	case 'dosspat'
		ll_patid = w_dossier_patients.il_patid
	case 'dossfin'
		ll_patid = w_traitements.il_patid
	case else
		ll_patid = w_patient.il_patid
end choose

// Ouverture du formulaire d'assurance
if ll_patid > 0 then
	select langue into :ls_langue from patient where patient_id = :ll_patid;
	if isnull(ls_langue) then
		open(w_choixlangue)
		ls_langue = message.stringparm
	end if
	if ls_langue = 'F' then
		OpenSheetWithParm (w_billet_fr, ll_patid, w_principal,2,layered!)
		if v_langue = 'an' then
			w_billet_fr.title = "French absence voucher"
		else
			w_billet_fr.title = "Billet d'absence français"
		end if
	else
		OpenSheetWithParm (w_billet_an, ll_patid, w_principal,2,layered!)
		if v_langue = 'an' then
			w_billet_an.title = "French absence voucher"
		else
			w_billet_an.title = "Billet d'absence français"
		end if
	end if
else
	error_type(113)
end if
end event

on m_billetabs.create
call super::create
this.text = "B&illet d~'absence~tCtrl+I"
this.shortcut = 329
this.microhelp = "Billet d~'absence"
this.toolbaritemname = "properties!"
this.toolbaritemtext = "Absence"
this.toolbaritemorder = 17
this.menuimage = "Properties!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_billetabs.destroy
call super::destroy
end on

type m_assurance from menu within m_correspondance
event clicked ( )
end type

event clicked;long ll_patid, ll_generalist, ll_traitid
string ls_tag
window activesheet

activesheet = w_principal.GetActiveSheet()

IF IsValid(activesheet) THEN
	ls_tag = activesheet.Tag
ELSE
	ls_tag = 'Unknow windows'
END IF

// Recherche de la clé primaire
choose case ls_tag
	case 'Horaire'
		ll_patid = w_horaire.il_patid
	case 'dosspat'
		ll_patid = w_dossier_patients.il_patid
	case 'dossfin'
		ll_patid = w_traitements.il_patid
	case else
		ll_patid = w_patient.il_patid
end choose

// Ouverture du formulaire d'assurance
if ll_patid > 0 then
// Ouverture du bon formulaire
	
	select isnull(generalist,0) into :ll_generalist from t_options where ortho_id = :v_no_ortho;
	if ll_generalist = 1 then
		OpenSheetWithParm (w_formnormgen, ll_patid, w_principal,2, layered!)
		w_formnormgen.title = "Formulaire normalisé"
	else
		OpenSheetWithParm (w_assurance, ll_patid, w_principal,2, layered!)
		w_assurance.title = "Formulaire d'assurance"
	end if
else
	error_type(113)
end if
end event

on m_assurance.create
call super::create
this.text = "&Assurances~tCtrl+A"
this.shortcut = 321
this.microhelp = "Assurances"
this.toolbaritemname = "statictext!"
this.toolbaritemtext = "Assurances"
this.toolbaritemorder = 18
this.menuimage = "StaticText!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_assurance.destroy
call super::destroy
end on

type m_ref from menu within m_correspondance
event clicked ( )
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	setpointer(hourglass!)
	opensheet(w_referents,w_principal,2,layered!)
	if v_langue = 'an' then
		w_referents.title = "Referees"
	else
		w_referents.title = "Référents"
	end if
else
	error_type(54)
end if
end event

on m_ref.create
call super::create
this.text = "&Référents~tCtrl+R"
this.shortcut = 338
this.microhelp = "Référents"
this.toolbaritemname = "custom084!"
this.toolbaritemtext = "Référents"
this.toolbaritemorder = 20
this.menuimage = "Custom084!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_ref.destroy
call super::destroy
end on

type m_dentistes from menu within m_correspondance
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	setpointer(hourglass!)
	opensheet(w_dentists,w_principal,2,layered!)
	w_dentists.title = "Dentists"
else
	error_type(54)
end if
end event

on m_dentistes.create
call super::create
this.text = "Dentistes"
this.microhelp = "Dentistes"
this.toolbaritemname = "browseobject!"
this.toolbaritemtext = "Dentistes"
this.toolbaritemorder = 21
this.menuimage = "BrowseObject!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_dentistes.destroy
call super::destroy
end on

type m_lettrefusion from menu within m_correspondance
end type

event clicked;opensheetwithparm(w_corresp,w_patient.il_patid,w_principal,2,layered!)
w_corresp.title = "Correspondance"
end event

on m_lettrefusion.create
call super::create
this.visible = false
this.text = "Lettre de fusion"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_lettrefusion.destroy
call super::destroy
end on

type m_formtransfert from menu within m_correspondance
end type

on m_formtransfert.create
call super::create
this.text = "Formulaire de transfert"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_formtransfert.destroy
call super::destroy
end on

event clicked;/*datastore ds_formtrans

ds_formtrans = create datastore
ds_formtrans.dataobject = 'd_formtrans'
ds_formtrans.setTransObject(SQLCA)
ds_formtrans.retrieve(w_patient.il_patid)
gb_datawindow = false
openwithparm(w_print_options,ds_formtrans)*/

OpenSheetWithParm(w_formtrans, w_patient.il_patid, w_principal, 2, layered!)
w_formtrans.title = "Formulaire de transfert"
end event

type m_traiturg from menu within m_correspondance
end type

on m_traiturg.create
call super::create
this.visible = false
this.text = "Traitement d~'urgence"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_traiturg.destroy
call super::destroy
end on

event clicked;datastore ds_questmed
ds_questmed = create datastore
ds_questmed.dataobject = "d_traiturg"
ds_questmed.SetTransObject(SQLCA)
ds_questmed.retrieve(w_patient.il_patid)
gb_datawindow = false
openwithparm(w_print_options,ds_questmed)
destroy ds_questmed
end event

type m_corrletter from menu within m_correspondance
end type

event clicked;opensheetwithparm(w_corrletters,w_patient.il_patid,w_principal,2,layered!)
w_corrletters.title = "Créer Éditer lettres types"
end event

on m_corrletter.create
call super::create
this.text = "Créer Éditer lettres types"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_corrletter.destroy
call super::destroy
end on

type m_questionnaire from menu within m_correspondance
end type

event clicked;long ll_patid
string ls_tag
window activesheet

activesheet = w_principal.GetActiveSheet()
IF IsValid(activesheet) THEN
	ls_tag = activesheet.Tag
ELSE
	ls_tag = 'Unknow windows'
END IF

// Recherche de la clé primaire
choose case ls_tag
	case 'Horaire'
		ll_patid = w_horaire.il_patid
	case 'dosspat'
		ll_patid = w_dossier_patients.il_patid
	case 'dossfin'
		ll_patid = w_traitements.il_patid
	case else
		ll_patid = w_patient.il_patid
end choose

if ll_patid > 0 then
	gnv_app.inv_entrepotglobal.of_ajoutedonnee('quest idpatient', ll_patid)
	open(w_qmview)
	OpenSheetWithParm (w_qmview, ll_patid, w_principal,2, layered!)
end if
end event

on m_questionnaire.create
call super::create
this.text = "Questionnaire"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_questionnaire.destroy
call super::destroy
end on

type m_listetraitementrequisnonsigne from menu within m_correspondance
end type

on m_listetraitementrequisnonsigne.create
call super::create
this.text = "Liste de traitements requis"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listetraitementrequisnonsigne.destroy
call super::destroy
end on

event clicked;opensheet(w_listtraitementnonsigne,w_principal,2,layered!)
end event

type m_stat from menu within m_principal
m_mref m_mref
m_dentist m_dentist
m_consultation m_consultation
m_mstatuts m_mstatuts
m_mfinances m_mfinances
m_mrdv m_mrdv
m_patients m_patients
m_etatdossier m_etatdossier
m_statistiquepatient m_statistiquepatient
m_employees m_employees
m_corresp m_corresp
end type

on m_stat.create
call super::create
this.text = "Statistiques"
this.microhelp = "Statistiques"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_mref=create m_mref
this.m_dentist=create m_dentist
this.m_consultation=create m_consultation
this.m_mstatuts=create m_mstatuts
this.m_mfinances=create m_mfinances
this.m_mrdv=create m_mrdv
this.m_patients=create m_patients
this.m_etatdossier=create m_etatdossier
this.m_statistiquepatient=create m_statistiquepatient
this.m_employees=create m_employees
this.m_corresp=create m_corresp
this.Item[UpperBound(this.Item)+1]=this.m_mref
this.Item[UpperBound(this.Item)+1]=this.m_dentist
this.Item[UpperBound(this.Item)+1]=this.m_consultation
this.Item[UpperBound(this.Item)+1]=this.m_mstatuts
this.Item[UpperBound(this.Item)+1]=this.m_mfinances
this.Item[UpperBound(this.Item)+1]=this.m_mrdv
this.Item[UpperBound(this.Item)+1]=this.m_patients
this.Item[UpperBound(this.Item)+1]=this.m_etatdossier
this.Item[UpperBound(this.Item)+1]=this.m_statistiquepatient
this.Item[UpperBound(this.Item)+1]=this.m_employees
this.Item[UpperBound(this.Item)+1]=this.m_corresp
end on

on m_stat.destroy
call super::destroy
destroy(this.m_mref)
destroy(this.m_dentist)
destroy(this.m_consultation)
destroy(this.m_mstatuts)
destroy(this.m_mfinances)
destroy(this.m_mrdv)
destroy(this.m_patients)
destroy(this.m_etatdossier)
destroy(this.m_statistiquepatient)
destroy(this.m_employees)
destroy(this.m_corresp)
end on

type m_mref from menu within m_stat
m_rapportdespatientsparréférent m_rapportdespatientsparréférent
m_listeref m_listeref
m_listerefopendoss m_listerefopendoss
end type

on m_mref.create
call super::create
this.text = "Référents"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_rapportdespatientsparréférent=create m_rapportdespatientsparréférent
this.m_listeref=create m_listeref
this.m_listerefopendoss=create m_listerefopendoss
this.Item[UpperBound(this.Item)+1]=this.m_rapportdespatientsparréférent
this.Item[UpperBound(this.Item)+1]=this.m_listeref
this.Item[UpperBound(this.Item)+1]=this.m_listerefopendoss
end on

on m_mref.destroy
call super::destroy
destroy(this.m_rapportdespatientsparréférent)
destroy(this.m_listeref)
destroy(this.m_listerefopendoss)
end on

type m_rapportdespatientsparréférent from menu within m_mref
end type

event clicked;opensheet(w_refpatdetail,w_principal,2,layered!)
w_refpatdetail.title = 'Patients par référent'
end event

on m_rapportdespatientsparréférent.create
call super::create
this.text = "Rapport des patients par référent"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_rapportdespatientsparréférent.destroy
call super::destroy
end on

type m_listeref from menu within m_mref
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	opensheet(w_liste_referants,w_principal,2,layered!)
	w_liste_referants.title = "Liste des référents par début de traitement"
else
	error_type(54)
end if
end event

on m_listeref.create
call super::create
this.text = "Liste des ré&férents (date début traitement)"
this.microhelp = "Liste des référents par début de traitement"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listeref.destroy
call super::destroy
end on

type m_listerefopendoss from menu within m_mref
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	opensheet(w_listerefopendoss,w_principal,2,layered!)
	w_listerefopendoss.title = "Liste des référents par ouverture de dossier"
else
	error_type(54)
end if
end event

on m_listerefopendoss.create
call super::create
this.text = "Liste des référents (date ouverture dossier)"
this.microhelp = "Liste des référents par ouverture de dossier"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listerefopendoss.destroy
call super::destroy
end on

type m_dentist from menu within m_stat
m_rapportdespatientspardentiste m_rapportdespatientspardentiste
m_listedentdebtrait m_listedentdebtrait
m_listedendateouvdos m_listedendateouvdos
end type

on m_dentist.create
call super::create
this.text = "Dentistes"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_rapportdespatientspardentiste=create m_rapportdespatientspardentiste
this.m_listedentdebtrait=create m_listedentdebtrait
this.m_listedendateouvdos=create m_listedendateouvdos
this.Item[UpperBound(this.Item)+1]=this.m_rapportdespatientspardentiste
this.Item[UpperBound(this.Item)+1]=this.m_listedentdebtrait
this.Item[UpperBound(this.Item)+1]=this.m_listedendateouvdos
end on

on m_dentist.destroy
call super::destroy
destroy(this.m_rapportdespatientspardentiste)
destroy(this.m_listedentdebtrait)
destroy(this.m_listedendateouvdos)
end on

type m_rapportdespatientspardentiste from menu within m_dentist
end type

event clicked;opensheet(w_dentpatdetail,w_principal,2,layered!)
w_dentpatdetail.title = 'Patients par dentiste'
end event

on m_rapportdespatientspardentiste.create
call super::create
this.text = "Rapport des patients par dentiste"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_rapportdespatientspardentiste.destroy
call super::destroy
end on

type m_listedentdebtrait from menu within m_dentist
end type

on m_listedentdebtrait.create
call super::create
this.text = "Liste des dentistes (date début traitement)"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listedentdebtrait.destroy
call super::destroy
end on

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	opensheet(w_listdent,w_principal,2,layered!)
	w_listdent.title = "Liste des dentistes par début de traitement"
else
	error_type(54)
end if
end event

type m_listedendateouvdos from menu within m_dentist
end type

on m_listedendateouvdos.create
call super::create
this.text = "Liste des dentistes (date ouverture dossier)"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listedendateouvdos.destroy
call super::destroy
end on

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	opensheet(w_listedentopendoss,w_principal,2,layered!)
	w_listedentopendoss.title = "Liste des dentites par ouverture de dossier"
else
	error_type(54)
end if

end event

type m_consultation from menu within m_stat
m_consbaserdv m_consbaserdv
m_consbasefact m_consbasefact
end type

on m_consultation.create
call super::create
this.text = "Consultation"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_consbaserdv=create m_consbaserdv
this.m_consbasefact=create m_consbasefact
this.Item[UpperBound(this.Item)+1]=this.m_consbaserdv
this.Item[UpperBound(this.Item)+1]=this.m_consbasefact
end on

on m_consultation.destroy
call super::destroy
destroy(this.m_consbaserdv)
destroy(this.m_consbasefact)
end on

type m_consbaserdv from menu within m_consultation
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	Opensheet(w_statpatcons,w_principal,2,layered!)
	w_statpatcons.title = "Cons. basé sur les rdv."
else
	error_type(54)
end if
end event

on m_consbaserdv.create
call super::create
this.text = "Basé sur les rendez-vous"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_consbaserdv.destroy
call super::destroy
end on

type m_consbasefact from menu within m_consultation
end type

on m_consbasefact.create
call super::create
this.text = "Basé sur la facturation"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_consbasefact.destroy
call super::destroy
end on

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	Opensheet(w_consbasefact,w_principal,2,layered!)
	w_consbasefact.title = "Cons. basé sur la facturation"
else
	error_type(54)
end if
end event

type m_mstatuts from menu within m_stat
m_statutpat m_statutpat
m_patstatuts m_patstatuts
m_rapporannuelstatuts m_rapporannuelstatuts
m_rapportannueletatsdoss m_rapportannueletatsdoss
m_stats1 m_stats1
end type

on m_mstatuts.create
call super::create
this.text = "Statuts"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_statutpat=create m_statutpat
this.m_patstatuts=create m_patstatuts
this.m_rapporannuelstatuts=create m_rapporannuelstatuts
this.m_rapportannueletatsdoss=create m_rapportannueletatsdoss
this.m_stats1=create m_stats1
this.Item[UpperBound(this.Item)+1]=this.m_statutpat
this.Item[UpperBound(this.Item)+1]=this.m_patstatuts
this.Item[UpperBound(this.Item)+1]=this.m_rapporannuelstatuts
this.Item[UpperBound(this.Item)+1]=this.m_rapportannueletatsdoss
this.Item[UpperBound(this.Item)+1]=this.m_stats1
end on

on m_mstatuts.destroy
call super::destroy
destroy(this.m_statutpat)
destroy(this.m_patstatuts)
destroy(this.m_rapporannuelstatuts)
destroy(this.m_rapportannueletatsdoss)
destroy(this.m_stats1)
end on

type m_statutpat from menu within m_mstatuts
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	Opensheet(w_status_patients,w_principal,2,layered!)
	w_status_patients.title = "Status par patient"
else
	error_type(54)
end if

end event

on m_statutpat.create
call super::create
this.text = "Statut par patients"
this.microhelp = "Statut par patients"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_statutpat.destroy
call super::destroy
end on

type m_patstatuts from menu within m_mstatuts
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	Opensheet(w_patients_status,w_principal,2,layered!)
	w_patients_status.title = "Patients par status"
else
	error_type(54)
end if

end event

on m_patstatuts.create
call super::create
this.text = "Patients par statuts"
this.microhelp = "Patients par statuts"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_patstatuts.destroy
call super::destroy
end on

type m_rapporannuelstatuts from menu within m_mstatuts
end type

event clicked;opensheet(w_rapport_annuel_statuts,w_principal,2,layered!)
w_rapport_annuel_statuts.title = "Rapport annuel des status"
end event

on m_rapporannuelstatuts.create
call super::create
this.text = "Rapport annuel des statuts"
this.microhelp = "Rapport annuel des statuts"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_rapporannuelstatuts.destroy
call super::destroy
end on

type m_rapportannueletatsdoss from menu within m_mstatuts
end type

event clicked;opensheet(w_rapportannueletatdoss,w_principal,2,layered!)
w_rapportannueletatdoss.title = "Rapport annuel des états dossier"
end event

on m_rapportannueletatsdoss.create
call super::create
this.text = "Rapport annuel des états dossier"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_rapportannueletatsdoss.destroy
call super::destroy
end on

type m_stats1 from menu within m_mstatuts
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	Opensheet(w_stats1,w_principal,2,layered!)
	w_stats1.title = "Stats 1"
else
	error_type(54)
end if
end event

on m_stats1.create
call super::create
this.text = "Stats 1"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_stats1.destroy
call super::destroy
end on

type m_mfinances from menu within m_stat
m_productivitecomparative m_productivitecomparative
m_statprod m_statprod
m_listetraitement m_listetraitement
m_historiquefinancier m_historiquefinancier
end type

on m_mfinances.create
call super::create
this.text = "Finances && productivité"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_productivitecomparative=create m_productivitecomparative
this.m_statprod=create m_statprod
this.m_listetraitement=create m_listetraitement
this.m_historiquefinancier=create m_historiquefinancier
this.Item[UpperBound(this.Item)+1]=this.m_productivitecomparative
this.Item[UpperBound(this.Item)+1]=this.m_statprod
this.Item[UpperBound(this.Item)+1]=this.m_listetraitement
this.Item[UpperBound(this.Item)+1]=this.m_historiquefinancier
end on

on m_mfinances.destroy
call super::destroy
destroy(this.m_productivitecomparative)
destroy(this.m_statprod)
destroy(this.m_listetraitement)
destroy(this.m_historiquefinancier)
end on

type m_productivitecomparative from menu within m_mfinances
end type

event clicked;opensheet(w_productivite_comp,w_principal,2,layered!)
w_productivite_comp.title = "Productivité comparative"
end event

on m_productivitecomparative.create
call super::create
this.text = "Productivité &comparative"
this.microhelp = "Productivité comparative"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_productivitecomparative.destroy
call super::destroy
end on

type m_statprod from menu within m_mfinances
end type

event clicked;opensheet(w_statprod,w_principal,2,layered!)
w_statprod.title = 'Statistique de productivité'
end event

on m_statprod.create
call super::create
this.text = "Statistique productivité"
this.microhelp = "Statistique productivité"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_statprod.destroy
call super::destroy
end on

type m_listetraitement from menu within m_mfinances
end type

event clicked;opensheet(w_listtrait,w_principal,2,layered!)
w_listtrait.title = "Liste de traitement"
end event

on m_listetraitement.create
call super::create
this.text = "Liste de traitement"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listetraitement.destroy
call super::destroy
end on

type m_historiquefinancier from menu within m_mfinances
end type

event clicked;opensheet(w_histofin,w_principal,2,layered!)

end event

on m_historiquefinancier.create
call super::create
this.text = "Historique financier"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_historiquefinancier.destroy
call super::destroy
end on

type m_mrdv from menu within m_stat
m_listerdvpat m_listerdvpat
m_patsansrdv m_patsansrdv
m_listedespatientsparphase m_listedespatientsparphase
m_listedesrdvconsultation m_listedesrdvconsultation
m_listedesdiagnostics m_listedesdiagnostics
m_listedesmisesenbouches m_listedesmisesenbouches
m_dureetrait m_dureetrait
m_listepatproc m_listepatproc
m_etatdesrendez-vous m_etatdesrendez-vous
m_listspatpers m_listspatpers
m_1 m_1
m_listedespatientsparopérateur m_listedespatientsparopérateur
end type

on m_mrdv.create
call super::create
this.text = "Rendez-vous"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_listerdvpat=create m_listerdvpat
this.m_patsansrdv=create m_patsansrdv
this.m_listedespatientsparphase=create m_listedespatientsparphase
this.m_listedesrdvconsultation=create m_listedesrdvconsultation
this.m_listedesdiagnostics=create m_listedesdiagnostics
this.m_listedesmisesenbouches=create m_listedesmisesenbouches
this.m_dureetrait=create m_dureetrait
this.m_listepatproc=create m_listepatproc
this.m_etatdesrendez-vous=create m_etatdesrendez-vous
this.m_listspatpers=create m_listspatpers
this.m_1=create m_1
this.m_listedespatientsparopérateur=create m_listedespatientsparopérateur
this.Item[UpperBound(this.Item)+1]=this.m_listerdvpat
this.Item[UpperBound(this.Item)+1]=this.m_patsansrdv
this.Item[UpperBound(this.Item)+1]=this.m_listedespatientsparphase
this.Item[UpperBound(this.Item)+1]=this.m_listedesrdvconsultation
this.Item[UpperBound(this.Item)+1]=this.m_listedesdiagnostics
this.Item[UpperBound(this.Item)+1]=this.m_listedesmisesenbouches
this.Item[UpperBound(this.Item)+1]=this.m_dureetrait
this.Item[UpperBound(this.Item)+1]=this.m_listepatproc
this.Item[UpperBound(this.Item)+1]=this.m_etatdesrendez-vous
this.Item[UpperBound(this.Item)+1]=this.m_listspatpers
this.Item[UpperBound(this.Item)+1]=this.m_1
this.Item[UpperBound(this.Item)+1]=this.m_listedespatientsparopérateur
end on

on m_mrdv.destroy
call super::destroy
destroy(this.m_listerdvpat)
destroy(this.m_patsansrdv)
destroy(this.m_listedespatientsparphase)
destroy(this.m_listedesrdvconsultation)
destroy(this.m_listedesdiagnostics)
destroy(this.m_listedesmisesenbouches)
destroy(this.m_dureetrait)
destroy(this.m_listepatproc)
destroy(this.m_etatdesrendez-vous)
destroy(this.m_listspatpers)
destroy(this.m_1)
destroy(this.m_listedespatientsparopérateur)
end on

type m_listerdvpat from menu within m_mrdv
end type

event clicked;opensheet(w_listerdvpatients,w_principal,2,layered!)
w_listerdvpatients.title = 'Liste des rdv patients'
end event

on m_listerdvpat.create
call super::create
this.text = "Liste des rdv patients"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listerdvpat.destroy
call super::destroy
end on

type m_patsansrdv from menu within m_mrdv
end type

event clicked;opensheet(w_patactifsansrdvrap,w_principal,2,layered!)
w_patactifsansrdvrap.title = 'Patient sans rdv'
end event

on m_patsansrdv.create
call super::create
this.text = "Patient sans rdv"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_patsansrdv.destroy
call super::destroy
end on

type m_listedespatientsparphase from menu within m_mrdv
end type

event clicked;opensheet(w_patparphase,w_principal,2,layered!)
w_patparphase.title = 'Patients par phase'
end event

on m_listedespatientsparphase.create
call super::create
this.text = "Liste des patients par phase"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listedespatientsparphase.destroy
call super::destroy
end on

type m_listedesrdvconsultation from menu within m_mrdv
end type

event clicked;opensheet(w_horrdvconsult,w_principal,2,layered!)
w_horrdvconsult.title = 'RDV consultation'
end event

on m_listedesrdvconsultation.create
call super::create
this.text = "Liste des rdv consultation"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listedesrdvconsultation.destroy
call super::destroy
end on

type m_listedesdiagnostics from menu within m_mrdv
end type

event clicked;opensheet(w_horrdvdiag,w_principal,2,layered!)
w_horrdvdiag.title = 'RDV diagnostics'
end event

on m_listedesdiagnostics.create
call super::create
this.text = "Liste des diagnostics"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listedesdiagnostics.destroy
call super::destroy
end on

type m_listedesmisesenbouches from menu within m_mrdv
end type

event clicked;opensheet(w_horrdvmeb,w_principal,2,layered!)
w_horrdvmeb.title = 'RDV mises en bouches'
end event

on m_listedesmisesenbouches.create
call super::create
this.text = "Liste des mises en bouches"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listedesmisesenbouches.destroy
call super::destroy
end on

type m_dureetrait from menu within m_mrdv
end type

on m_dureetrait.create
call super::create
this.text = "Durée moyenne des traitements"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_dureetrait.destroy
call super::destroy
end on

event clicked;opensheet(w_dureemoytrait,w_principal,2,layered!)
w_dureemoytrait.title = 'Durée moyenne des traitements'
end event

type m_listepatproc from menu within m_mrdv
end type

event clicked;opensheet(w_patproc,w_principal,2,layered!)
w_patproc.title = 'Liste des patients par procédure'
end event

on m_listepatproc.create
call super::create
this.text = "Liste des patients par procédure"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listepatproc.destroy
call super::destroy
end on

type m_etatdesrendez-vous from menu within m_mrdv
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	Opensheet(w_etatrdv,w_principal,2,layered!)
	w_etatrdv.title = "État des rendez-vous"
else
	error_type(54)
end if
end event

on m_etatdesrendez-vous.create
call super::create
this.text = "Etat des rendez-vous"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_etatdesrendez-vous.destroy
call super::destroy
end on

type m_listspatpers from menu within m_mrdv
end type

event clicked;opensheet(w_listpatpers,w_principal,2,layered!)
w_listpatpers.title = "Liste des patients par employé"
end event

on m_listspatpers.create
call super::create
this.text = "Liste des patients par employé"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listspatpers.destroy
call super::destroy
end on

type m_1 from menu within m_mrdv
end type

on m_1.create
call super::create
this.text = "Rendez-vous par salle"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_1.destroy
call super::destroy
end on

event clicked;opensheet(w_rdvsalle,w_principal,2,layered!)
w_rdvsalle.title = "Rendez-vous par salle"
end event

type m_listedespatientsparopérateur from menu within m_mrdv
end type

event clicked;opensheet(w_listpatientoperateur,w_principal,2,layered!)
end event

on m_listedespatientsparopérateur.create
call super::create
this.text = "Liste des patients par opérateur"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listedespatientsparopérateur.destroy
call super::destroy
end on

type m_patients from menu within m_stat
m_suividespatients m_suividespatients
m_listedespatientsparsatellites m_listedespatientsparsatellites
m_2 m_2
m_listpatage m_listpatage
m_nbrepatcp m_nbrepatcp
end type

on m_patients.create
call super::create
this.text = "Patients"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_suividespatients=create m_suividespatients
this.m_listedespatientsparsatellites=create m_listedespatientsparsatellites
this.m_2=create m_2
this.m_listpatage=create m_listpatage
this.m_nbrepatcp=create m_nbrepatcp
this.Item[UpperBound(this.Item)+1]=this.m_suividespatients
this.Item[UpperBound(this.Item)+1]=this.m_listedespatientsparsatellites
this.Item[UpperBound(this.Item)+1]=this.m_2
this.Item[UpperBound(this.Item)+1]=this.m_listpatage
this.Item[UpperBound(this.Item)+1]=this.m_nbrepatcp
end on

on m_patients.destroy
call super::destroy
destroy(this.m_suividespatients)
destroy(this.m_listedespatientsparsatellites)
destroy(this.m_2)
destroy(this.m_listpatage)
destroy(this.m_nbrepatcp)
end on

type m_suividespatients from menu within m_patients
end type

event clicked;opensheet(w_patsuivi,w_principal,2,layered!)
w_patsuivi.title = 'Suivi des patients'
end event

on m_suividespatients.create
call super::create
this.visible = false
this.text = "Suivi des patients"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_suividespatients.destroy
call super::destroy
end on

type m_listedespatientsparsatellites from menu within m_patients
end type

event clicked;opensheet(w_patsat,w_principal,2,layered!)
w_patsat.title = 'Liste des patients par satellites'
end event

on m_listedespatientsparsatellites.create
call super::create
this.text = "Liste des patients par satellites"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listedespatientsparsatellites.destroy
call super::destroy
end on

type m_2 from menu within m_patients
end type

event clicked;opensheet(w_r_nouveau_patient_groupe_age,w_principal,2,layered!)
end event

on m_2.create
call super::create
this.text = "Liste des nouveaux patients par groupe d~'âge"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_2.destroy
call super::destroy
end on

type m_listpatage from menu within m_patients
end type

on m_listpatage.create
call super::create
this.text = "Liste de patients par âge"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listpatage.destroy
call super::destroy
end on

event clicked;opensheet(w_patientage,w_principal,2,layered!)
w_patientage.title = 'Liste des patients par âge'
end event

type m_nbrepatcp from menu within m_patients
end type

on m_nbrepatcp.create
call super::create
this.text = "Nombre de patients par code postal"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_nbrepatcp.destroy
call super::destroy
end on

event clicked;opensheet(w_nbrepatientcodepostal,w_principal,2,layered!)
w_nbrepatientcodepostal.title = 'Nombre de patients par code postale'
end event

type m_etatdossier from menu within m_stat
m_patientparetatdossier m_patientparetatdossier
end type

on m_etatdossier.create
call super::create
this.text = "État dossier"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_patientparetatdossier=create m_patientparetatdossier
this.Item[UpperBound(this.Item)+1]=this.m_patientparetatdossier
end on

on m_etatdossier.destroy
call super::destroy
destroy(this.m_patientparetatdossier)
end on

type m_patientparetatdossier from menu within m_etatdossier
end type

event clicked;opensheet(w_patetatdoss,w_principal,2,layered!)
w_patetatdoss.title = "Patient par état dossier"
end event

on m_patientparetatdossier.create
call super::create
this.text = "Patient par état dossier"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_patientparetatdossier.destroy
call super::destroy
end on

type m_statistiquepatient from menu within m_stat
end type

event clicked;opensheet(w_statpat,w_principal,2,layered!)
w_statpat.title = "Statistique patient"
end event

on m_statistiquepatient.create
call super::create
this.text = "Statistique patient"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_statistiquepatient.destroy
call super::destroy
end on

type m_employees from menu within m_stat
m_feuillesdetemps m_feuillesdetemps
end type

on m_employees.create
call super::create
this.text = "Employé(es)"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_feuillesdetemps=create m_feuillesdetemps
this.Item[UpperBound(this.Item)+1]=this.m_feuillesdetemps
end on

on m_employees.destroy
call super::destroy
destroy(this.m_feuillesdetemps)
end on

type m_feuillesdetemps from menu within m_employees
end type

on m_feuillesdetemps.create
call super::create
this.text = "Feuilles de temps"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_feuillesdetemps.destroy
call super::destroy
end on

event clicked;opensheet(w_feuiltempsemp,w_principal,2,layered!)
end event

type m_corresp from menu within m_stat
m_listdocnonbarre m_listdocnonbarre
end type

on m_corresp.create
call super::create
this.text = "Correspondance"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_listdocnonbarre=create m_listdocnonbarre
this.Item[UpperBound(this.Item)+1]=this.m_listdocnonbarre
end on

on m_corresp.destroy
call super::destroy
destroy(this.m_listdocnonbarre)
end on

type m_listdocnonbarre from menu within m_corresp
end type

event clicked;opensheet(w_listtypedocnonbarre,w_principal,2,layered!)
end event

on m_listdocnonbarre.create
call super::create
this.text = "Liste de document non-signé"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listdocnonbarre.destroy
call super::destroy
end on

type m_fonctionscomptable from menu within m_principal
m_dossfin m_dossfin
m_revenus m_revenus
m_depots m_depots
m_recevables m_recevables
m_pourc m_pourc
m_rapports m_rapports
end type

on m_fonctionscomptable.create
call super::create
this.text = "Comptabilité"
this.microhelp = "Comptabilité"
this.toolbaritemtext = "Comptabilité"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_dossfin=create m_dossfin
this.m_revenus=create m_revenus
this.m_depots=create m_depots
this.m_recevables=create m_recevables
this.m_pourc=create m_pourc
this.m_rapports=create m_rapports
this.Item[UpperBound(this.Item)+1]=this.m_dossfin
this.Item[UpperBound(this.Item)+1]=this.m_revenus
this.Item[UpperBound(this.Item)+1]=this.m_depots
this.Item[UpperBound(this.Item)+1]=this.m_recevables
this.Item[UpperBound(this.Item)+1]=this.m_pourc
this.Item[UpperBound(this.Item)+1]=this.m_rapports
end on

on m_fonctionscomptable.destroy
call super::destroy
destroy(this.m_dossfin)
destroy(this.m_revenus)
destroy(this.m_depots)
destroy(this.m_recevables)
destroy(this.m_pourc)
destroy(this.m_rapports)
end on

type m_dossfin from menu within m_fonctionscomptable
end type

event clicked;long ll_patid
string ls_tag
window activesheet

activesheet = w_principal.GetActiveSheet()

IF IsValid(activesheet) THEN
	ls_tag = activesheet.Tag
ELSE
	ls_tag = 'Unknow windows'
END IF

// Recherche de la clé primaire
choose case ls_tag
	case 'Horaire'
		ll_patid = w_horaire.il_patid
	case 'dosspat'
		ll_patid = w_dossier_patients.il_patid
	case 'dossfin'
		ll_patid = w_traitements.il_patid
	case else
		ll_patid = w_patient.il_patid
end choose

// Ouverture du dossier financier
if ll_patid > 0 then
	w_patient.event ue_dossfin(ll_patid)
else
	error_type(113)
end if
end event

on m_dossfin.create
call super::create
this.visible = false
this.text = "Finances"
this.microhelp = "Finances"
this.toolbaritemname = "compute5!"
this.toolbaritemtext = "Finances"
this.toolbaritemorder = 30
this.toolbaritemspace = 2
this.menuimage = "Compute5!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_dossfin.destroy
call super::destroy
end on

type m_revenus from menu within m_fonctionscomptable
m_journaldeshonoraires m_journaldeshonoraires
m_chquespostdats m_chquespostdats
m_journaldesencaissements m_journaldesencaissements
m_journaldesrevenus m_journaldesrevenus
m_jrevenuscomb m_jrevenuscomb
m_listecomparative m_listecomparative
m_listecompper m_listecompper
end type

on m_revenus.create
call super::create
this.text = "Revenus"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_journaldeshonoraires=create m_journaldeshonoraires
this.m_chquespostdats=create m_chquespostdats
this.m_journaldesencaissements=create m_journaldesencaissements
this.m_journaldesrevenus=create m_journaldesrevenus
this.m_jrevenuscomb=create m_jrevenuscomb
this.m_listecomparative=create m_listecomparative
this.m_listecompper=create m_listecompper
this.Item[UpperBound(this.Item)+1]=this.m_journaldeshonoraires
this.Item[UpperBound(this.Item)+1]=this.m_chquespostdats
this.Item[UpperBound(this.Item)+1]=this.m_journaldesencaissements
this.Item[UpperBound(this.Item)+1]=this.m_journaldesrevenus
this.Item[UpperBound(this.Item)+1]=this.m_jrevenuscomb
this.Item[UpperBound(this.Item)+1]=this.m_listecomparative
this.Item[UpperBound(this.Item)+1]=this.m_listecompper
end on

on m_revenus.destroy
call super::destroy
destroy(this.m_journaldeshonoraires)
destroy(this.m_chquespostdats)
destroy(this.m_journaldesencaissements)
destroy(this.m_journaldesrevenus)
destroy(this.m_jrevenuscomb)
destroy(this.m_listecomparative)
destroy(this.m_listecompper)
end on

type m_journaldeshonoraires from menu within m_revenus
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	Opensheet(w_journal_honoraires,w_principal,2,layered!)
	w_journal_honoraires.title = "Journal des honoraires"
else
	error_type(54)
end if
end event

on m_journaldeshonoraires.create
call super::create
this.text = "Journal des &honoraires~tAlt+H"
this.shortcut = 584
this.microhelp = "Journal des honoraires"
this.toolbaritemvisible = false
this.toolbaritemname = "editdatatabular!"
this.toolbaritemtext = "Honoraires"
this.toolbaritemorder = 31
this.menuimage = "EditDataTabular!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_journaldeshonoraires.destroy
call super::destroy
end on

type m_chquespostdats from menu within m_revenus
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	opensheet(w_cheques_postdates_rapport,w_principal,2,layered!)
	w_cheques_postdates_rapport.title = "Rapport des chèques postdatés"
else
	error_type(54)
end if
end event

on m_chquespostdats.create
call super::create
this.text = "Chèques &postdatés~tAlt+P"
this.shortcut = 592
this.microhelp = "Chèques postdatés"
this.toolbaritemname = "horizontal!"
this.toolbaritemtext = "Postdatés"
this.toolbaritemorder = 32
this.menuimage = "Horizontal!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_chquespostdats.destroy
call super::destroy
end on

type m_journaldesencaissements from menu within m_revenus
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	opensheet(w_journal_encaissements,w_principal,2,layered!)
	w_journal_encaissements.title = "Journal des encaissements"
else
	error_type(54)
end if
end event

on m_journaldesencaissements.create
call super::create
this.text = "Journal des &encaissements~tAlt+E"
this.shortcut = 581
this.microhelp = "Journal des encaissements"
this.toolbaritemname = "custom087!"
this.toolbaritemtext = "Encaissements"
this.toolbaritemorder = 33
this.menuimage = "Custom087!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_journaldesencaissements.destroy
call super::destroy
end on

type m_journaldesrevenus from menu within m_revenus
end type

event clicked;OpenSheet(w_journal_revenus,w_principal,2,layered!)
w_journal_revenus.title = "Journal des revenus"
end event

on m_journaldesrevenus.create
call super::create
this.text = "Journal des revenus~tAlt+U"
this.shortcut = 597
this.microhelp = "Journal des revenus"
this.toolbaritemvisible = false
this.toolbaritemname = "compute!"
this.toolbaritemtext = "Revenus"
this.toolbaritemorder = 36
this.menuimage = "Compute!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_journaldesrevenus.destroy
call super::destroy
end on

type m_jrevenuscomb from menu within m_revenus
end type

event clicked;OpenSheet(w_journalrevenus,w_principal,2,layered!)
w_journalrevenus.title = "Journal des revenus combinés"

end event

on m_jrevenuscomb.create
call super::create
this.text = "Journal des revenus combinés"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_jrevenuscomb.destroy
call super::destroy
end on

type m_listecomparative from menu within m_revenus
end type

on m_listecomparative.create
call super::create
this.text = "Liste comparative journalière"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listecomparative.destroy
call super::destroy
end on

event clicked;opensheet(w_liste_comp,w_principal,2,Layered!)
w_liste_comp.title = "Liste comparative"
end event

type m_listecompper from menu within m_revenus
end type

event clicked;opensheet(w_listecompdd,w_principal,2,Layered!)
w_listecompdd.title = "Liste comparative périodique"
end event

on m_listecompper.create
call super::create
this.text = "Liste comparative périodique"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listecompper.destroy
call super::destroy
end on

type m_depots from menu within m_fonctionscomptable
m_journaldepot m_journaldepot
m_depotlot m_depotlot
m_journaldepotscompact m_journaldepotscompact
m_journaldepotscpd m_journaldepotscpd
m_journaldepotanc m_journaldepotanc
end type

on m_depots.create
call super::create
this.text = "Dépôts"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_journaldepot=create m_journaldepot
this.m_depotlot=create m_depotlot
this.m_journaldepotscompact=create m_journaldepotscompact
this.m_journaldepotscpd=create m_journaldepotscpd
this.m_journaldepotanc=create m_journaldepotanc
this.Item[UpperBound(this.Item)+1]=this.m_journaldepot
this.Item[UpperBound(this.Item)+1]=this.m_depotlot
this.Item[UpperBound(this.Item)+1]=this.m_journaldepotscompact
this.Item[UpperBound(this.Item)+1]=this.m_journaldepotscpd
this.Item[UpperBound(this.Item)+1]=this.m_journaldepotanc
end on

on m_depots.destroy
call super::destroy
destroy(this.m_journaldepot)
destroy(this.m_depotlot)
destroy(this.m_journaldepotscompact)
destroy(this.m_journaldepotscpd)
destroy(this.m_journaldepotanc)
end on

type m_journaldepot from menu within m_depots
end type

event clicked;//nouveau
if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	opensheet(w_journaldepot,w_principal,2,layered!)
	w_journaldepot.title = "Journal des dépôts"
else
	error_type(54)
end if
//ancien
//if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
//	opensheet(w_journal_depot,w_principal,2,layered!)
//	w_journal_depot.title = "Journal des dépôts"
//else
//	error_type(54)
//end if
end event

on m_journaldepot.create
call super::create
this.text = "Journal des &dépôts~tAlt+D"
this.shortcut = 580
this.microhelp = "Journal des dépôts"
this.toolbaritemname = "custom048!"
this.toolbaritemtext = "Dépôts"
this.toolbaritemorder = 34
this.menuimage = "custom048!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_journaldepot.destroy
call super::destroy
end on

type m_depotlot from menu within m_depots
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	opensheet(w_lotdetail,w_principal,2,layered!)
	w_lotdetail.title = "Détails des lots"
else
	error_type(54)
end if
end event

on m_depotlot.create
call super::create
this.text = "Consulter dépôt ( lot )"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_depotlot.destroy
call super::destroy
end on

type m_journaldepotscompact from menu within m_depots
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	opensheet(w_depot_compact,w_principal,2,layered!)
	w_depot_compact.title = "Journal des dépôts"
else
	error_type(54)
end if
end event

on m_journaldepotscompact.create
call super::create
this.text = "Journal des dépôts compact"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_journaldepotscompact.destroy
call super::destroy
end on

type m_journaldepotscpd from menu within m_depots
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	opensheet(w_journaldepotavance,w_principal,2,layered!)
	w_journaldepotavance.title = "Journal des dépôts ( cpd )"
else
	error_type(54)
end if
end event

on m_journaldepotscpd.create
call super::create
this.text = "Journal des dépôts ( cpd )"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_journaldepotscpd.destroy
call super::destroy
end on

type m_journaldepotanc from menu within m_depots
end type

event clicked;//ancien
if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	opensheet(w_journal_depot,w_principal,2,layered!)
	w_journal_depot.title = "Journal des dépôts"
else
	error_type(54)
end if
end event

on m_journaldepotanc.create
call super::create
this.text = "Journal des dépôts ( ancien )"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_journaldepotanc.destroy
call super::destroy
end on

type m_recevables from menu within m_fonctionscomptable
m_agedescomptes m_agedescomptes
m_etatdecompte m_etatdecompte
m_comptesrecevables m_comptesrecevables
m_comptesrecsoldeant m_comptesrecsoldeant
m_comptesclients m_comptesclients
m_paiementsouffrance m_paiementsouffrance
m_comptepercevoir m_comptepercevoir
end type

on m_recevables.create
call super::create
this.text = "Recevables"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_agedescomptes=create m_agedescomptes
this.m_etatdecompte=create m_etatdecompte
this.m_comptesrecevables=create m_comptesrecevables
this.m_comptesrecsoldeant=create m_comptesrecsoldeant
this.m_comptesclients=create m_comptesclients
this.m_paiementsouffrance=create m_paiementsouffrance
this.m_comptepercevoir=create m_comptepercevoir
this.Item[UpperBound(this.Item)+1]=this.m_agedescomptes
this.Item[UpperBound(this.Item)+1]=this.m_etatdecompte
this.Item[UpperBound(this.Item)+1]=this.m_comptesrecevables
this.Item[UpperBound(this.Item)+1]=this.m_comptesrecsoldeant
this.Item[UpperBound(this.Item)+1]=this.m_comptesclients
this.Item[UpperBound(this.Item)+1]=this.m_paiementsouffrance
this.Item[UpperBound(this.Item)+1]=this.m_comptepercevoir
end on

on m_recevables.destroy
call super::destroy
destroy(this.m_agedescomptes)
destroy(this.m_etatdecompte)
destroy(this.m_comptesrecevables)
destroy(this.m_comptesrecsoldeant)
destroy(this.m_comptesclients)
destroy(this.m_paiementsouffrance)
destroy(this.m_comptepercevoir)
end on

type m_agedescomptes from menu within m_recevables
end type

event clicked;opensheet(w_agedescompteslist,w_principal,2,layered!)
w_agedescompteslist.title = "Âge des comptes"
end event

on m_agedescomptes.create
call super::create
this.text = "Âge des comptes"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_agedescomptes.destroy
call super::destroy
end on

type m_etatdecompte from menu within m_recevables
end type

event clicked;opensheet(w_etatcomptelist,w_principal,2,layered!)
w_etatcomptelist.title = "Etat de compte"
end event

on m_etatdecompte.create
call super::create
this.text = "État de compte~tAlt+M"
this.shortcut = 589
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_etatdecompte.destroy
call super::destroy
end on

type m_comptesrecevables from menu within m_recevables
end type

event clicked;OpenSheet(w_comptes_recevables,w_principal,2,layered!)
w_comptes_recevables.title = "Liste des comptes recevables"
end event

on m_comptesrecevables.create
call super::create
this.text = "Comptes &recevables~tAlt+R"
this.shortcut = 594
this.microhelp = "Comptes recevables"
this.toolbaritemname = "custom070!"
this.toolbaritemtext = "Recevables"
this.toolbaritemorder = 35
this.menuimage = "Custom070!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_comptesrecevables.destroy
call super::destroy
end on

type m_comptesrecsoldeant from menu within m_recevables
end type

event clicked;OpenSheet(w_comptes_recevablesant,w_principal,2,layered!)
w_comptes_recevablesant.title = "Liste des comptes recevables"
end event

on m_comptesrecsoldeant.create
call super::create
this.text = "Comptes recevables solde antérieur"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_comptesrecsoldeant.destroy
call super::destroy
end on

type m_comptesclients from menu within m_recevables
end type

event clicked;OpenSheet(w_comptes_clients,w_principal,2,layered!)
w_comptes_clients.title = "Liste des comptes clients"
end event

on m_comptesclients.create
call super::create
this.text = "Comptes &clients~tAlt+C"
this.shortcut = 579
this.microhelp = "Comptes clients"
this.toolbaritemvisible = false
this.toolbaritemname = "custom017!"
this.toolbaritemtext = "Clients"
this.toolbaritemorder = 37
this.menuimage = "Custom017!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_comptesclients.destroy
call super::destroy
end on

type m_paiementsouffrance from menu within m_recevables
end type

event clicked;opensheet(w_liste_paiement_souffrance,w_principal,2,layered!)
w_liste_paiement_souffrance.title = "Liste des paiements en souffrance"

end event

on m_paiementsouffrance.create
call super::create
this.text = "Paiement en so&uffrance~tAlt+U"
this.shortcut = 597
this.microhelp = "Paiement en souffrance"
this.toolbaritemname = "custom079!"
this.toolbaritemtext = "Souffrance"
this.toolbaritemorder = 40
this.menuimage = "Custom079!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_paiementsouffrance.destroy
call super::destroy
end on

type m_comptepercevoir from menu within m_recevables
end type

event clicked;opensheet(w_compteapercevoir,w_principal,2,layered!)
w_compteapercevoir.title = "Compte à perçevoir"
end event

on m_comptepercevoir.create
call super::create
this.text = "Compte à perçevoir"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_comptepercevoir.destroy
call super::destroy
end on

type m_pourc from menu within m_fonctionscomptable
m_entrer m_entrer
m_pourcentages m_pourcentages
m_pourcentagebasésurcoûtdutraitement m_pourcentagebasésurcoûtdutraitement
end type

on m_pourc.create
call super::create
this.text = "Pourcentages"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_entrer=create m_entrer
this.m_pourcentages=create m_pourcentages
this.m_pourcentagebasésurcoûtdutraitement=create m_pourcentagebasésurcoûtdutraitement
this.Item[UpperBound(this.Item)+1]=this.m_entrer
this.Item[UpperBound(this.Item)+1]=this.m_pourcentages
this.Item[UpperBound(this.Item)+1]=this.m_pourcentagebasésurcoûtdutraitement
end on

on m_pourc.destroy
call super::destroy
destroy(this.m_entrer)
destroy(this.m_pourcentages)
destroy(this.m_pourcentagebasésurcoûtdutraitement)
end on

type m_entrer from menu within m_pourc
end type

event clicked;opensheet(w_pourcentage_entrer, w_principal, 2, Layered!)
w_pourcentage_entrer.title = "Entrée des pourcentages"
end event

on m_entrer.create
call super::create
this.text = "E&ntrer pourcentages~tAlt+N"
this.shortcut = 590
this.microhelp = "Entrer pourcentages"
this.toolbaritemvisible = false
this.toolbaritemname = "move!"
this.toolbaritemtext = "E. pourcentage"
this.toolbaritemorder = 38
this.menuimage = "Move!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_entrer.destroy
call super::destroy
end on

type m_pourcentages from menu within m_pourc
end type

event clicked;opensheet(w_pour_fact,w_principal,2,layered!)
w_pour_fact.title = "Liste des pourcentages"
end event

on m_pourcentages.create
call super::create
this.text = "&Pourcentages basé sur la facturation~tAlt+P"
this.shortcut = 592
this.microhelp = "Pourcentages"
this.toolbaritemvisible = false
this.toolbaritemname = "formatpercent!"
this.toolbaritemtext = "Pourcentages"
this.toolbaritemorder = 39
this.menuimage = "FormatPercent!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_pourcentages.destroy
call super::destroy
end on

type m_pourcentagebasésurcoûtdutraitement from menu within m_pourc
end type

event clicked;opensheet(w_pour_fact_couttrait,w_principal,2,layered!)
w_pour_fact_couttrait.title = "Liste des pourcentages"
end event

on m_pourcentagebasésurcoûtdutraitement.create
call super::create
this.text = "Pourcentage basé sur coût du traitement"
this.menuimage = "FormatPercent!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_pourcentagebasésurcoûtdutraitement.destroy
call super::destroy
end on

type m_rapports from menu within m_fonctionscomptable
m_taxform m_taxform
m_nonzerodueamount m_nonzerodueamount
m_rapportdumois m_rapportdumois
m_rapportnsf m_rapportnsf
m_rappcred m_rappcred
m_raptrait m_raptrait
m_nonzerobalance m_nonzerobalance
end type

on m_rapports.create
call super::create
this.text = "Rapports"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_taxform=create m_taxform
this.m_nonzerodueamount=create m_nonzerodueamount
this.m_rapportdumois=create m_rapportdumois
this.m_rapportnsf=create m_rapportnsf
this.m_rappcred=create m_rappcred
this.m_raptrait=create m_raptrait
this.m_nonzerobalance=create m_nonzerobalance
this.Item[UpperBound(this.Item)+1]=this.m_taxform
this.Item[UpperBound(this.Item)+1]=this.m_nonzerodueamount
this.Item[UpperBound(this.Item)+1]=this.m_rapportdumois
this.Item[UpperBound(this.Item)+1]=this.m_rapportnsf
this.Item[UpperBound(this.Item)+1]=this.m_rappcred
this.Item[UpperBound(this.Item)+1]=this.m_raptrait
this.Item[UpperBound(this.Item)+1]=this.m_nonzerobalance
end on

on m_rapports.destroy
call super::destroy
destroy(this.m_taxform)
destroy(this.m_nonzerodueamount)
destroy(this.m_rapportdumois)
destroy(this.m_rapportnsf)
destroy(this.m_rappcred)
destroy(this.m_raptrait)
destroy(this.m_nonzerobalance)
end on

type m_taxform from menu within m_rapports
end type

event clicked;opensheet(w_taxform,w_principal,2,layered!)
w_taxform.title = "Formulaire d'impôt"
end event

on m_taxform.create
call super::create
this.text = "Formulaire d~'impôt"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_taxform.destroy
call super::destroy
end on

type m_nonzerodueamount from menu within m_rapports
end type

event clicked;opensheet(w_nonzerodueamount,w_principal,2,layered!)
w_nonzerodueamount.title = "None zero due amount"
end event

on m_nonzerodueamount.create
call super::create
this.text = "Rapport de semaine"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_nonzerodueamount.destroy
call super::destroy
end on

type m_rapportdumois from menu within m_rapports
end type

event clicked;opensheet(w_monthlyreport,w_principal,2,layered!)
w_monthlyreport.title = "Monthly report"
end event

on m_rapportdumois.create
call super::create
this.text = "Rapport du mois"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_rapportdumois.destroy
call super::destroy
end on

type m_rapportnsf from menu within m_rapports
end type

event clicked;opensheet(w_nsfreport,w_principal,2,layered!)
w_nsfreport.title = "Rapport des paiements"
end event

on m_rapportnsf.create
call super::create
this.text = "Rapport des paiements"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_rapportnsf.destroy
call super::destroy
end on

type m_rappcred from menu within m_rapports
end type

event clicked;opensheet(w_creditreport,w_principal,2,layered!)

end event

on m_rappcred.create
call super::create
this.text = "Rapport des crédits"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_rappcred.destroy
call super::destroy
end on

type m_raptrait from menu within m_rapports
end type

event clicked;if isNull(v_no_ortho) = False and v_no_ortho <> 0 then
	Opensheet(w_journaltraitements,w_principal,2,layered!)
	w_journaltraitements.title = "Journal des traitements"
else
	error_type(54)
end if

end event

on m_raptrait.create
call super::create
this.text = "Rapport des traitements"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_raptrait.destroy
call super::destroy
end on

type m_nonzerobalance from menu within m_rapports
end type

event clicked;opensheet(w_nonzerobalance,w_principal,2,layered!)
w_nonzerobalance.title = "None zero balance"
end event

on m_nonzerobalance.create
call super::create
this.text = "Solde différent de zéro"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_nonzerobalance.destroy
call super::destroy
end on

type m_couleurs from menu within m_principal
end type

event clicked;openwithparm(w_choixcouleur,1)
end event

on m_couleurs.create
call super::create
this.text = "Couleurs"
this.enabled = false
this.toolbaritemname = "custom073!"
this.toolbaritemtext = "Couleurs"
this.menuimage = "custom073!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_couleurs.destroy
call super::destroy
end on

type m_parametres from menu within m_principal
m_dosspat m_dosspat
m_corr m_corr
m_comp m_comp
m_horaire0 m_horaire0
m_cartedetraitement m_cartedetraitement
m_listespeciality m_listespeciality
end type

on m_parametres.create
call super::create
this.text = "Paramètres"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_dosspat=create m_dosspat
this.m_corr=create m_corr
this.m_comp=create m_comp
this.m_horaire0=create m_horaire0
this.m_cartedetraitement=create m_cartedetraitement
this.m_listespeciality=create m_listespeciality
this.Item[UpperBound(this.Item)+1]=this.m_dosspat
this.Item[UpperBound(this.Item)+1]=this.m_corr
this.Item[UpperBound(this.Item)+1]=this.m_comp
this.Item[UpperBound(this.Item)+1]=this.m_horaire0
this.Item[UpperBound(this.Item)+1]=this.m_cartedetraitement
this.Item[UpperBound(this.Item)+1]=this.m_listespeciality
end on

on m_parametres.destroy
call super::destroy
destroy(this.m_dosspat)
destroy(this.m_corr)
destroy(this.m_comp)
destroy(this.m_horaire0)
destroy(this.m_cartedetraitement)
destroy(this.m_listespeciality)
end on

type m_dosspat from menu within m_parametres
m_activites m_activites
m_satellites m_satellites
m_familles m_familles
end type

on m_dosspat.create
call super::create
this.text = "Dossier patient"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_activites=create m_activites
this.m_satellites=create m_satellites
this.m_familles=create m_familles
this.Item[UpperBound(this.Item)+1]=this.m_activites
this.Item[UpperBound(this.Item)+1]=this.m_satellites
this.Item[UpperBound(this.Item)+1]=this.m_familles
end on

on m_dosspat.destroy
call super::destroy
destroy(this.m_activites)
destroy(this.m_satellites)
destroy(this.m_familles)
end on

type m_activites from menu within m_dosspat
end type

event clicked;OpenSheet(w_activites,w_principal,2,layered!)
w_activites.title = "Activités"
end event

on m_activites.create
call super::create
this.text = "Activités"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_activites.destroy
call super::destroy
end on

type m_satellites from menu within m_dosspat
end type

event clicked;OpenSheet(w_satellites,w_principal,2,layered!)
w_satellites.title = "Satellites"
end event

on m_satellites.create
call super::create
this.text = "Satellites"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_satellites.destroy
call super::destroy
end on

type m_familles from menu within m_dosspat
end type

event clicked;opensheet(w_familles,w_principal,2,layered!)
w_familles.title = 'Familles'

end event

on m_familles.create
call super::create
this.text = "Familles"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_familles.destroy
call super::destroy
end on

type m_corr from menu within m_parametres
m_condtrait m_condtrait
m_typesal m_typesal
m_typecontact m_typecontact
m_intro-conc m_intro-conc
m_listedecourrielprédéfini m_listedecourrielprédéfini
m_contrat m_contrat
m_sujet m_sujet
m_plantrait m_plantrait
m_odontogrammetype m_odontogrammetype
m_questionnaire0 m_questionnaire0
end type

on m_corr.create
call super::create
this.text = "Correspondance"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_condtrait=create m_condtrait
this.m_typesal=create m_typesal
this.m_typecontact=create m_typecontact
this.m_intro-conc=create m_intro-conc
this.m_listedecourrielprédéfini=create m_listedecourrielprédéfini
this.m_contrat=create m_contrat
this.m_sujet=create m_sujet
this.m_plantrait=create m_plantrait
this.m_odontogrammetype=create m_odontogrammetype
this.m_questionnaire0=create m_questionnaire0
this.Item[UpperBound(this.Item)+1]=this.m_condtrait
this.Item[UpperBound(this.Item)+1]=this.m_typesal
this.Item[UpperBound(this.Item)+1]=this.m_typecontact
this.Item[UpperBound(this.Item)+1]=this.m_intro-conc
this.Item[UpperBound(this.Item)+1]=this.m_listedecourrielprédéfini
this.Item[UpperBound(this.Item)+1]=this.m_contrat
this.Item[UpperBound(this.Item)+1]=this.m_sujet
this.Item[UpperBound(this.Item)+1]=this.m_plantrait
this.Item[UpperBound(this.Item)+1]=this.m_odontogrammetype
this.Item[UpperBound(this.Item)+1]=this.m_questionnaire0
end on

on m_corr.destroy
call super::destroy
destroy(this.m_condtrait)
destroy(this.m_typesal)
destroy(this.m_typecontact)
destroy(this.m_intro-conc)
destroy(this.m_listedecourrielprédéfini)
destroy(this.m_contrat)
destroy(this.m_sujet)
destroy(this.m_plantrait)
destroy(this.m_odontogrammetype)
destroy(this.m_questionnaire0)
end on

type m_condtrait from menu within m_corr
end type

event clicked;OpenSheet(w_assurance_ajout,w_principal,2,layered!)
w_assurance_ajout.title = "Ajout condition d'assurance"
end event

on m_condtrait.create
call super::create
this.text = "Conditions de traitement"
this.microhelp = "Conditions de traitement"
this.toolbaritemvisible = false
this.toolbaritemtext = "Conditions de traitement"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_condtrait.destroy
call super::destroy
end on

type m_typesal from menu within m_corr
end type

event clicked;OpenSheet(w_salutation,w_principal,2,layered!)
end event

on m_typesal.create
call super::create
this.text = "Types de salutations"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_typesal.destroy
call super::destroy
end on

type m_typecontact from menu within m_corr
end type

event clicked;OpenSheet(w_contacttype,w_principal,2,layered!)
end event

on m_typecontact.create
call super::create
this.text = "Types de contact"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_typecontact.destroy
call super::destroy
end on

type m_intro-conc from menu within m_corr
end type

event clicked;OpenSheet(w_introconc,w_principal,2,layered!)
w_introconc.title = "Introduction - Conclusion"
end event

on m_intro-conc.create
call super::create
this.text = "Intro-Conc."
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_intro-conc.destroy
call super::destroy
end on

type m_listedecourrielprédéfini from menu within m_corr
event create ( )
event destroy ( )
end type

on m_listedecourrielprédéfini.create
call super::create
this.text = "Liste de courriel prédéfini"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listedecourrielprédéfini.destroy
call super::destroy
end on

event clicked;opensheet(w_listmsgemail,w_principal,2,layered!)
end event

type m_contrat from menu within m_corr
end type

event clicked;OpenSheet(w_contrattype,w_principal,2,layered!)
end event

on m_contrat.create
call super::create
this.text = "Contrat"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_contrat.destroy
call super::destroy
end on

type m_sujet from menu within m_corr
end type

event clicked;opensheet(w_sujet,w_principal,2,layered!)
w_sujet.title = 'Liste des sujets'

end event

on m_sujet.create
call super::create
this.text = "Sujet"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_sujet.destroy
call super::destroy
end on

type m_plantrait from menu within m_corr
end type

event clicked;OpenSheet(w_liste_descr,w_principal,2,layered!)
w_liste_descr.title = "Liste des traitements"

end event

on m_plantrait.create
call super::create
this.text = "Plan de traitements"
this.microhelp = "Plan de traitements"
this.toolbaritemvisible = false
this.toolbaritemtext = "Plan de traitements"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_plantrait.destroy
call super::destroy
end on

type m_odontogrammetype from menu within m_corr
end type

event clicked;OpenSheet(w_typeodonto,w_principal,2,layered!)
end event

on m_odontogrammetype.create
call super::create
this.text = "Odontogramme type"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_odontogrammetype.destroy
call super::destroy
end on

type m_questionnaire0 from menu within m_corr
end type

event clicked;opensheet(w_qm,w_principal,2,layered!)
end event

on m_questionnaire0.create
call super::create
this.text = "Questionnaire"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_questionnaire0.destroy
call super::destroy
end on

type m_comp from menu within m_parametres
m_typephase m_typephase
m_listestatuts m_listestatuts
m_etatpat m_etatpat
end type

on m_comp.create
call super::create
this.text = "Comptabilité"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_typephase=create m_typephase
this.m_listestatuts=create m_listestatuts
this.m_etatpat=create m_etatpat
this.Item[UpperBound(this.Item)+1]=this.m_typephase
this.Item[UpperBound(this.Item)+1]=this.m_listestatuts
this.Item[UpperBound(this.Item)+1]=this.m_etatpat
end on

on m_comp.destroy
call super::destroy
destroy(this.m_typephase)
destroy(this.m_listestatuts)
destroy(this.m_etatpat)
end on

type m_typephase from menu within m_comp
end type

event clicked;OpenSheet(w_typephase,w_principal,2,layered!)
end event

on m_typephase.create
call super::create
this.text = "Types de phase"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_typephase.destroy
call super::destroy
end on

type m_listestatuts from menu within m_comp
end type

event clicked;OpenSheet(w_status,w_principal,2,layered!)
w_status.title = "Statut"
end event

on m_listestatuts.create
call super::create
this.text = "Liste des actes facturables"
this.microhelp = "Liste des actes facturables"
this.toolbaritemvisible = false
this.toolbaritemtext = "Liste des statuts"
this.toolbaritemorder = 30
this.toolbaritemspace = 2
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listestatuts.destroy
call super::destroy
end on

type m_etatpat from menu within m_comp
end type

event clicked;opensheet(w_patstatus,w_principal,2,layered!)
end event

on m_etatpat.create
call super::create
this.text = "Liste des états du dossier patient"
this.microhelp = "Liste des états du dossier patient"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_etatpat.destroy
call super::destroy
end on

type m_horaire0 from menu within m_parametres
m_typestrait m_typestrait
m_typesrappels m_typesrappels
m_procedures m_procedures
end type

on m_horaire0.create
call super::create
this.text = "Horaire"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_typestrait=create m_typestrait
this.m_typesrappels=create m_typesrappels
this.m_procedures=create m_procedures
this.Item[UpperBound(this.Item)+1]=this.m_typestrait
this.Item[UpperBound(this.Item)+1]=this.m_typesrappels
this.Item[UpperBound(this.Item)+1]=this.m_procedures
end on

on m_horaire0.destroy
call super::destroy
destroy(this.m_typestrait)
destroy(this.m_typesrappels)
destroy(this.m_procedures)
end on

type m_typestrait from menu within m_horaire0
end type

event clicked;OpenSheet(w_type_traitements,w_principal,2,layered!)
w_type_traitements.title = "Types de traitements"

end event

on m_typestrait.create
call super::create
this.text = "Liste des procédures pour l~'horaire"
this.microhelp = "Liste des procédures pour l~'horaire"
this.toolbaritemvisible = false
this.toolbaritemtext = "Types de traitements"
this.toolbaritemorder = 5
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_typestrait.destroy
call super::destroy
end on

type m_typesrappels from menu within m_horaire0
end type

event clicked;OpenSheet(w_typeraphor,w_principal,2,layered!)
end event

on m_typesrappels.create
call super::create
this.text = "Types de rappels"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_typesrappels.destroy
call super::destroy
end on

type m_procedures from menu within m_horaire0
end type

event clicked;opensheet(w_proctrait,w_principal,2,layered!)
w_proctrait.title = 'Procédures'
end event

on m_procedures.create
call super::create
this.text = "Regrouper des procédures"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_procedures.destroy
call super::destroy
end on

type m_cartedetraitement from menu within m_parametres
m_categoriedephrases m_categoriedephrases
m_typesdappareils m_typesdappareils
m_instructiondappareil m_instructiondappareil
m_typesderadiographies m_typesderadiographies
m_typesdefils m_typesdefils
m_typematpourfil m_typematpourfil
m_dureeelastiques m_dureeelastiques
m_forceselastiques m_forceselastiques
m_typesdelastiques m_typesdelastiques
m_typesdempreintes m_typesdempreintes
end type

on m_cartedetraitement.create
call super::create
this.text = "Carte de traitement"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_categoriedephrases=create m_categoriedephrases
this.m_typesdappareils=create m_typesdappareils
this.m_instructiondappareil=create m_instructiondappareil
this.m_typesderadiographies=create m_typesderadiographies
this.m_typesdefils=create m_typesdefils
this.m_typematpourfil=create m_typematpourfil
this.m_dureeelastiques=create m_dureeelastiques
this.m_forceselastiques=create m_forceselastiques
this.m_typesdelastiques=create m_typesdelastiques
this.m_typesdempreintes=create m_typesdempreintes
this.Item[UpperBound(this.Item)+1]=this.m_categoriedephrases
this.Item[UpperBound(this.Item)+1]=this.m_typesdappareils
this.Item[UpperBound(this.Item)+1]=this.m_instructiondappareil
this.Item[UpperBound(this.Item)+1]=this.m_typesderadiographies
this.Item[UpperBound(this.Item)+1]=this.m_typesdefils
this.Item[UpperBound(this.Item)+1]=this.m_typematpourfil
this.Item[UpperBound(this.Item)+1]=this.m_dureeelastiques
this.Item[UpperBound(this.Item)+1]=this.m_forceselastiques
this.Item[UpperBound(this.Item)+1]=this.m_typesdelastiques
this.Item[UpperBound(this.Item)+1]=this.m_typesdempreintes
end on

on m_cartedetraitement.destroy
call super::destroy
destroy(this.m_categoriedephrases)
destroy(this.m_typesdappareils)
destroy(this.m_instructiondappareil)
destroy(this.m_typesderadiographies)
destroy(this.m_typesdefils)
destroy(this.m_typematpourfil)
destroy(this.m_dureeelastiques)
destroy(this.m_forceselastiques)
destroy(this.m_typesdelastiques)
destroy(this.m_typesdempreintes)
end on

type m_categoriedephrases from menu within m_cartedetraitement
end type

event clicked;OpenSheet(w_phrasegroupe,w_principal,2,layered!)
end event

on m_categoriedephrases.create
call super::create
this.text = "Catégories de phrases"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_categoriedephrases.destroy
call super::destroy
end on

type m_typesdappareils from menu within m_cartedetraitement
end type

event clicked;OpenSheet(w_typeapp,w_principal,2,layered!)
end event

on m_typesdappareils.create
call super::create
this.text = "Types d~'appareils"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_typesdappareils.destroy
call super::destroy
end on

type m_instructiondappareil from menu within m_cartedetraitement
end type

event clicked;opensheet(w_instructapp,w_principal,2,layered!)
end event

on m_instructiondappareil.create
call super::create
this.text = "Instruction d~'appareil"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_instructiondappareil.destroy
call super::destroy
end on

type m_typesderadiographies from menu within m_cartedetraitement
end type

event clicked;OpenSheet(w_typeradio,w_principal,2,layered!)
end event

on m_typesderadiographies.create
call super::create
this.text = "Types de radiographies"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_typesderadiographies.destroy
call super::destroy
end on

type m_typesdefils from menu within m_cartedetraitement
end type

on m_typesdefils.create
call super::create
this.text = "Types de fils"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_typesdefils.destroy
call super::destroy
end on

event clicked;OpenSheet(w_typefil,w_principal,2,layered!)
end event

type m_typematpourfil from menu within m_cartedetraitement
end type

event clicked;opensheet(w_filmattype,w_principal,2,layered!)
end event

on m_typematpourfil.create
call super::create
this.text = "Type de matériaux pour fil"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_typematpourfil.destroy
call super::destroy
end on

type m_dureeelastiques from menu within m_cartedetraitement
end type

event clicked;OpenSheet(w_dureeelastique,w_principal,2,layered!)
end event

on m_dureeelastiques.create
call super::create
this.text = "Durée (élastiques)"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_dureeelastiques.destroy
call super::destroy
end on

type m_forceselastiques from menu within m_cartedetraitement
end type

event clicked;OpenSheet(w_forceelastique,w_principal,2,layered!)
end event

on m_forceselastiques.create
call super::create
this.text = "Forces (élastiques)"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_forceselastiques.destroy
call super::destroy
end on

type m_typesdelastiques from menu within m_cartedetraitement
end type

on m_typesdelastiques.create
call super::create
this.text = "Types d~'élastiques"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_typesdelastiques.destroy
call super::destroy
end on

event clicked;OpenSheet(w_typeelastique,w_principal,2,layered!)
end event

type m_typesdempreintes from menu within m_cartedetraitement
end type

on m_typesdempreintes.create
call super::create
this.text = "Types d~'empreintes"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_typesdempreintes.destroy
call super::destroy
end on

event clicked;OpenSheet(w_typeempreinte,w_principal,2,layered!)
end event

type m_listespeciality from menu within m_parametres
end type

event clicked;OpenSheet(w_speciality,w_principal,2,layered!)
end event

on m_listespeciality.create
call super::create
this.text = "Liste des spécialités"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_listespeciality.destroy
call super::destroy
end on

type m_util from menu within m_principal
m_connectionsupport m_connectionsupport
m_imprecusauto m_imprecusauto
m_impformulaires m_impformulaires
m_logs m_logs
m_fournisseurs m_fournisseurs
m_exportacomba m_exportacomba
m_refreshrdv m_refreshrdv
m_ftpbackup m_ftpbackup
m_caller m_caller
m_migration m_migration
m_exportationverssimplecomptable m_exportationverssimplecomptable
m_moneris m_moneris
m_exportationversorthocom m_exportationversorthocom
m_systemedemessagerie m_systemedemessagerie
m_envoidedébitspréautorisés m_envoidedébitspréautorisés
end type

on m_util.create
call super::create
this.text = "Utilitaires"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_connectionsupport=create m_connectionsupport
this.m_imprecusauto=create m_imprecusauto
this.m_impformulaires=create m_impformulaires
this.m_logs=create m_logs
this.m_fournisseurs=create m_fournisseurs
this.m_exportacomba=create m_exportacomba
this.m_refreshrdv=create m_refreshrdv
this.m_ftpbackup=create m_ftpbackup
this.m_caller=create m_caller
this.m_migration=create m_migration
this.m_exportationverssimplecomptable=create m_exportationverssimplecomptable
this.m_moneris=create m_moneris
this.m_exportationversorthocom=create m_exportationversorthocom
this.m_systemedemessagerie=create m_systemedemessagerie
this.m_envoidedébitspréautorisés=create m_envoidedébitspréautorisés
this.Item[UpperBound(this.Item)+1]=this.m_connectionsupport
this.Item[UpperBound(this.Item)+1]=this.m_imprecusauto
this.Item[UpperBound(this.Item)+1]=this.m_impformulaires
this.Item[UpperBound(this.Item)+1]=this.m_logs
this.Item[UpperBound(this.Item)+1]=this.m_fournisseurs
this.Item[UpperBound(this.Item)+1]=this.m_exportacomba
this.Item[UpperBound(this.Item)+1]=this.m_refreshrdv
this.Item[UpperBound(this.Item)+1]=this.m_ftpbackup
this.Item[UpperBound(this.Item)+1]=this.m_caller
this.Item[UpperBound(this.Item)+1]=this.m_migration
this.Item[UpperBound(this.Item)+1]=this.m_exportationverssimplecomptable
this.Item[UpperBound(this.Item)+1]=this.m_moneris
this.Item[UpperBound(this.Item)+1]=this.m_exportationversorthocom
this.Item[UpperBound(this.Item)+1]=this.m_systemedemessagerie
this.Item[UpperBound(this.Item)+1]=this.m_envoidedébitspréautorisés
end on

on m_util.destroy
call super::destroy
destroy(this.m_connectionsupport)
destroy(this.m_imprecusauto)
destroy(this.m_impformulaires)
destroy(this.m_logs)
destroy(this.m_fournisseurs)
destroy(this.m_exportacomba)
destroy(this.m_refreshrdv)
destroy(this.m_ftpbackup)
destroy(this.m_caller)
destroy(this.m_migration)
destroy(this.m_exportationverssimplecomptable)
destroy(this.m_moneris)
destroy(this.m_exportationversorthocom)
destroy(this.m_systemedemessagerie)
destroy(this.m_envoidedébitspréautorisés)
end on

type m_connectionsupport from menu within m_util
end type

event clicked;run("C:\ii4net\orthotek\TeamViewerQS_fr.exe")
end event

on m_connectionsupport.create
call super::create
this.text = "Connexion support"
this.menuimage = "C:\ii4net\orthotek\images\help.ico"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_connectionsupport.destroy
call super::destroy
end on

type m_imprecusauto from menu within m_util
end type

event clicked;open(w_recuautodate)
end event

on m_imprecusauto.create
call super::create
this.text = "Impression des reçus automatiques"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_imprecusauto.destroy
call super::destroy
end on

type m_impformulaires from menu within m_util
end type

event clicked;//gf_impformnorm()
opensheet(w_formdate,w_principal,2,layered!)

end event

on m_impformulaires.create
call super::create
this.text = "Impression des formulaires"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_impformulaires.destroy
call super::destroy
end on

type m_logs from menu within m_util
end type

event clicked;opensheet(w_logs,w_principal,2,layered!)
w_logs.title = 'Liste des logs'
end event

on m_logs.create
call super::create
this.text = "Logs"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_logs.destroy
call super::destroy
end on

type m_fournisseurs from menu within m_util
end type

event clicked;opensheet(w_fournisseurs,w_principal,2,layered!)
end event

on m_fournisseurs.create
call super::create
this.text = "Fournisseurs"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_fournisseurs.destroy
call super::destroy
end on

type m_exportacomba from menu within m_util
end type

event clicked;OpenSheet(w_exportacomba,w_principal,2,layered!)
w_exportacomba.title = "Exportation Acomba"
end event

on m_exportacomba.create
call super::create
this.text = "Exportation vers Acomba"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_exportacomba.destroy
call super::destroy
end on

type m_refreshrdv from menu within m_util
end type

event clicked;open(w_sysdebughor)
//open(w_sysdebugrdv)

//long i,ll_traitid,ll_patid,ll_nb
//integer li_duree
//date ldt_rdv
//time lt_rdv
//
//w_progressbar iw_progressbar
//open(iw_progressbar)
//iw_progressbar.title = 'Actualisation de la liste des rendez-vous'
//iw_progressbar.of_tache('Destruction de la table')
//delete from t_rdv;
//commit using SQLCA;
//datastore ds_rdvrefresh
//ds_rdvrefresh = create datastore
//ds_rdvrefresh.dataobject = "d_rdvrefresh"
//ds_rdvrefresh.SetTransObject(SQLCA)
//iw_progressbar.of_tache('Rechercher les rendez-vous')
//ds_rdvrefresh.retrieve()
//iw_progressbar.of_tache('Reconstruction de la table')
//ll_nb = ds_rdvrefresh.rowcount()
//iw_progressbar.of_max(ll_nb)
//for i = 1 to ll_nb
//	iw_progressbar.of_position(i)
//	ldt_rdv = ds_rdvrefresh.getitemdate(i,'datecal')
//	lt_rdv = ds_rdvrefresh.getitemtime(i,'heure')
//	ll_patid = ds_rdvrefresh.getitemnumber(i,'patient_id_1')
//	li_duree = ds_rdvrefresh.getitemnumber(i,'duree1')
//	if ll_patid > 0 and li_duree > 0 then
//		ll_traitid = ds_rdvrefresh.getitemnumber(i,'traitementid1')
//		insert into t_rdv(rdvdate,rdvheure,typetraitid,patient_id,duree,colonne) 
//		values(:ldt_rdv,:lt_rdv,:ll_traitid,:ll_patid,:li_duree,1);
//	end if
//	ll_patid = ds_rdvrefresh.getitemnumber(i,'patient_id_2')
//	li_duree = ds_rdvrefresh.getitemnumber(i,'duree2')
//	if ll_patid > 0 and li_duree > 0 then
//		ll_traitid = ds_rdvrefresh.getitemnumber(i,'traitementid2')
//		insert into t_rdv(rdvdate,rdvheure,typetraitid,patient_id,duree) 
//		values(:ldt_rdv,:lt_rdv,:ll_traitid,:ll_patid,:li_duree);
//	end if
//	ll_patid = ds_rdvrefresh.getitemnumber(i,'patient_id_3')
//	li_duree = ds_rdvrefresh.getitemnumber(i,'duree3')
//	if ll_patid > 0 and li_duree > 0 then
//		ll_traitid = ds_rdvrefresh.getitemnumber(i,'traitementid3')
//		insert into t_rdv(rdvdate,rdvheure,typetraitid,patient_id,duree) 
//		values(:ldt_rdv,:lt_rdv,:ll_traitid,:ll_patid,:li_duree);
//	end if
//	ll_patid = ds_rdvrefresh.getitemnumber(i,'patient_id_4')
//	li_duree = ds_rdvrefresh.getitemnumber(i,'duree4')
//	if ll_patid > 0 and li_duree > 0 then
//		ll_traitid = ds_rdvrefresh.getitemnumber(i,'traitementid4')
//		insert into t_rdv(rdvdate,rdvheure,typetraitid,patient_id,duree) 
//		values(:ldt_rdv,:lt_rdv,:ll_traitid,:ll_patid,:li_duree);
//	end if
//	ll_patid = ds_rdvrefresh.getitemnumber(i,'patient_id_5')
//	li_duree = ds_rdvrefresh.getitemnumber(i,'duree5')
//	if ll_patid > 0 and li_duree > 0 then
//		ll_traitid = ds_rdvrefresh.getitemnumber(i,'traitementid5')
//		insert into t_rdv(rdvdate,rdvheure,typetraitid,patient_id,duree) 
//		values(:ldt_rdv,:lt_rdv,:ll_traitid,:ll_patid,:li_duree);
//	end if
//	ll_patid = ds_rdvrefresh.getitemnumber(i,'patient_id_6')
//	li_duree = ds_rdvrefresh.getitemnumber(i,'duree6')
//	if ll_patid > 0 and li_duree > 0 then
//		ll_traitid = ds_rdvrefresh.getitemnumber(i,'traitementid6')
//		insert into t_rdv(rdvdate,rdvheure,typetraitid,patient_id,duree) 
//		values(:ldt_rdv,:lt_rdv,:ll_traitid,:ll_patid,:li_duree);
//	end if
//	ll_patid = ds_rdvrefresh.getitemnumber(i,'patient_id_7')
//	li_duree = ds_rdvrefresh.getitemnumber(i,'duree7')
//	if ll_patid > 0 and li_duree > 0 then
//		ll_traitid = ds_rdvrefresh.getitemnumber(i,'traitementid7')
//		insert into t_rdv(rdvdate,rdvheure,typetraitid,patient_id,duree) 
//		values(:ldt_rdv,:lt_rdv,:ll_traitid,:ll_patid,:li_duree);
//	end if
//	ll_patid = ds_rdvrefresh.getitemnumber(i,'patient_id_8')
//	li_duree = ds_rdvrefresh.getitemnumber(i,'duree8')
//	if ll_patid > 0 and li_duree > 0 then
//		ll_traitid = ds_rdvrefresh.getitemnumber(i,'traitementid8')
//		insert into t_rdv(rdvdate,rdvheure,typetraitid,patient_id,duree) 
//		values(:ldt_rdv,:lt_rdv,:ll_traitid,:ll_patid,:li_duree);
//	end if
//	ll_patid = ds_rdvrefresh.getitemnumber(i,'patient_id_9')
//	li_duree = ds_rdvrefresh.getitemnumber(i,'duree9')
//	if ll_patid > 0 and li_duree > 0 then
//		ll_traitid = ds_rdvrefresh.getitemnumber(i,'traitementid9')
//		insert into t_rdv(rdvdate,rdvheure,typetraitid,patient_id,duree) 
//		values(:ldt_rdv,:lt_rdv,:ll_traitid,:ll_patid,:li_duree);
//	end if
//	ll_patid = ds_rdvrefresh.getitemnumber(i,'patient_id_10')
//	li_duree = ds_rdvrefresh.getitemnumber(i,'duree10')
//	if ll_patid > 0 and li_duree > 0 then
//		ll_traitid = ds_rdvrefresh.getitemnumber(i,'traitementid10')
//		insert into t_rdv(rdvdate,rdvheure,typetraitid,patient_id,duree) 
//		values(:ldt_rdv,:lt_rdv,:ll_traitid,:ll_patid,:li_duree);
//	end if
//next
//destroy ds_rdvrefresh
//close(iw_progressbar)
end event

on m_refreshrdv.create
call super::create
this.text = "Refresh RDV"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_refreshrdv.destroy
call super::destroy
end on

type m_ftpbackup from menu within m_util
end type

event clicked;OpenSheet(w_ftpbackup,w_principal,2,layered!)
w_ftpbackup.title = "Ftp Backup"
end event

on m_ftpbackup.create
call super::create
this.text = "Ftp Backup"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_ftpbackup.destroy
call super::destroy
end on

type m_caller from menu within m_util
end type

event clicked;OpenSheet(w_caller,w_principal,2,layered!)
w_caller.title = "Caller"
end event

on m_caller.create
call super::create
this.text = "Caller"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_caller.destroy
call super::destroy
end on

type m_migration from menu within m_util
m_orthocom m_orthocom
m_focus m_focus
m_ctrl m_ctrl
m_ad2000 m_ad2000
m_autre m_autre
end type

event clicked;//SetPointer(HourGlass!)
//opensheet(w_migrate_eval_meb,w_principal,2,layered!)
end event

on m_migration.create
call super::create
this.text = "Migration"
this.microhelp = "Migration"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_orthocom=create m_orthocom
this.m_focus=create m_focus
this.m_ctrl=create m_ctrl
this.m_ad2000=create m_ad2000
this.m_autre=create m_autre
this.Item[UpperBound(this.Item)+1]=this.m_orthocom
this.Item[UpperBound(this.Item)+1]=this.m_focus
this.Item[UpperBound(this.Item)+1]=this.m_ctrl
this.Item[UpperBound(this.Item)+1]=this.m_ad2000
this.Item[UpperBound(this.Item)+1]=this.m_autre
end on

on m_migration.destroy
call super::destroy
destroy(this.m_orthocom)
destroy(this.m_focus)
destroy(this.m_ctrl)
destroy(this.m_ad2000)
destroy(this.m_autre)
end on

type m_orthocom from menu within m_migration
end type

on m_orthocom.create
call super::create
this.text = "ORTHOCOM"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_orthocom.destroy
call super::destroy
end on

event clicked;opensheet(w_migrationorthocom,w_principal,2,layered!)
w_migrationorthocom.title = 'Migration Orthocom'
end event

type m_focus from menu within m_migration
end type

on m_focus.create
call super::create
this.text = "FOCUS"
this.enabled = false
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_focus.destroy
call super::destroy
end on

type m_ctrl from menu within m_migration
end type

on m_ctrl.create
call super::create
this.text = "CTRL"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_ctrl.destroy
call super::destroy
end on

event clicked;opensheet(w_migctrl,w_principal,2,layered!)
w_migctrl.title = "Migration CTRL"
end event

type m_ad2000 from menu within m_migration
end type

event clicked;opensheet(w_migrad2000,w_principal,2,layered!)
w_migrad2000.title = 'Migration AD2000'
end event

on m_ad2000.create
call super::create
this.text = "AD2000"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_ad2000.destroy
call super::destroy
end on

type m_autre from menu within m_migration
end type

event clicked;opensheet(w_migrautre,w_principal,2,layered!)
w_migrautre.title = 'Migration AUTRE'
end event

on m_autre.create
call super::create
this.text = "AUTRE"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_autre.destroy
call super::destroy
end on

type m_exportationverssimplecomptable from menu within m_util
end type

event clicked;OpenSheet(w_exportsimple,w_principal,2,layered!)
w_exportsimple.title = "Exportation Simple Comptable"
end event

on m_exportationverssimplecomptable.create
call super::create
this.text = "Exportation vers Simple Comptable"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_exportationverssimplecomptable.destroy
call super::destroy
end on

type m_moneris from menu within m_util
end type

event clicked;OpenSheet(w_moneris,w_principal,2,layered!)
w_moneris.title = "Envoi Moneris"

end event

on m_moneris.create
call super::create
this.text = "Exportation carte de crédit"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_moneris.destroy
call super::destroy
end on

type m_exportationversorthocom from menu within m_util
end type

on m_exportationversorthocom.create
call super::create
this.text = "Exportation vers Orthocom"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_exportationversorthocom.destroy
call super::destroy
end on

event clicked;opensheet(w_exportorthocom,w_principal,2,layered!)
end event

type m_systemedemessagerie from menu within m_util
m_boîtederéception m_boîtederéception
m_ecrireunnouveaumessage m_ecrireunnouveaumessage
end type

on m_systemedemessagerie.create
call super::create
this.text = "Système de messagerie"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_boîtederéception=create m_boîtederéception
this.m_ecrireunnouveaumessage=create m_ecrireunnouveaumessage
this.Item[UpperBound(this.Item)+1]=this.m_boîtederéception
this.Item[UpperBound(this.Item)+1]=this.m_ecrireunnouveaumessage
end on

on m_systemedemessagerie.destroy
call super::destroy
destroy(this.m_boîtederéception)
destroy(this.m_ecrireunnouveaumessage)
end on

type m_boîtederéception from menu within m_systemedemessagerie
end type

on m_boîtederéception.create
call super::create
this.text = "Boîte de réception"
this.toolbaritemname = "c:\ii4net\dentitek\images\mail.gif"
this.toolbaritemtext = "Messages"
this.toolbaritemorder = 41
this.menuimage = "c:\ii4net\orthotek\images\mail.bmp"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_boîtederéception.destroy
call super::destroy
end on

event clicked;w_boite_reception lw_fen

opensheet(lw_fen,w_principal,2,layered!)
end event

type m_ecrireunnouveaumessage from menu within m_systemedemessagerie
end type

on m_ecrireunnouveaumessage.create
call super::create
this.text = "Écrire un nouveau message"
this.menuimage = "c:\ii4net\orthotek\images\sent.bmp"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_ecrireunnouveaumessage.destroy
call super::destroy
end on

event clicked;w_envoi_message lw_sheet

opensheet(lw_sheet,w_principal,2,layered!)
end event

type m_envoidedébitspréautorisés from menu within m_util
end type

event clicked;OpenSheet(w_envoidpa,w_principal,2,layered!)
w_exportacomba.title = "Liste de débits préautorisés"
end event

on m_envoidedébitspréautorisés.create
call super::create
this.text = "Envoi de débits préautorisés"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_envoidedébitspréautorisés.destroy
call super::destroy
end on

type m_config from menu within m_principal
m_gestionimprimantes m_gestionimprimantes
m_options m_options
m_optionspersonnel m_optionspersonnel
m_autoupdate m_autoupdate
m_nouveautes m_nouveautes
m_edit m_edit
m_pwd m_pwd
m_ftpbackupfolder m_ftpbackupfolder
m_registration m_registration
m_cachefactpaie m_cachefactpaie
m_routinecachefactpaie m_routinecachefactpaie
m_promaintenance m_promaintenance
end type

on m_config.create
call super::create
this.text = "Configuration"
this.microhelp = "Configuration"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_gestionimprimantes=create m_gestionimprimantes
this.m_options=create m_options
this.m_optionspersonnel=create m_optionspersonnel
this.m_autoupdate=create m_autoupdate
this.m_nouveautes=create m_nouveautes
this.m_edit=create m_edit
this.m_pwd=create m_pwd
this.m_ftpbackupfolder=create m_ftpbackupfolder
this.m_registration=create m_registration
this.m_cachefactpaie=create m_cachefactpaie
this.m_routinecachefactpaie=create m_routinecachefactpaie
this.m_promaintenance=create m_promaintenance
this.Item[UpperBound(this.Item)+1]=this.m_gestionimprimantes
this.Item[UpperBound(this.Item)+1]=this.m_options
this.Item[UpperBound(this.Item)+1]=this.m_optionspersonnel
this.Item[UpperBound(this.Item)+1]=this.m_autoupdate
this.Item[UpperBound(this.Item)+1]=this.m_nouveautes
this.Item[UpperBound(this.Item)+1]=this.m_edit
this.Item[UpperBound(this.Item)+1]=this.m_pwd
this.Item[UpperBound(this.Item)+1]=this.m_ftpbackupfolder
this.Item[UpperBound(this.Item)+1]=this.m_registration
this.Item[UpperBound(this.Item)+1]=this.m_cachefactpaie
this.Item[UpperBound(this.Item)+1]=this.m_routinecachefactpaie
this.Item[UpperBound(this.Item)+1]=this.m_promaintenance
end on

on m_config.destroy
call super::destroy
destroy(this.m_gestionimprimantes)
destroy(this.m_options)
destroy(this.m_optionspersonnel)
destroy(this.m_autoupdate)
destroy(this.m_nouveautes)
destroy(this.m_edit)
destroy(this.m_pwd)
destroy(this.m_ftpbackupfolder)
destroy(this.m_registration)
destroy(this.m_cachefactpaie)
destroy(this.m_routinecachefactpaie)
destroy(this.m_promaintenance)
end on

type m_gestionimprimantes from menu within m_config
end type

event clicked;opensheet(w_printers,w_principal,2,layered!)
end event

on m_gestionimprimantes.create
call super::create
this.text = "Gestion des imprimantes"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_gestionimprimantes.destroy
call super::destroy
end on

type m_options from menu within m_config
end type

event clicked;opensheet(w_options,w_principal,2,layered!)
end event

on m_options.create
call super::create
this.text = "Options"
this.microhelp = "Options"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_options.destroy
call super::destroy
end on

type m_optionspersonnel from menu within m_config
end type

event clicked;opensheet(w_optionpers,w_principal,2,layered!)
end event

on m_optionspersonnel.create
call super::create
this.text = "Options personnels"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_optionspersonnel.destroy
call super::destroy
end on

type m_autoupdate from menu within m_config
end type

event clicked;string	ls_nom_fichier

choose case gnv_app.of_majpossible()
	case -1, 0 // Dernière version
		error_type(1017)
	case -2 // Erreur (internet ?)
		if gnv_app.of_getlangue() = 'an' then
			Messagebox("System error", "The update failed. Contact the customer support.")
		else
			Messagebox("Erreur système", "La mise-à-jour a échoué. Contactez le support à la clientèle.")
		end if
	case 1 // Mise-à-jour possible
		if error_type(265) = 2 then return
		
		SetPointer(HourGlass!)
		
		//Télécharger le fichier
		ls_nom_fichier = gnv_app.of_nom_fichier_maj()
		IF ls_nom_fichier = "" THEN
			error_type(1015)
			RETURN
		END IF
		
		IF gnv_app.of_telechargerfichiermaj(ls_nom_fichier) = 1 THEN
			error_type(1016)
		END IF
end choose
end event

on m_autoupdate.create
call super::create
this.visible = false
this.text = "Mise-à-jour logiciel"
this.toolbaritemvisible = false
this.toolbaritemname = "custom042!"
this.toolbaritemtext = "Update"
this.toolbaritemorder = 61
this.menuimage = "Custom042!"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.menuanimation = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_autoupdate.destroy
call super::destroy
end on

type m_nouveautes from menu within m_config
end type

event clicked;string ls_url, ls_ver[]

ls_ver = split(gnv_app.of_getVersion(), '.')

ls_url = "http://www.progitek.ca/application/Orthotek/files/Notes_Update_Orthotek_"
ls_url += ls_ver[1] + "_" + ls_ver[2] + ".html"
run("C:\Program Files\Internet Explorer\iexplore.exe " + ls_url, Maximized! )

end event

on m_nouveautes.create
call super::create
this.text = "Nouveautés"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_nouveautes.destroy
call super::destroy
end on

type m_edit from menu within m_config
m_gestionpers m_gestionpers
m_groupes m_groupes
m_persbarreoutils m_persbarreoutils
m_entrerortho m_entrerortho
m_couleurs0 m_couleurs0
m_labeledit m_labeledit
m_générateurderapport m_générateurderapport
end type

on m_edit.create
call super::create
this.text = "Edition"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_gestionpers=create m_gestionpers
this.m_groupes=create m_groupes
this.m_persbarreoutils=create m_persbarreoutils
this.m_entrerortho=create m_entrerortho
this.m_couleurs0=create m_couleurs0
this.m_labeledit=create m_labeledit
this.m_générateurderapport=create m_générateurderapport
this.Item[UpperBound(this.Item)+1]=this.m_gestionpers
this.Item[UpperBound(this.Item)+1]=this.m_groupes
this.Item[UpperBound(this.Item)+1]=this.m_persbarreoutils
this.Item[UpperBound(this.Item)+1]=this.m_entrerortho
this.Item[UpperBound(this.Item)+1]=this.m_couleurs0
this.Item[UpperBound(this.Item)+1]=this.m_labeledit
this.Item[UpperBound(this.Item)+1]=this.m_générateurderapport
end on

on m_edit.destroy
call super::destroy
destroy(this.m_gestionpers)
destroy(this.m_groupes)
destroy(this.m_persbarreoutils)
destroy(this.m_entrerortho)
destroy(this.m_couleurs0)
destroy(this.m_labeledit)
destroy(this.m_générateurderapport)
end on

type m_gestionpers from menu within m_edit
end type

event clicked;opensheet(w_personnels,w_principal,2,layered!)
w_principal.SetMicroHelp('Gestion du personnel')
end event

on m_gestionpers.create
call super::create
this.text = "Gestion du personnel"
this.microhelp = "Gestion du personnel"
this.toolbaritembarindex = 0
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_gestionpers.destroy
call super::destroy
end on

type m_groupes from menu within m_edit
end type

event clicked;opensheet(w_groupes,w_principal,2,layered!)
w_principal.SetMicroHelp("Gestion des groupes d'utilisateurs")

end event

on m_groupes.create
call super::create
this.text = "Gestion des groupes d~'utilisateurs"
this.microhelp = "Gestion des groupes d~'utilisateurs"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_groupes.destroy
call super::destroy
end on

type m_persbarreoutils from menu within m_edit
end type

event clicked;OpenSheet(w_persbaroutils,w_principal,2,layered!)

end event

on m_persbarreoutils.create
call super::create
this.text = "Personalisation de la barre d~'outils"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_persbarreoutils.destroy
call super::destroy
end on

type m_entrerortho from menu within m_edit
event destroy ( )
end type

on m_entrerortho.destroy
call super::destroy
end on

event clicked;OpenSheet(w_entrer_ortho,w_principal,2,original!)
w_entrer_ortho.move(1,1)
end event

on m_entrerortho.create
call super::create
this.text = "Coordonnées du spécialiste"
this.microhelp = "Entrer Ortho."
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

type m_couleurs0 from menu within m_edit
end type

event clicked;if isvalid(w_type_traitements) = true then
	close(w_type_traitements)
end if
OpenSheet(w_gestioncouleurs,w_principal,2,original!)
w_gestioncouleurs.move(1,1)

end event

on m_couleurs0.create
call super::create
this.text = "Gestion des couleurs"
this.microhelp = "Gestion couleurs"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_couleurs0.destroy
call super::destroy
end on

type m_labeledit from menu within m_edit
end type

event clicked;OpenSheet(w_etiqchoix,w_principal,2,layered!)
end event

on m_labeledit.create
call super::create
this.text = "Édition des étiquettes"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_labeledit.destroy
call super::destroy
end on

type m_générateurderapport from menu within m_edit
end type

on m_générateurderapport.create
call super::create
this.text = "Générateur de rapport"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_générateurderapport.destroy
call super::destroy
end on

event clicked;opensheetwithparm(w_genrapp,1,w_principal,2,layered!)
w_genrapp.title = "Générateur de rapport"
end event

type m_pwd from menu within m_config
m_passsupppat m_passsupppat
m_passlogon m_passlogon
m_passpaie m_passpaie
end type

on m_pwd.create
call super::create
this.text = "Mot de passe"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
this.m_passsupppat=create m_passsupppat
this.m_passlogon=create m_passlogon
this.m_passpaie=create m_passpaie
this.Item[UpperBound(this.Item)+1]=this.m_passsupppat
this.Item[UpperBound(this.Item)+1]=this.m_passlogon
this.Item[UpperBound(this.Item)+1]=this.m_passpaie
end on

on m_pwd.destroy
call super::destroy
destroy(this.m_passsupppat)
destroy(this.m_passlogon)
destroy(this.m_passpaie)
end on

type m_passsupppat from menu within m_pwd
event destroy ( )
end type

on m_passsupppat.destroy
call super::destroy
end on

event clicked;open(w_password)
end event

on m_passsupppat.create
call super::create
this.text = "Mot de Passe (suppression patient)"
this.enabled = false
this.microhelp = "Mot de Passe (suppression patient)"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

type m_passlogon from menu within m_pwd
event destroy ( )
end type

on m_passlogon.destroy
call super::destroy
end on

event clicked;open(w_password_ortho)
end event

on m_passlogon.create
call super::create
this.text = "Mot de Passe (Logon)"
this.enabled = false
this.microhelp = "Mot de Passe (Logon)"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

type m_passpaie from menu within m_pwd
event destroy ( )
end type

on m_passpaie.destroy
call super::destroy
end on

event clicked;open(w_password_paiement)
end event

on m_passpaie.create
call super::create
this.text = "Mot de Passe (paiement)"
this.enabled = false
this.microhelp = "Mot de Passe (paiement)"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

type m_ftpbackupfolder from menu within m_config
end type

event clicked;opensheet(w_ftpbackfldr,w_principal,2,layered!)
w_ftpbackfldr.title = 'Ftp Backup folder'
end event

on m_ftpbackupfolder.create
call super::create
this.text = "Ftp Backup folder"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_ftpbackupfolder.destroy
call super::destroy
end on

type m_registration from menu within m_config
end type

event clicked;open(w_registration)
end event

on m_registration.create
call super::create
this.text = "Registration"
this.microhelp = "Registration"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_registration.destroy
call super::destroy
end on

type m_cachefactpaie from menu within m_config
end type

event clicked;long l_traitement_id

//if isvalid(w_traitements) = true and ( gs_postocc = 'O' or gs_postocc = 'A') then
//	l_traitement_id = w_traitements.il_traitid
//	Opensheetwithparm(w_cacher_factures_paiements,l_traitement_id,w_traitements,2,layered!)
//elseif gs_postocc = 'O' or gs_postocc = 'A' then
	opensheet(w_cacher_factures_rapport,w_principal,2,layered!)
//end if
end event

on m_cachefactpaie.create
call super::create
this.tag = "invisible"
this.visible = false
this.text = "Activer comptes spéciaux~tCtrl+Alt+Shift+Z"
this.shortcut = 1882
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_cachefactpaie.destroy
call super::destroy
end on

type m_routinecachefactpaie from menu within m_config
event create ( )
event destroy ( )
end type

on m_routinecachefactpaie.create
call super::create
this.tag = "invisible"
this.visible = false
this.text = "Comptes spéciaux~tCtrl+Alt+Z"
this.shortcut = 858
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_routinecachefactpaie.destroy
call super::destroy
end on

event clicked;long v_row_fact,v_fact_id,ll_traitid,v_paiement_id
integer v_check
date v_date_fact
dec{2} v_montant_fact
if isvalid(w_traitements) = true then
	v_check = w_traitements.tab_selected
	if w_traitements.tab_selected = 1 then
		v_row_fact = w_traitements.tab_sommaires.tabpage_factures.dw_factures_sommaire.getrow()
		ll_traitid = w_traitements.il_traitid
		v_date_fact = w_traitements.tab_sommaires.tabpage_factures.dw_factures_sommaire.getitemdate(v_row_fact,'date_facture')
		v_montant_fact = w_traitements.tab_sommaires.tabpage_factures.dw_factures_sommaire.getitemnumber(v_row_fact,'montant')
		select count(*) into :v_check from paiement where montant_recu = :v_montant_fact and date_paiement = :v_date_fact and traitement_patient_id = :ll_traitid;
		if v_check = 1 then
			v_fact_id = w_traitements.tab_sommaires.tabpage_factures.dw_factures_sommaire.getitemnumber(v_row_fact,'facture_id')
			v_check = w_traitements.tab_sommaires.tabpage_factures.dw_factures_sommaire.getitemnumber(v_row_fact,'cache')
			if v_check = 1 then
				update factures_traitements set cache = 0 where facture_id = :v_fact_id;
				update paiement set cache = 0 where montant_recu = :v_montant_fact and date_paiement = :v_date_fact and traitement_patient_id = :ll_traitid;
				commit;
			else
				update factures_traitements set cache = 1 where facture_id = :v_fact_id;
				update paiement set cache = 1 where montant_recu = :v_montant_fact and date_paiement = :v_date_fact and traitement_patient_id = :ll_traitid;
				commit;
			end if
			if error_type(203) = 1 then
				Opensheetwithparm(w_cacher_factures_paiements,ll_traitid,w_traitements,2,layered!)
			end if
		end if
	end if
end if
end event

type m_promaintenance from menu within m_config
end type

event clicked;opensheet(w_codesql,w_principal,2,layered!)
w_codesql.title = 'Requête SQL'
end event

on m_promaintenance.create
call super::create
this.visible = false
this.text = "Progitek (maintenance)"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_promaintenance.destroy
call super::destroy
end on

type m_apropos from menu within m_principal
end type

on m_apropos.create
call super::create
this.text = "À propos ..."
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_apropos.destroy
call super::destroy
end on

event clicked;string ls_ver

select vertable into :ls_ver from t_ver;

if v_langue = 'fr' then
	if gs_drspecial = 'P' then
		messagebox('',"PAROTEK version "+gnv_app.of_getVersion()+"~r~nBD version "+ls_ver+"~n~n Développé par : Progitek Inc. ~n Adresse           : 2323 boul. du Versant nord bur. 203 ~n Ville                  : Ste-Foy (Qc) ~n Code Postal     : G1N 4P4 ~n Tel                   : (418) 686-8786 ~n Tel                   : (514) 954-9114")
	else
		messagebox('',"ORTHOTEK version "+gnv_app.of_getVersion()+"~r~nBD version "+ls_ver+" ~n~n Développé par : Progitek Inc. ~n Adresse           : 2323 boul. du Versant nord bur. 203 ~n Ville                  : Ste-Foy (Qc) ~n Code Postal     : G1N 4P4 ~n Tel                   : (418) 686-8786 ~n Tel                   : (514) 954-9114")
	end if
else
	if gs_drspecial = 'P' then
		messagebox('',"PAROTEK version "+gnv_app.of_getVersion()+"~r~n DB version "+ls_ver+" ~n~n Developed by  : Progitek Inc. ~n Address           : 2323 boul. du Versant nord # 204 ~n City                  : Ste-Foy (Qc) ~n  Postal Code    : G1N 4P4 ~n Tel                  : (418) 952-7011 ~n Tel                   : (514) 954-9114")
	else
		messagebox('',"ORTHOTEK version "+gnv_app.of_getVersion()+"~r~n DB version "+ls_ver+" ~n~n Developed by  : Progitek Inc. ~n Address           : 2323 boul. du Versant nord # 204 ~n City                  : Ste-Foy (Qc) ~n  Postal Code    : G1N 4P4 ~n Tel                  : (418) 952-7011 ~n Tel                   : (514) 954-9114")
	end if
end if
end event

type m_4 from menu within m_principal
end type

event clicked;ShowHelp("C:\ii4net\orthotek\orthotek.chm", Index!)
end event

on m_4.create
call super::create
this.text = "?"
this.menustyle = contemporarymenu!
this.menubackcolor = 15793151
this.menuhighlightcolor = 134217741
this.textsize = 8
this.weight = 400
this.facename = "Tahoma"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 134217729
this.menubitmaps = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 16777215
this.toolbarbackcolor = 134217741
this.toolbarhighlightcolor = 134217741
this.toolbargradient = true
this.bitmapgradient = true
end on

on m_4.destroy
call super::destroy
end on

