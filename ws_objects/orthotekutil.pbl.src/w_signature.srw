$PBExportHeader$w_signature.srw
forward
global type w_signature from w_response
end type
type rr_1 from roundrectangle within w_signature
end type
type uo_toolbar from u_cst_toolbarstrip within w_signature
end type
type ole_sign from olecustomcontrol within w_signature
end type
type st_title from statictext within w_signature
end type
end forward

global type w_signature from w_response
integer x = 214
integer y = 221
integer width = 2226
integer height = 660
boolean titlebar = false
boolean controlmenu = false
boolean border = false
long backcolor = 15780518
boolean center = true
rr_1 rr_1
uo_toolbar uo_toolbar
ole_sign ole_sign
st_title st_title
end type
global w_signature w_signature

type variables
string is_signature
end variables

forward prototypes
public subroutine uf_traduction ()
public subroutine of_startsign ()
public subroutine of_stopsign ()
public function string of_savesign ()
end prototypes

public subroutine uf_traduction ();uo_toolbar.of_displayborder(true)
uo_toolbar.of_settheme("classics")

if gnv_app.of_getlangue( ) = 'an' then
	uo_toolbar.of_additem("Start sign","Custom082!")
	uo_toolbar.of_additem("Stop sign", "RetrieveCancel!")
	uo_toolbar.of_additem("Save sign", "DosEdit!")
	uo_toolbar.of_additem("Close","Exit!")
	st_title.text = "Enter your signature"
else
	uo_toolbar.of_additem("Démarrer signature","Custom082!")
	uo_toolbar.of_additem("Arrêter signature", "RetrieveCancel!")
	uo_toolbar.of_additem("Sauvegarder signature", "DosEdit!")
	uo_toolbar.of_additem("Fermer","Exit!")
end if

uo_toolbar.of_displaytext(true)
end subroutine

public subroutine of_startsign ();integer li_ret

ole_sign.object.TabletState = 1

ole_sign.object.setEventEnableMask (3)
ole_sign.object.cleartablet()

end subroutine

public subroutine of_stopsign ();integer li_ret

ole_sign.object.TabletState = 0

ole_sign.object.cleartablet()

end subroutine

public function string of_savesign ();//ll_x = gnv_app.inv_entrepotglobal.of_retournedonnee("DimensionX")
//ll_y = gnv_app.inv_entrepotglobal.of_retournedonnee("DimensionY")

ole_Sign.object.ImageFileFormat = 4
ole_Sign.object.ImageYsize = 60
ole_Sign.object.ImageXsize = 300
ole_Sign.object.WriteImageFile("c:\ii4net\dentitek\signature.jpg")
do while yield()
LOOP
	
return "c:\ii4net\dentitek\signature.jpg"



end function

on w_signature.create
int iCurrent
call super::create
this.rr_1=create rr_1
this.uo_toolbar=create uo_toolbar
this.ole_sign=create ole_sign
this.st_title=create st_title
iCurrent=UpperBound(this.Control)
this.Control[iCurrent+1]=this.rr_1
this.Control[iCurrent+2]=this.uo_toolbar
this.Control[iCurrent+3]=this.ole_sign
this.Control[iCurrent+4]=this.st_title
end on

on w_signature.destroy
call super::destroy
destroy(this.rr_1)
destroy(this.uo_toolbar)
destroy(this.ole_sign)
destroy(this.st_title)
end on

event open;call super::open;integer li_ret

ole_sign.object.TabletState = 1

ole_sign.object.setEventEnableMask (3)
ole_sign.object.cleartablet()

end event

type rr_1 from roundrectangle within w_signature
long linecolor = 33554432
integer linethickness = 4
long fillcolor = 15793151
integer y = 8
integer width = 2222
integer height = 104
integer cornerheight = 40
integer cornerwidth = 46
end type

type uo_toolbar from u_cst_toolbarstrip within w_signature
integer x = 18
integer y = 544
integer width = 2194
integer taborder = 20
end type

on uo_toolbar.destroy
call u_cst_toolbarstrip::destroy
end on

event ue_buttonclicked;call super::ue_buttonclicked;CHOOSE CASE as_button
	CASE "Start sign","Démarrer signature"
		of_startsign()
	CASE "Stop sign","Arrêter signature"
		of_stopsign()
	CASE "Save sign","Sauvegarder signature"
		is_signature = of_savesign()
		of_stopsign()
		gnv_app.inv_entrepotglobal.of_ajoutedonnee("Signaturedentiste", is_signature)
		close(parent)
	CASE "Close","Fermer"
		of_stopsign()
		close(parent)
END CHOOSE
end event

type ole_sign from olecustomcontrol within w_signature
event tablettimerevent ( )
event pendown ( )
event penup ( )
event ocx_clicked ( )
event penpoint ( )
integer x = 18
integer y = 140
integer width = 2194
integer height = 384
integer taborder = 10
boolean focusrectangle = false
string binarykey = "w_signature.win"
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
end type

type st_title from statictext within w_signature
integer x = 32
integer y = 24
integer width = 768
integer height = 64
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 15793151
string text = "S.V.P. entrer votre signature"
boolean focusrectangle = false
end type


Start of PowerBuilder Binary Data Section : Do NOT Edit
0Fw_signature.bin 
2100000c00e011cfd0e11ab1a1000000000000000000000000000000000003003e0009fffe000000060000000000000000000000010000000100000000000010000000000200000001fffffffe0000000000000000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdfffffffefffffffe00000004fffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff006f00520074006f004500200074006e00790072000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050016ffffffffffffffff0000000100000000000000000000000000000000000000000000000000000000568dd0b001ccb43600000003000002800000000000500003004f0042005800430054005300450052004d0041000000000000000000000000000000000000000000000000000000000000000000000000000000000102001affffffff00000002ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000004200500043004f00530058004f00540041005200450047000000000000000000000000000000000000000000000000000000000000000000000000000000000001001affffffffffffffff0000000369a40da311d04d420000b0864a8625c000000000568dd0b001ccb436568dd0b001ccb436000000000000000000000000006f00430074006e006e00650073007400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001020012ffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000008000000800000000000000001000000020000000300000004000000050000000600000007fffffffe00000009fffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
26ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000fffe0002010569a40da311d04d420000b0864a8625c000000001fb8f0821101b01640008ed8413c72e2b00000030000001d00000000d00000100000000700000010100000078000001020000008000000103000000880000010400000090000001050000009800000106000000a000000107000000a800000108000000b000000109000000b80000010a000000c00000010b000000c800000000000000d00000000300020017000000030000319c00000003000009ec000000030000000900000002000007d000000002000002bc00000002000001900000000200000960000000020000041a0000000200000006000000020000000100000041000000000000000d000000000000000100010a0000000e00626174006374656c6f706d6f080074720c00000174000000656c6261747379740400706f1300000174000000656c6261676f6c746c6163697a69737801050065001300006174000074656c6269676f6c796c6163657a69730001030000000c0074735f00706b636f73706f7200010b000000080067697300626f6c62000101000000090078655f00746e657401060078000d00006174000074656c626174737802007472090000015f000000657478650079746e000001090000000b6c6261746f6d746500006564090000015f00000073726576006e6f69000001070000000c6c6261747378746500706f74000200170000319c000009ec000000090000000000ffffff000000000001000002bc07d0015e0190041a0960000400040001000600004b000001000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000010000000000000043003b005c003a007200500067006f006100720020006d006900460065006c005c0073007900530061006d0074006e006300650070005c004100630079006e0068007700720065005c00650043003b005c003a006200700031003100310035006c0064005c006c0043003b005c003a006200700031003100310035006c0064005c006c0043003b005c003a007200500067006f006100720020006d006900460065006c005c00730070004f006e006500500056005c004e006900620000006e016900190065007000150240001fd7d80072007300640076006f0072006400700077006f0073006e0061006500630072002e0068006400750020006f007800280020002900340028003900390029003200300020002d0031003200310032002d0031003000200031003400310034003a003a00340037003300000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1Fw_signature.bin 
End of PowerBuilder Binary Data Section : No Source Expected After This Point
