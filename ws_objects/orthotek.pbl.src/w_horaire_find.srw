$PBExportHeader$w_horaire_find.srw
forward
global type w_horaire_find from w_child
end type
type em_timestart1 from editmask within w_horaire_find
end type
type em_timeend1 from editmask within w_horaire_find
end type
type st_et1 from statictext within w_horaire_find
end type
type uo_calutil2 from u_calutil within w_horaire_find
end type
type uo_calutil1 from u_calutil within w_horaire_find
end type
type cbx_c10 from checkbox within w_horaire_find
end type
type cbx_c9 from checkbox within w_horaire_find
end type
type cbx_c8 from checkbox within w_horaire_find
end type
type cbx_c7 from checkbox within w_horaire_find
end type
type cbx_c6 from checkbox within w_horaire_find
end type
type st_4 from statictext within w_horaire_find
end type
type em_sem from editmask within w_horaire_find
end type
type st_3 from statictext within w_horaire_find
end type
type dw_horairefindlistpers from u_dw within w_horaire_find
end type
type cbx_pers from checkbox within w_horaire_find
end type
type st_precision from statictext within w_horaire_find
end type
type em_precision from editmask within w_horaire_find
end type
type cb_d2 from commandbutton within w_horaire_find
end type
type cb_d1 from commandbutton within w_horaire_find
end type
type hpb_search from hprogressbar within w_horaire_find
end type
type st_a from statictext within w_horaire_find
end type
type st_2 from statictext within w_horaire_find
end type
type em_end from editmask within w_horaire_find
end type
type em_begin from editmask within w_horaire_find
end type
type cb_1 from commandbutton within w_horaire_find
end type
type st_et from statictext within w_horaire_find
end type
type st_entre from statictext within w_horaire_find
end type
type em_time_end from editmask within w_horaire_find
end type
type em_time_start from editmask within w_horaire_find
end type
type cbx_vendredi from checkbox within w_horaire_find
end type
type cbx_jeudi from checkbox within w_horaire_find
end type
type cbx_mercredi from checkbox within w_horaire_find
end type
type cbx_mardi from checkbox within w_horaire_find
end type
type cbx_lundi from checkbox within w_horaire_find
end type
type cbx_c5 from checkbox within w_horaire_find
end type
type cbx_c4 from checkbox within w_horaire_find
end type
type cbx_c3 from checkbox within w_horaire_find
end type
type cbx_c2 from checkbox within w_horaire_find
end type
type cbx_c1 from checkbox within w_horaire_find
end type
type cb_close from commandbutton within w_horaire_find
end type
type cb_go from commandbutton within w_horaire_find
end type
type ddlb_minutes from dropdownlistbox within w_horaire_find
end type
type st_1 from statictext within w_horaire_find
end type
type tab_c from tab within w_horaire_find
end type
type tabpage_all from userobject within tab_c
end type
type st_chaiseall from statictext within tabpage_all
end type
type st_heureall from statictext within tabpage_all
end type
type st_dateall from statictext within tabpage_all
end type
type lb_call from listbox within tabpage_all
end type
type tabpage_all from userobject within tab_c
st_chaiseall st_chaiseall
st_heureall st_heureall
st_dateall st_dateall
lb_call lb_call
end type
type tabpage_c1 from userobject within tab_c
end type
type lb_c1 from listbox within tabpage_c1
end type
type st_date1 from statictext within tabpage_c1
end type
type st_chaise1 from statictext within tabpage_c1
end type
type st_heure1 from statictext within tabpage_c1
end type
type tabpage_c1 from userobject within tab_c
lb_c1 lb_c1
st_date1 st_date1
st_chaise1 st_chaise1
st_heure1 st_heure1
end type
type tabpage_c2 from userobject within tab_c
end type
type st_chaise2 from statictext within tabpage_c2
end type
type st_heure2 from statictext within tabpage_c2
end type
type st_date2 from statictext within tabpage_c2
end type
type lb_c2 from listbox within tabpage_c2
end type
type tabpage_c2 from userobject within tab_c
st_chaise2 st_chaise2
st_heure2 st_heure2
st_date2 st_date2
lb_c2 lb_c2
end type
type tabpage_c3 from userobject within tab_c
end type
type st_chaise3 from statictext within tabpage_c3
end type
type st_heure3 from statictext within tabpage_c3
end type
type st_date3 from statictext within tabpage_c3
end type
type lb_c3 from listbox within tabpage_c3
end type
type tabpage_c3 from userobject within tab_c
st_chaise3 st_chaise3
st_heure3 st_heure3
st_date3 st_date3
lb_c3 lb_c3
end type
type tabpage_c4 from userobject within tab_c
end type
type st_chaise4 from statictext within tabpage_c4
end type
type st_heure4 from statictext within tabpage_c4
end type
type st_date4 from statictext within tabpage_c4
end type
type lb_c4 from listbox within tabpage_c4
end type
type tabpage_c4 from userobject within tab_c
st_chaise4 st_chaise4
st_heure4 st_heure4
st_date4 st_date4
lb_c4 lb_c4
end type
type tabpage_c5 from userobject within tab_c
end type
type st_chaise5 from statictext within tabpage_c5
end type
type st_heure5 from statictext within tabpage_c5
end type
type st_date5 from statictext within tabpage_c5
end type
type lb_c5 from listbox within tabpage_c5
end type
type tabpage_c5 from userobject within tab_c
st_chaise5 st_chaise5
st_heure5 st_heure5
st_date5 st_date5
lb_c5 lb_c5
end type
type tabpage_c6 from userobject within tab_c
end type
type st_chaise6 from statictext within tabpage_c6
end type
type st_heure6 from statictext within tabpage_c6
end type
type st_date6 from statictext within tabpage_c6
end type
type lb_c6 from listbox within tabpage_c6
end type
type tabpage_c6 from userobject within tab_c
st_chaise6 st_chaise6
st_heure6 st_heure6
st_date6 st_date6
lb_c6 lb_c6
end type
type tabpage_c7 from userobject within tab_c
end type
type st_chaise7 from statictext within tabpage_c7
end type
type st_heure7 from statictext within tabpage_c7
end type
type st_date7 from statictext within tabpage_c7
end type
type lb_c7 from listbox within tabpage_c7
end type
type tabpage_c7 from userobject within tab_c
st_chaise7 st_chaise7
st_heure7 st_heure7
st_date7 st_date7
lb_c7 lb_c7
end type
type tabpage_c8 from userobject within tab_c
end type
type st_chaise8 from statictext within tabpage_c8
end type
type st_heure8 from statictext within tabpage_c8
end type
type st_date8 from statictext within tabpage_c8
end type
type lb_c8 from listbox within tabpage_c8
end type
type tabpage_c8 from userobject within tab_c
st_chaise8 st_chaise8
st_heure8 st_heure8
st_date8 st_date8
lb_c8 lb_c8
end type
type tabpage_c9 from userobject within tab_c
end type
type st_chaise9 from statictext within tabpage_c9
end type
type st_heure9 from statictext within tabpage_c9
end type
type st_date9 from statictext within tabpage_c9
end type
type lb_c9 from listbox within tabpage_c9
end type
type tabpage_c9 from userobject within tab_c
st_chaise9 st_chaise9
st_heure9 st_heure9
st_date9 st_date9
lb_c9 lb_c9
end type
type tabpage_c10 from userobject within tab_c
end type
type st_chaise10 from statictext within tabpage_c10
end type
type st_heure10 from statictext within tabpage_c10
end type
type st_date10 from statictext within tabpage_c10
end type
type lb_c10 from listbox within tabpage_c10
end type
type tabpage_c10 from userobject within tab_c
st_chaise10 st_chaise10
st_heure10 st_heure10
st_date10 st_date10
lb_c10 lb_c10
end type
type tab_c from tab within w_horaire_find
tabpage_all tabpage_all
tabpage_c1 tabpage_c1
tabpage_c2 tabpage_c2
tabpage_c3 tabpage_c3
tabpage_c4 tabpage_c4
tabpage_c5 tabpage_c5
tabpage_c6 tabpage_c6
tabpage_c7 tabpage_c7
tabpage_c8 tabpage_c8
tabpage_c9 tabpage_c9
tabpage_c10 tabpage_c10
end type
type dw_traitements from u_dw within w_horaire_find
end type
end forward

global type w_horaire_find from w_child
integer width = 3648
integer height = 2044
boolean titlebar = false
boolean controlmenu = false
boolean minbox = false
boolean maxbox = false
boolean resizable = false
boolean border = false
windowstate windowstate = maximized!
long backcolor = 67108864
string icon = "C:\ii4net\orthotek\images\orthotek.ico"
string pointer = "Arrow!"
boolean ib_isupdateable = false
em_timestart1 em_timestart1
em_timeend1 em_timeend1
st_et1 st_et1
uo_calutil2 uo_calutil2
uo_calutil1 uo_calutil1
cbx_c10 cbx_c10
cbx_c9 cbx_c9
cbx_c8 cbx_c8
cbx_c7 cbx_c7
cbx_c6 cbx_c6
st_4 st_4
em_sem em_sem
st_3 st_3
dw_horairefindlistpers dw_horairefindlistpers
cbx_pers cbx_pers
st_precision st_precision
em_precision em_precision
cb_d2 cb_d2
cb_d1 cb_d1
hpb_search hpb_search
st_a st_a
st_2 st_2
em_end em_end
em_begin em_begin
cb_1 cb_1
st_et st_et
st_entre st_entre
em_time_end em_time_end
em_time_start em_time_start
cbx_vendredi cbx_vendredi
cbx_jeudi cbx_jeudi
cbx_mercredi cbx_mercredi
cbx_mardi cbx_mardi
cbx_lundi cbx_lundi
cbx_c5 cbx_c5
cbx_c4 cbx_c4
cbx_c3 cbx_c3
cbx_c2 cbx_c2
cbx_c1 cbx_c1
cb_close cb_close
cb_go cb_go
ddlb_minutes ddlb_minutes
st_1 st_1
tab_c tab_c
dw_traitements dw_traitements
end type
global w_horaire_find w_horaire_find

forward prototypes
public function string daynamefr (date v_date)
public function integer time_include (time v_time)
public function integer daytimeinclude (datastore ds_horpers, date v_date, time v_time)
public subroutine rechnorm ()
public subroutine rechspecial ()
public function integer day_include (date v_date)
public subroutine uf_gotohor (string as_plage)
end prototypes

public function string daynamefr (date v_date);choose case DayName(v_date)
	case "Monday"
		return "lundi      "
	case "Tuesday"
		return "mardi     "
	case "Wednesday"
		return "mercredi"
	case "Thursday"
		return "jeudi      "
	case "Friday"
		return "vendredi "
	case "Saturday"
		return "samedi  "
	case "Sunday"
		return "dimanche"
	case else
		return "  err.  "
end choose
end function

public function integer time_include (time v_time);if v_time >= time(em_time_start.text) and v_time <= time(em_time_end.text) then
	return 1
else
	return 0 
end if

end function

public function integer daytimeinclude (datastore ds_horpers, date v_date, time v_time);time lt_startam,lt_endam,lt_startpm,lt_endpm
choose case DayName(v_date)
	case "Monday"
		lt_startam = ds_horpers.getitemtime(1,'t_personnelshor_lundistartam')
		lt_endam = ds_horpers.getitemtime(1,'t_personnelshor_lundiendam')
		lt_startpm = ds_horpers.getitemtime(1,'t_personnelshor_lundistartpm')
		lt_endpm = ds_horpers.getitemtime(1,'t_personnelshor_lundiendpm')
		if cbx_lundi.checked then 
			if v_time >= lt_startam and v_time <= lt_endam and v_time >= lt_startpm and v_time <=lt_endpm then
				return 1
			end if
		end if
	case "Tuesday"
		lt_startam = ds_horpers.getitemtime(1,'t_personnelshor_mardistartam')
		lt_endam = ds_horpers.getitemtime(1,'t_personnelshor_mardiendam')
		lt_startpm = ds_horpers.getitemtime(1,'t_personnelshor_mardistartpm')
		lt_endpm = ds_horpers.getitemtime(1,'t_personnelshor_mardiendpm')
		if cbx_lundi.checked then 
			if v_time >= lt_startam and v_time <= lt_endam and v_time >= lt_startpm and v_time <=lt_endpm then
				return 1
			end if
		end if
	case "Wednesday"
		lt_startam = ds_horpers.getitemtime(1,'t_personnelshor_mercredistartam')
		lt_endam = ds_horpers.getitemtime(1,'t_personnelshor_mercrediendam')
		lt_startpm = ds_horpers.getitemtime(1,'t_personnelshor_mercredistartpm')
		lt_endpm = ds_horpers.getitemtime(1,'t_personnelshor_mercrediendpm')
		if cbx_lundi.checked then 
			if v_time >= lt_startam and v_time <= lt_endam and v_time >= lt_startpm and v_time <=lt_endpm then
				return 1
			end if
		end if
	case "Thursday"
		lt_startam = ds_horpers.getitemtime(1,'t_personnelshor_jeudistartam')
		lt_endam = ds_horpers.getitemtime(1,'t_personnelshor_jeudiendam')
		lt_startpm = ds_horpers.getitemtime(1,'t_personnelshor_jeudistartpm')
		lt_endpm = ds_horpers.getitemtime(1,'t_personnelshor_jeudiendpm')
		if cbx_lundi.checked then 
			if v_time >= lt_startam and v_time <= lt_endam and v_time >= lt_startpm and v_time <=lt_endpm then
				return 1
			end if
		end if
	case "Friday"
		lt_startam = ds_horpers.getitemtime(1,'t_personnelshor_vendredistartam')
		lt_endam = ds_horpers.getitemtime(1,'t_personnelshor_vendrediendam')
		lt_startpm = ds_horpers.getitemtime(1,'t_personnelshor_vendredistartpm')
		lt_endpm = ds_horpers.getitemtime(1,'t_personnelshor_vendrediendpm')
		if cbx_lundi.checked then 
			if v_time >= lt_startam and v_time <= lt_endam and v_time >= lt_startpm and v_time <=lt_endpm then
				return 1
			end if
		end if
	case "Saturday"
//		if cbx_samedi.checked then return 1
	case "Sunday"
//		if cbx_dimanche.checked then return 1
	case else 
		return 0
end choose
end function

public subroutine rechnorm ();long i,i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,ll_found1,ll_found2
int v_hor_step, plage, nb_find1, nb_find2, nb_find3, nb_find4, nb_find5, nb_find6, nb_find7, nb_find8, nb_find9, nb_find10, li_nbrow, li_precis, li_tpl
string v_color
date ldt_begin,ldt_end
time lt_start,lt_end
tab_c.tabpage_c1.lb_c1.reset()
tab_c.tabpage_c2.lb_c2.reset()
tab_c.tabpage_c3.lb_c3.reset()
tab_c.tabpage_c4.lb_c4.reset()
tab_c.tabpage_c5.lb_c5.reset()
tab_c.tabpage_c6.lb_c6.reset()
tab_c.tabpage_c7.lb_c7.reset()
tab_c.tabpage_c8.lb_c8.reset()
tab_c.tabpage_c9.lb_c9.reset()
tab_c.tabpage_c10.lb_c10.reset()
tab_c.tabpage_all.lb_call.reset()
datastore ds_horaire
ds_horaire = create datastore
ds_horaire.dataobject = "d_horaire"
ds_horaire.SetTransObject(SQLCA)
ldt_begin = date(em_begin.text)
ldt_end = date(em_end.text)
lt_start = time(em_time_start.text)
lt_end = time(em_time_end.text)
ds_horaire.retrieve(ldt_begin,ldt_end,lt_start,lt_end,v_no_ortho)
li_nbrow = ds_horaire.RowCount()
hpb_search.SetRange(1, li_nbrow)
li_precis = integer(em_precision.text) - 1
select hor_step into :v_hor_step from t_options;
li_tpl = dw_traitements.getitemnumber(dw_traitements.getrow(),'type_traitement_id')
plage = (integer(ddlb_minutes.text) / v_hor_step) - 1
v_color = string(dw_traitements.getitemnumber(dw_traitements.getrow(),'t_color_color'))

nb_find1 = 0
nb_find2 = 0
nb_find3 = 0
nb_find4 = 0
nb_find5 = 0
nb_find6 = 0
nb_find7 = 0
nb_find8 = 0
nb_find9 = 0
nb_find10 = 0
i1 = 1
i2 = 1
i3 = 1
i4 = 1
i5 = 1
i6 = 1
i7 = 1
i8 = 1
i9 = 1
i10 = 1

for i = 1 to li_nbrow
	hpb_search.StepIt()
	if cbx_c1.checked = true then
		if nb_find1 <= li_precis then
			if li_tpl = 1 then
				ll_found1 = ds_horaire.Find("patient_nom_1 = ''",i1, ds_horaire.RowCount())
			else
				ll_found1 = ds_horaire.Find("patient_nom_1 = '' and string(colortemplate1) ='" + v_color + "'",i1, ds_horaire.RowCount())
			end if
			if day_include(ds_horaire.getitemdate(ll_found1,'datecal')) = 1 and time_include(ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
				ll_found2 = ds_horaire.Find("patient_nom_1 <> ''",ll_found1, ll_found1 + plage)
				if ll_found2 = 0 then
					i1 = ll_found1 + plage + 1
					if v_langue = 'an' then
						tab_c.tabpage_c1.lb_c1.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 1')
						tab_c.tabpage_all.lb_call.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 1')
					else
						tab_c.tabpage_c1.lb_c1.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 1')
						tab_c.tabpage_all.lb_call.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 1')
					end if
					nb_find1 += 1
				else
					i1 = ll_found2 + 1
				end if
			else
				i1++
			end if
		else
			return
		end if
	end if
	if cbx_c2.checked = true then 
		if nb_find2 <= li_precis then
			if li_tpl = 1 then
				ll_found1 = ds_horaire.Find("patient_nom_2 = ''",i2, ds_horaire.RowCount())
			else
				ll_found1 = ds_horaire.Find("patient_nom_2 = '' and string(colortemplate2) ='" + v_color + "'",i2, ds_horaire.RowCount())
			end if
			if day_include(ds_horaire.getitemdate(ll_found1,'datecal')) = 1 and time_include(ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
				ll_found2 = ds_horaire.Find("patient_nom_2 <> ''",ll_found1, ll_found1 + plage)
				if ll_found2 = 0 then
					i2 = ll_found1 + plage + 1
					if v_langue = 'an' then
						tab_c.tabpage_c2.lb_c2.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 2')
						tab_c.tabpage_all.lb_call.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 2')
					else
						tab_c.tabpage_c2.lb_c2.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 2')
						tab_c.tabpage_all.lb_call.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 2')
					end if
					nb_find2 += 1
				else
					i2 = ll_found2 + 1
				end if
			else
				i2++
			end if
		else
			return
		end if
	end if
	if cbx_c3.checked = true then 
		if nb_find3 <= li_precis then
			if li_tpl = 1 then
				ll_found1 = ds_horaire.Find("patient_nom_3 = ''",i3, ds_horaire.RowCount())
			else
				ll_found1 = ds_horaire.Find("patient_nom_3 = '' and string(colortemplate3) ='" + v_color + "'",i3, ds_horaire.RowCount())
			end if
			if day_include(ds_horaire.getitemdate(ll_found1,'datecal')) = 1 and time_include(ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
				ll_found2 = ds_horaire.Find("patient_nom_3 <> ''",ll_found1, ll_found1 + plage)
				if ll_found2 = 0 then
					i3 = ll_found1 + plage + 1
					if v_langue = 'an' then
						tab_c.tabpage_c3.lb_c3.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 3')
						tab_c.tabpage_all.lb_call.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 3')
					else
						tab_c.tabpage_c3.lb_c3.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 3')
						tab_c.tabpage_all.lb_call.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 3')
					end if
					nb_find3 += 1
				else
					i3 = ll_found2 + 1
				end if
			else
				i3++
			end if
		else
			return
		end if
	end if
	if cbx_c4.checked = true then 
		if nb_find4 <= li_precis then
			if li_tpl = 1 then
				ll_found1 = ds_horaire.Find("patient_nom_4 = ''",i4, ds_horaire.RowCount())
			else			
				ll_found1 = ds_horaire.Find("patient_nom_4 = '' and string(colortemplate4) ='" + v_color + "'",i4, ds_horaire.RowCount())
			end if
			if day_include(ds_horaire.getitemdate(ll_found1,'datecal')) = 1 and time_include(ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
				ll_found2 = ds_horaire.Find("patient_nom_4 <> ''",ll_found1, ll_found1 + plage)
				if ll_found2 = 0 then
					i4 = ll_found1 + plage + 1
					if v_langue = 'an' then
						tab_c.tabpage_c4.lb_c4.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 4')
						tab_c.tabpage_all.lb_call.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 4')
					else
						tab_c.tabpage_c4.lb_c4.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 4')
						tab_c.tabpage_all.lb_call.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 4')
					end if
					nb_find4 += 1
				else
					i4 = ll_found2 + 1
				end if
			else
				i4++
			end if
		else
			return
		end if
	end if
		if cbx_c5.checked = true then 
			if nb_find5 <= li_precis then
				if li_tpl = 1 then
					ll_found1 = ds_horaire.Find("patient_nom_5 = ''",i5, ds_horaire.RowCount())
				else			
					ll_found1 = ds_horaire.Find("patient_nom_5 = '' and string(colortemplate5) ='" + v_color + "'",i5, ds_horaire.RowCount())
				end if
				if day_include(ds_horaire.getitemdate(ll_found1,'datecal')) = 1 and time_include(ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
					ll_found2 = ds_horaire.Find("patient_nom_5 <> ''",ll_found1, ll_found1 + plage)
					if ll_found2 = 0 then
						i5 = ll_found1 + plage + 1
						if v_langue = 'an' then
							tab_c.tabpage_c5.lb_c5.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 5')
							tab_c.tabpage_all.lb_call.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 5')
						else
							tab_c.tabpage_c5.lb_c5.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 5')
							tab_c.tabpage_all.lb_call.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 5')
						end if
						nb_find5 += 1
					else
						i5 = ll_found2 + 1
					end if
				else
					i5++
				end if
			else
				return
			end if
		end if
		if cbx_c6.checked = true then 
			if nb_find6 <= li_precis then
				if li_tpl = 1 then
					ll_found1 = ds_horaire.Find("patient_nom_6 = ''",i6, ds_horaire.RowCount())
				else			
					ll_found1 = ds_horaire.Find("patient_nom_6 = '' and string(colortemplate6) ='" + v_color + "'",i6, ds_horaire.RowCount())
				end if
				if day_include(ds_horaire.getitemdate(ll_found1,'datecal')) = 1 and time_include(ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
					ll_found2 = ds_horaire.Find("patient_nom_6 <> ''",ll_found1, ll_found1 + plage)
					if ll_found2 = 0 then
						i6 = ll_found1 + plage + 1
						if v_langue = 'an' then
							tab_c.tabpage_c6.lb_c6.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 6')
							tab_c.tabpage_all.lb_call.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 6')
						else
							tab_c.tabpage_c6.lb_c6.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 6')
							tab_c.tabpage_all.lb_call.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 6')
						end if
						nb_find6 += 1
					else
						i6 = ll_found2 + 1
					end if
				else
					i6++
				end if
			else
				return
			end if
		end if
		if cbx_c7.checked = true then 
			if nb_find7 <= li_precis then
				if li_tpl = 1 then
					ll_found1 = ds_horaire.Find("patient_nom_7 = ''",i7, ds_horaire.RowCount())
				else			
					ll_found1 = ds_horaire.Find("patient_nom_7 = '' and string(colortemplate7) ='" + v_color + "'",i7, ds_horaire.RowCount())
				end if
				if day_include(ds_horaire.getitemdate(ll_found1,'datecal')) = 1 and time_include(ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
					ll_found2 = ds_horaire.Find("patient_nom_7 <> ''",ll_found1, ll_found1 + plage)
					if ll_found2 = 0 then
						i7 = ll_found1 + plage + 1
						if v_langue = 'an' then
							tab_c.tabpage_c7.lb_c7.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 7')
							tab_c.tabpage_all.lb_call.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 7')
						else
							tab_c.tabpage_c7.lb_c7.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 7')
							tab_c.tabpage_all.lb_call.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 7')
						end if
						nb_find7 += 1
					else
						i7 = ll_found2 + 1
					end if
				else
					i7++
				end if
			else
				return
			end if
		end if
		if cbx_c8.checked = true then 
			if nb_find8 <= li_precis then
				if li_tpl = 1 then
					ll_found1 = ds_horaire.Find("patient_nom_8 = ''",i8, ds_horaire.RowCount())
				else			
					ll_found1 = ds_horaire.Find("patient_nom_8 = '' and string(colortemplate8) ='" + v_color + "'",i8, ds_horaire.RowCount())
				end if
				if day_include(ds_horaire.getitemdate(ll_found1,'datecal')) = 1 and time_include(ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
					ll_found2 = ds_horaire.Find("patient_nom_8 <> ''",ll_found1, ll_found1 + plage)
					if ll_found2 = 0 then
						i8 = ll_found1 + plage + 1
						if v_langue = 'an' then
							tab_c.tabpage_c8.lb_c8.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 8')
							tab_c.tabpage_all.lb_call.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 8')
						else
							tab_c.tabpage_c8.lb_c8.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 8')
							tab_c.tabpage_all.lb_call.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 8')
						end if
						nb_find8 += 1
					else
						i8 = ll_found2 + 1
					end if
				else
					i8++
				end if
			else
				return
			end if
		end if
		if cbx_c9.checked = true then 
			if nb_find9 <= li_precis then
				if li_tpl = 1 then
					ll_found1 = ds_horaire.Find("patient_nom_9 = ''",i9, ds_horaire.RowCount())
				else			
					ll_found1 = ds_horaire.Find("patient_nom_9 = '' and string(colortemplate9) ='" + v_color + "'",i9, ds_horaire.RowCount())
				end if
				if day_include(ds_horaire.getitemdate(ll_found1,'datecal')) = 1 and time_include(ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
					ll_found2 = ds_horaire.Find("patient_nom_9 <> ''",ll_found1, ll_found1 + plage)
					if ll_found2 = 0 then
						i9 = ll_found1 + plage + 1
						if v_langue = 'an' then
							tab_c.tabpage_c9.lb_c9.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 9')
							tab_c.tabpage_all.lb_call.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 9')
						else
							tab_c.tabpage_c9.lb_c9.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 9')
							tab_c.tabpage_all.lb_call.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
							string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 9')
						end if
						nb_find9 += 1
					else
						i9 = ll_found2 + 1
					end if
				else
					i9++
				end if
			else
				return
			end if
		end if
	if cbx_c10.checked = true then 
		if nb_find10 <= li_precis then
			if li_tpl = 1 then
				ll_found1 = ds_horaire.Find("patient_nom_10 = ''",i10, ds_horaire.RowCount())
			else			
				ll_found1 = ds_horaire.Find("patient_nom_10 = '' and string(colortemplate10) ='" + v_color + "'",i10, ds_horaire.RowCount())
			end if
			if day_include(ds_horaire.getitemdate(ll_found1,'datecal')) = 1 and time_include(ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
				ll_found2 = ds_horaire.Find("patient_nom_10 <> ''",ll_found1, ll_found1 + plage)
				if ll_found2 = 0 then
					i10 = ll_found1 + plage + 1
					if v_langue = 'an' then
						tab_c.tabpage_c10.lb_c10.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 10')
						tab_c.tabpage_all.lb_call.additem(DayName(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , Chair 10')
					else
						tab_c.tabpage_c10.lb_c10.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 10')
						tab_c.tabpage_all.lb_call.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
						string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 10')
					end if
					nb_find10 += 1
				else
					i10 = ll_found2 + 1
				end if
			else
				i10++
			end if
		else
			return
		end if
	end if
	w_principal.SetMicroHelp('Quantité trouvé : ' + string(nb_find1 + nb_find2 + nb_find3 + nb_find4 + nb_find5 + nb_find6 + nb_find7 + nb_find8 + nb_find9 + nb_find10))
next
hpb_search.Position = 0
destroy ds_horaire
end subroutine

public subroutine rechspecial ();long i,i1,i2,i3,i4,i5,ll_found1,ll_found2,ll_idpers
int v_hor_step, plage, nb_find1, nb_find2, nb_find3, nb_find4, nb_find5, li_nbrow, li_precis, li_tpl
string v_color
date ldt_begin,ldt_end
time lt_start,lt_end
tab_c.tabpage_c1.lb_c1.reset()
tab_c.tabpage_c2.lb_c2.reset()
tab_c.tabpage_c3.lb_c3.reset()
tab_c.tabpage_c4.lb_c4.reset()
tab_c.tabpage_c5.lb_c5.reset()
//pershor
datastore ds_personnelshor
ds_personnelshor = create datastore
ds_personnelshor.dataobject = "d_personnelshor"
ds_personnelshor.SetTransObject(SQLCA)
ll_idpers = dw_horairefindlistpers.getitemnumber(dw_horairefindlistpers.getrow(),'id_personnel')
ds_personnelshor.retrieve(ll_idpers)
//
datastore ds_horaire
ds_horaire = create datastore
ds_horaire.dataobject = "d_horaire"
ds_horaire.SetTransObject(SQLCA)
ldt_begin = date(em_begin.text)
ldt_end = date(em_end.text)
lt_start = time(em_time_start.text)
lt_end = time(em_time_end.text)
ds_horaire.retrieve(ldt_begin,ldt_end,lt_start,lt_end,v_no_ortho)
li_nbrow = ds_horaire.RowCount()
hpb_search.SetRange(1, li_nbrow)
li_precis = integer(em_precision.text) - 1
select hor_step into :v_hor_step from t_options;
li_tpl = dw_traitements.getitemnumber(dw_traitements.getrow(),'type_traitement_id')
plage = (integer(ddlb_minutes.text) / v_hor_step) - 1
v_color = string(dw_traitements.getitemnumber(dw_traitements.getrow(),'t_color_color'))

nb_find1 = 0
nb_find2 = 0
nb_find3 = 0
nb_find4 = 0
nb_find5 = 0
i1 = 1
i2 = 1
i3 = 1
i4 = 1
i5 = 1

for i = 1 to li_nbrow
	hpb_search.StepIt()
	if cbx_c1.checked = true then
		if nb_find1 <= li_precis then
			if li_tpl = 1 then
				ll_found1 = ds_horaire.Find("patient_nom_1 = ''",i1, ds_horaire.RowCount())
			else
				ll_found1 = ds_horaire.Find("patient_nom_1 = '' and string(colortemplate1) ='" + v_color + "'",i1, ds_horaire.RowCount())
			end if
			if daytimeinclude(ds_personnelshor,ds_horaire.getitemdate(ll_found1,'datecal'),ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
				ll_found2 = ds_horaire.Find("patient_nom_1 <> ''",ll_found1, ll_found1 + plage)
				if ll_found2 = 0 then
					i1 = ll_found1 + plage + 1
					tab_c.tabpage_c1.lb_c1.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
					string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 1')
					nb_find1 += 1
				else
					i1 = ll_found2 + 1
				end if
			else
				i1++
			end if
		else
			return
		end if
	end if
	if cbx_c2.checked = true then 
		if nb_find2 <= li_precis then
			if li_tpl = 1 then
				ll_found1 = ds_horaire.Find("patient_nom_2 = ''",i2, ds_horaire.RowCount())
			else
				ll_found1 = ds_horaire.Find("patient_nom_2 = '' and string(colortemplate2) ='" + v_color + "'",i2, ds_horaire.RowCount())
			end if
			if daytimeinclude(ds_personnelshor,ds_horaire.getitemdate(ll_found1,'datecal'),ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
				ll_found2 = ds_horaire.Find("patient_nom_2 <> ''",ll_found1, ll_found1 + plage)
				if ll_found2 = 0 then
					i2 = ll_found1 + plage + 1
					tab_c.tabpage_c2.lb_c2.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
					string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 2')
					nb_find2 += 1
				else
					i2 = ll_found2 + 1
				end if
			else
				i2++
			end if
		else
			return
		end if
	end if
	if cbx_c3.checked = true then 
		if nb_find3 <= li_precis then
			if li_tpl = 1 then
				ll_found1 = ds_horaire.Find("patient_nom_3 = ''",i3, ds_horaire.RowCount())
			else
				ll_found1 = ds_horaire.Find("patient_nom_3 = '' and string(colortemplate3) ='" + v_color + "'",i3, ds_horaire.RowCount())
			end if
			if daytimeinclude(ds_personnelshor,ds_horaire.getitemdate(ll_found1,'datecal'),ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
				ll_found2 = ds_horaire.Find("patient_nom_3 <> ''",ll_found1, ll_found1 + plage)
				if ll_found2 = 0 then
					i3 = ll_found1 + plage + 1
					tab_c.tabpage_c3.lb_c3.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
					string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 3')
					nb_find3 += 1
				else
					i3 = ll_found2 + 1
				end if
			else
				i3++
			end if
		else
			return
		end if
	end if
	if cbx_c4.checked = true then 
		if nb_find4 <= li_precis then
			if li_tpl = 1 then
				ll_found1 = ds_horaire.Find("patient_nom_4 = ''",i4, ds_horaire.RowCount())
			else			
				ll_found1 = ds_horaire.Find("patient_nom_4 = '' and string(colortemplate4) ='" + v_color + "'",i4, ds_horaire.RowCount())
			end if
			if daytimeinclude(ds_personnelshor,ds_horaire.getitemdate(ll_found1,'datecal'),ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
				ll_found2 = ds_horaire.Find("patient_nom_4 <> ''",ll_found1, ll_found1 + plage)
				if ll_found2 = 0 then
					i4 = ll_found1 + plage + 1
					tab_c.tabpage_c4.lb_c4.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
					string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 4')
					nb_find4 += 1
				else
					i4 = ll_found2 + 1
				end if
			else
				i4++
			end if
		else
			return
		end if
	end if
	if cbx_c5.checked = true then 
		if nb_find5 <= li_precis then
			if li_tpl = 1 then
				ll_found1 = ds_horaire.Find("patient_nom_5 = ''",i5, ds_horaire.RowCount())
			else			
				ll_found1 = ds_horaire.Find("patient_nom_5 = '' and string(colortemplate5) ='" + v_color + "'",i5, ds_horaire.RowCount())
			end if
			if daytimeinclude(ds_personnelshor,ds_horaire.getitemdate(ll_found1,'datecal'),ds_horaire.getitemtime(ll_found1,'heure')) = 1 then
				ll_found2 = ds_horaire.Find("patient_nom_5 <> ''",ll_found1, ll_found1 + plage)
				if ll_found2 = 0 then
					i5 = ll_found1 + plage + 1
					tab_c.tabpage_c5.lb_c5.additem(daynamefr(ds_horaire.getitemdate(ll_found1,'datecal')) + ' , ' + &
					string(ds_horaire.getitemdate(ll_found1,'datecal'))+ ' , ' +string(ds_horaire.getitemtime(ll_found1,'heure')) + ' , chaise 5')
					nb_find5 += 1
				else
					i5 = ll_found2 + 1
				end if
			else
				i5++
			end if
		else
			return
		end if
	end if
	w_principal.SetMicroHelp('Quantité trouvé : ' + string(nb_find1 + nb_find2 + nb_find3 + nb_find4 + nb_find5))
next
hpb_search.Position = 0
destroy ds_horaire
destroy ds_personnelshor
end subroutine

public function integer day_include (date v_date);choose case DayName(v_date)
	case "Monday"
		if cbx_lundi.checked then 
			return 1 
		else 
			return 0
		end if
	case "Tuesday"
		if cbx_mardi.checked then 
			return 1 
		else 
			return 0
		end if
	case "Wednesday"
		if cbx_mercredi.checked then
			return 1 
		else 
			return 0
		end if
		if cbx_jeudi.checked then
			return 1 
		else 
			return 0
		end if
	case "Friday"
		if cbx_vendredi.checked then
			return 1 
		else 
			return 0
		end if
/*	case "Saturday"
		if cbx_samedi.checked then
			return 1 
		else 
			return 0
		end if
	case "Sunday"
		if cbx_dimanche.checked then
			return 1 
		else
			return 0
		end if*/
	case else 
		return 0
end choose
end function

public subroutine uf_gotohor (string as_plage);string v_date, v_heure
int v_row, v_pos1, v_pos2, v_hor_depart_pm, v_hor_aff_pm

v_pos1 = pos(as_plage,',')
v_date = trim(mid(as_plage,v_pos1 + 2,10))
v_pos2 = pos(as_plage,',',v_pos1 + 2)
v_heure = trim(mid(as_plage,v_pos2 + 2,9))

if isvalid(w_horaire) = false then
	opensheetwithparm(w_horaire,string(today()),w_principal,2,layered!)
	w_principal.SetMicroHelp('Grille horaire')
	w_horaire.title = "Horaire des rendez-vous"
end if

w_horaire.uo_1.uf_InitCal(date(v_date))
istr_cal.caldate = date(v_date)
select hor_depart_pm,hor_aff_pm into :v_hor_depart_pm,:v_hor_aff_pm from t_options;
//	messagebox(string(v_hor_depart_pm) + ':00:00',v_heure)
if time(v_heure) >= time(string(v_hor_depart_pm) + ':00:00') and v_hor_aff_pm = 1 then
	w_horaire.rb_am.checked = false
	w_horaire.rb_pm.checked = true
	w_horaire.affichage_creation()
//	v_row = w_horaire.dw_hor.find("string(heure) = string(" + v_heure + ")",1,w_horaire.dw_hor.RowCount())
	w_horaire.dw_hor.scrolltorow(v_row)
else
	w_horaire.rb_am.checked = true
	w_horaire.rb_pm.checked = false
	w_horaire.affichage_creation()
//	v_row = w_horaire.dw_hor.find("string(heure) = string(" + v_heure + ")",1,w_horaire.dw_hor.RowCount())
	w_horaire.dw_hor.scrolltorow(v_row)
end if
w_horaire.SetFocus()
end subroutine

on w_horaire_find.create
int iCurrent
call super::create
this.em_timestart1=create em_timestart1
this.em_timeend1=create em_timeend1
this.st_et1=create st_et1
this.uo_calutil2=create uo_calutil2
this.uo_calutil1=create uo_calutil1
this.cbx_c10=create cbx_c10
this.cbx_c9=create cbx_c9
this.cbx_c8=create cbx_c8
this.cbx_c7=create cbx_c7
this.cbx_c6=create cbx_c6
this.st_4=create st_4
this.em_sem=create em_sem
this.st_3=create st_3
this.dw_horairefindlistpers=create dw_horairefindlistpers
this.cbx_pers=create cbx_pers
this.st_precision=create st_precision
this.em_precision=create em_precision
this.cb_d2=create cb_d2
this.cb_d1=create cb_d1
this.hpb_search=create hpb_search
this.st_a=create st_a
this.st_2=create st_2
this.em_end=create em_end
this.em_begin=create em_begin
this.cb_1=create cb_1
this.st_et=create st_et
this.st_entre=create st_entre
this.em_time_end=create em_time_end
this.em_time_start=create em_time_start
this.cbx_vendredi=create cbx_vendredi
this.cbx_jeudi=create cbx_jeudi
this.cbx_mercredi=create cbx_mercredi
this.cbx_mardi=create cbx_mardi
this.cbx_lundi=create cbx_lundi
this.cbx_c5=create cbx_c5
this.cbx_c4=create cbx_c4
this.cbx_c3=create cbx_c3
this.cbx_c2=create cbx_c2
this.cbx_c1=create cbx_c1
this.cb_close=create cb_close
this.cb_go=create cb_go
this.ddlb_minutes=create ddlb_minutes
this.st_1=create st_1
this.tab_c=create tab_c
this.dw_traitements=create dw_traitements
iCurrent=UpperBound(this.Control)
this.Control[iCurrent+1]=this.em_timestart1
this.Control[iCurrent+2]=this.em_timeend1
this.Control[iCurrent+3]=this.st_et1
this.Control[iCurrent+4]=this.uo_calutil2
this.Control[iCurrent+5]=this.uo_calutil1
this.Control[iCurrent+6]=this.cbx_c10
this.Control[iCurrent+7]=this.cbx_c9
this.Control[iCurrent+8]=this.cbx_c8
this.Control[iCurrent+9]=this.cbx_c7
this.Control[iCurrent+10]=this.cbx_c6
this.Control[iCurrent+11]=this.st_4
this.Control[iCurrent+12]=this.em_sem
this.Control[iCurrent+13]=this.st_3
this.Control[iCurrent+14]=this.dw_horairefindlistpers
this.Control[iCurrent+15]=this.cbx_pers
this.Control[iCurrent+16]=this.st_precision
this.Control[iCurrent+17]=this.em_precision
this.Control[iCurrent+18]=this.cb_d2
this.Control[iCurrent+19]=this.cb_d1
this.Control[iCurrent+20]=this.hpb_search
this.Control[iCurrent+21]=this.st_a
this.Control[iCurrent+22]=this.st_2
this.Control[iCurrent+23]=this.em_end
this.Control[iCurrent+24]=this.em_begin
this.Control[iCurrent+25]=this.cb_1
this.Control[iCurrent+26]=this.st_et
this.Control[iCurrent+27]=this.st_entre
this.Control[iCurrent+28]=this.em_time_end
this.Control[iCurrent+29]=this.em_time_start
this.Control[iCurrent+30]=this.cbx_vendredi
this.Control[iCurrent+31]=this.cbx_jeudi
this.Control[iCurrent+32]=this.cbx_mercredi
this.Control[iCurrent+33]=this.cbx_mardi
this.Control[iCurrent+34]=this.cbx_lundi
this.Control[iCurrent+35]=this.cbx_c5
this.Control[iCurrent+36]=this.cbx_c4
this.Control[iCurrent+37]=this.cbx_c3
this.Control[iCurrent+38]=this.cbx_c2
this.Control[iCurrent+39]=this.cbx_c1
this.Control[iCurrent+40]=this.cb_close
this.Control[iCurrent+41]=this.cb_go
this.Control[iCurrent+42]=this.ddlb_minutes
this.Control[iCurrent+43]=this.st_1
this.Control[iCurrent+44]=this.tab_c
this.Control[iCurrent+45]=this.dw_traitements
end on

on w_horaire_find.destroy
call super::destroy
destroy(this.em_timestart1)
destroy(this.em_timeend1)
destroy(this.st_et1)
destroy(this.uo_calutil2)
destroy(this.uo_calutil1)
destroy(this.cbx_c10)
destroy(this.cbx_c9)
destroy(this.cbx_c8)
destroy(this.cbx_c7)
destroy(this.cbx_c6)
destroy(this.st_4)
destroy(this.em_sem)
destroy(this.st_3)
destroy(this.dw_horairefindlistpers)
destroy(this.cbx_pers)
destroy(this.st_precision)
destroy(this.em_precision)
destroy(this.cb_d2)
destroy(this.cb_d1)
destroy(this.hpb_search)
destroy(this.st_a)
destroy(this.st_2)
destroy(this.em_end)
destroy(this.em_begin)
destroy(this.cb_1)
destroy(this.st_et)
destroy(this.st_entre)
destroy(this.em_time_end)
destroy(this.em_time_start)
destroy(this.cbx_vendredi)
destroy(this.cbx_jeudi)
destroy(this.cbx_mercredi)
destroy(this.cbx_mardi)
destroy(this.cbx_lundi)
destroy(this.cbx_c5)
destroy(this.cbx_c4)
destroy(this.cbx_c3)
destroy(this.cbx_c2)
destroy(this.cbx_c1)
destroy(this.cb_close)
destroy(this.cb_go)
destroy(this.ddlb_minutes)
destroy(this.st_1)
destroy(this.tab_c)
destroy(this.dw_traitements)
end on

event open;call super::open;pro_resize luo_size
luo_size.uf_resizew(this,1,1)
end event

type em_timestart1 from editmask within w_horaire_find
integer x = 1408
integer y = 616
integer width = 256
integer height = 84
integer taborder = 100
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
string text = "00:00"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = timemask!
string mask = "hh:mm"
boolean autoskip = true
end type

event constructor;time lt_pm1
select defhorpm1 into :lt_pm1 from t_options;
em_timestart1.text = string(lt_pm1)
end event

type em_timeend1 from editmask within w_horaire_find
integer x = 1801
integer y = 616
integer width = 256
integer height = 84
integer taborder = 100
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
string text = "00:00"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = timemask!
string mask = "hh:mm"
boolean autoskip = true
end type

event constructor;time lt_pm2
select defhorpm2 into :lt_pm2 from t_options;
em_timeend1.text = string(lt_pm2)
end event

type st_et1 from statictext within w_horaire_find
integer x = 1678
integer y = 620
integer width = 119
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "et"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.Text = "and"
end if
end event

type uo_calutil2 from u_calutil within w_horaire_find
boolean visible = false
integer x = 1687
integer y = 216
integer taborder = 60
boolean border = true
end type

event ue_aff_horaire;call super::ue_aff_horaire;em_end.text = string(istr_calutil.caldate)
end event

on uo_calutil2.destroy
call u_calutil::destroy
end on

type uo_calutil1 from u_calutil within w_horaire_find
boolean visible = false
integer x = 1010
integer y = 216
integer taborder = 50
boolean border = true
end type

event ue_aff_horaire;call super::ue_aff_horaire;em_begin.text = string(istr_calutil.caldate)
end event

on uo_calutil1.destroy
call u_calutil::destroy
end on

type cbx_c10 from checkbox within w_horaire_find
integer x = 1248
integer y = 1444
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "chaise 10"
end type

type cbx_c9 from checkbox within w_horaire_find
integer x = 1248
integer y = 1376
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "chaise 9"
end type

type cbx_c8 from checkbox within w_horaire_find
integer x = 1248
integer y = 1312
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "chaise 8"
end type

type cbx_c7 from checkbox within w_horaire_find
integer x = 1248
integer y = 1248
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "chaise 7"
end type

type cbx_c6 from checkbox within w_horaire_find
integer x = 1248
integer y = 1184
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "chaise 6"
end type

type st_4 from statictext within w_horaire_find
integer x = 1797
integer y = 32
integer width = 297
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "semaines"
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Weeks"
end if
end event

type em_sem from editmask within w_horaire_find
integer x = 1563
integer y = 24
integer width = 215
integer height = 84
integer taborder = 10
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 16777215
alignment alignment = center!
boolean displayonly = true
borderstyle borderstyle = stylelowered!
string mask = "##"
boolean autoskip = true
boolean spin = true
double increment = 1
string minmax = "1~~26"
end type

event constructor;em_sem.text = '1'
end event

event modified;em_end.text = string(relativedate(date(em_begin.text),integer(em_sem.text)*7))
end event

event getfocus;em_end.text = string(relativedate(date(em_begin.text),integer(em_sem.text)*7))
end event

type st_3 from statictext within w_horaire_find
integer x = 1701
integer y = 400
integer width = 261
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "minutes"
boolean focusrectangle = false
end type

type dw_horairefindlistpers from u_dw within w_horaire_find
integer x = 1193
integer y = 1648
integer width = 901
integer height = 260
integer taborder = 130
string title = "horairefindlistpers"
string dataobject = "d_horairefindlistpers"
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event constructor;SetTransObject(SQLCA)
Retrieve()
SetRowFocusIndicator(Hand!)
end event

event clicked;if cbx_pers.checked then
	em_time_start.enabled = false
	em_time_end.enabled = false
else
	em_time_start.enabled = true
	em_time_end.enabled = true
end if
end event

event dberror;str_error  ErrorStr
//populate the error structure
ErrorStr.sqldbcode = sqldbcode
ErrorStr.sqlerrtext = sqlerrtext
ErrorStr.sqlsyntax = sqlsyntax
ErrorStr.buffer = buffer
ErrorStr.row = row

//open the error window
OpenWithParm ( w_error , ErrorStr )
//do not display the error message
RETURN 1
end event

type cbx_pers from checkbox within w_horaire_find
integer x = 1248
integer y = 1564
integer width = 594
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "Rechercher pour"
end type

event constructor;if v_langue = 'an' then
	this.text = "Search for"
end if
end event

type st_precision from statictext within w_horaire_find
integer x = 1463
integer y = 744
integer width = 320
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "Précision :"
alignment alignment = right!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.Text = "precision :"
end if
end event

type em_precision from editmask within w_horaire_find
integer x = 1801
integer y = 736
integer width = 256
integer height = 84
integer taborder = 100
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 16777215
string text = "05"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
string mask = "##"
boolean spin = true
double increment = 1
string minmax = "1~~99"
end type

type cb_d2 from commandbutton within w_horaire_find
integer x = 1687
integer y = 216
integer width = 407
integer height = 76
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
string text = "Date"
end type

event clicked;if uo_calutil2.visible then
	uo_calutil2.visible = false
else
	uo_calutil2.visible = true
end if
//em_end.text = string(relativedate(today(),7))
end event

event constructor;if v_langue = 'an' then
	this.text = 'Today'
end if
end event

type cb_d1 from commandbutton within w_horaire_find
integer x = 1202
integer y = 216
integer width = 407
integer height = 76
integer taborder = 50
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
string text = "Date"
end type

event clicked;if uo_calutil1.visible then
	uo_calutil1.visible = false
else
	uo_calutil1.visible = true
end if
//em_begin.text = string(today())
end event

event constructor;if v_langue = 'an' then
	this.text = 'Today'
end if
end event

type hpb_search from hprogressbar within w_horaire_find
integer x = 2103
integer y = 1844
integer width = 1513
integer height = 64
string pointer = "Arrow!"
unsignedinteger maxposition = 100
integer setstep = 1
boolean smoothscroll = true
end type

type st_a from statictext within w_horaire_find
integer x = 1627
integer y = 132
integer width = 55
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "à"
boolean focusrectangle = false
end type

type st_2 from statictext within w_horaire_find
integer x = 1198
integer y = 32
integer width = 366
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "Date active :"
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Active date :"
end if
end event

type em_end from editmask within w_horaire_find
integer x = 1687
integer y = 128
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 16777215
alignment alignment = center!
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = datemask!
string mask = "[date]"
end type

event constructor;em_end.text = string(relativedate(today(),integer(em_sem.text)*7))
end event

type em_begin from editmask within w_horaire_find
integer x = 1202
integer y = 128
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 16777215
alignment alignment = center!
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = datemask!
string mask = "[date]"
boolean autoskip = true
end type

event constructor;em_begin.text = message.stringparm
end event

type cb_1 from commandbutton within w_horaire_find
integer x = 507
integer y = 1920
integer width = 2409
integer height = 112
integer taborder = 110
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
boolean enabled = false
end type

type st_et from statictext within w_horaire_find
integer x = 1678
integer y = 520
integer width = 119
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "et"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	st_et.Text = "and"
end if
end event

type st_entre from statictext within w_horaire_find
integer x = 1198
integer y = 520
integer width = 201
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "Entre :"
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.Text = "bet. :"
end if
end event

type em_time_end from editmask within w_horaire_find
integer x = 1801
integer y = 512
integer width = 256
integer height = 84
integer taborder = 90
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
string text = "00:00"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = timemask!
string mask = "hh:mm"
boolean autoskip = true
end type

event constructor;time li_am2
select defhoram2 into :li_am2 from t_options;
em_time_end.text = string(li_am2)
end event

type em_time_start from editmask within w_horaire_find
integer x = 1408
integer y = 512
integer width = 256
integer height = 84
integer taborder = 70
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
string text = "00:00"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = timemask!
string mask = "hh:mm"
boolean autoskip = true
end type

event constructor;time lt_am1
select defhoram1 into :lt_am1 from t_options;
em_time_start.text = string(lt_am1)
end event

type cbx_vendredi from checkbox within w_horaire_find
integer x = 1655
integer y = 1116
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "vendredi"
end type

event constructor;if v_langue = 'an' then
	cbx_vendredi.Text = "friday"
end if
end event

type cbx_jeudi from checkbox within w_horaire_find
integer x = 1655
integer y = 1052
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "jeudi"
end type

event constructor;if v_langue = 'an' then
	cbx_jeudi.Text = "thursday"
end if
end event

type cbx_mercredi from checkbox within w_horaire_find
integer x = 1655
integer y = 984
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "mercredi"
end type

event constructor;if v_langue = 'an' then
	cbx_mercredi.Text = "wednesday"
end if
end event

type cbx_mardi from checkbox within w_horaire_find
integer x = 1655
integer y = 916
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "mardi"
end type

event constructor;if v_langue = 'an' then
	cbx_mardi.Text = "tuesday"
end if
end event

type cbx_lundi from checkbox within w_horaire_find
integer x = 1655
integer y = 848
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "lundi"
end type

event constructor;if v_langue = 'an' then
	cbx_lundi.Text = "monday"
end if
end event

type cbx_c5 from checkbox within w_horaire_find
integer x = 1248
integer y = 1116
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "chaise 5"
end type

event constructor;if v_langue = 'an' then
	cbx_c5.Text = "chair 5"
end if
end event

type cbx_c4 from checkbox within w_horaire_find
integer x = 1248
integer y = 1052
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "chaise 4"
end type

event constructor;if v_langue = 'an' then
	cbx_c4.Text = "chair 4"
end if
end event

type cbx_c3 from checkbox within w_horaire_find
integer x = 1248
integer y = 984
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "chaise 3"
end type

event constructor;if v_langue = 'an' then
	cbx_c3.Text = "chair 3"
end if
end event

type cbx_c2 from checkbox within w_horaire_find
integer x = 1248
integer y = 916
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "chaise 2"
end type

event constructor;if v_langue = 'an' then
	cbx_c2.Text = "chair 2"
end if
end event

type cbx_c1 from checkbox within w_horaire_find
integer x = 1248
integer y = 848
integer width = 402
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "chaise 1"
end type

event constructor;if v_langue = 'an' then
	cbx_c1.Text = "chair 1"
end if
end event

type cb_close from commandbutton within w_horaire_find
integer x = 2917
integer y = 1920
integer width = 731
integer height = 112
integer taborder = 60
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
string text = "Fermer"
end type

event clicked;close(parent)
end event

event constructor;if v_langue = 'an' then
	cb_close.Text = "Close"
end if
end event

type cb_go from commandbutton within w_horaire_find
integer y = 1920
integer width = 507
integer height = 112
integer taborder = 30
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
string text = "Rechercher"
end type

event constructor;if v_langue = 'an' then
	cb_go.Text = "Search"
end if
end event

event clicked;if cbx_pers.checked then
	rechspecial()
else
	rechnorm()
end if
end event

type ddlb_minutes from dropdownlistbox within w_horaire_find
integer x = 1362
integer y = 392
integer width = 325
integer height = 364
integer taborder = 20
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
string text = "none"
boolean sorted = false
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

event constructor;int v_hor_step,v_hor_step_end,i

select hor_step into :v_hor_step from t_options;
v_hor_step_end = (v_hor_step * 30)

CHOOSE CASE v_hor_step
CASE 5
	for i= v_hor_step to v_hor_step_end step 5
		ddlb_minutes.AddItem(string(i))
	next
CASE 10
	for i= v_hor_step to v_hor_step_end step 10
		ddlb_minutes.AddItem(string(i))
	next
CASE 15
	for i= v_hor_step to v_hor_step_end step 15
		ddlb_minutes.AddItem(string(i))
	next
CASE ELSE
	error_type(0)
END CHOOSE
ddlb_minutes.selectitem(1)


end event

type st_1 from statictext within w_horaire_find
integer x = 1198
integer y = 308
integer width = 827
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long textcolor = 33554432
long backcolor = 67108864
string text = "Les prochaines plages de :"
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	st_1.Text = "Next five blocs of"
end if
end event

type tab_c from tab within w_horaire_find
integer x = 2103
integer width = 1559
integer height = 1840
integer taborder = 120
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "Arrow!"
long backcolor = 67108864
boolean raggedright = true
boolean focusonbuttondown = true
boolean showpicture = false
boolean boldselectedtext = true
integer selectedtab = 1
tabpage_all tabpage_all
tabpage_c1 tabpage_c1
tabpage_c2 tabpage_c2
tabpage_c3 tabpage_c3
tabpage_c4 tabpage_c4
tabpage_c5 tabpage_c5
tabpage_c6 tabpage_c6
tabpage_c7 tabpage_c7
tabpage_c8 tabpage_c8
tabpage_c9 tabpage_c9
tabpage_c10 tabpage_c10
end type

on tab_c.create
this.tabpage_all=create tabpage_all
this.tabpage_c1=create tabpage_c1
this.tabpage_c2=create tabpage_c2
this.tabpage_c3=create tabpage_c3
this.tabpage_c4=create tabpage_c4
this.tabpage_c5=create tabpage_c5
this.tabpage_c6=create tabpage_c6
this.tabpage_c7=create tabpage_c7
this.tabpage_c8=create tabpage_c8
this.tabpage_c9=create tabpage_c9
this.tabpage_c10=create tabpage_c10
this.Control[]={this.tabpage_all,&
this.tabpage_c1,&
this.tabpage_c2,&
this.tabpage_c3,&
this.tabpage_c4,&
this.tabpage_c5,&
this.tabpage_c6,&
this.tabpage_c7,&
this.tabpage_c8,&
this.tabpage_c9,&
this.tabpage_c10}
end on

on tab_c.destroy
destroy(this.tabpage_all)
destroy(this.tabpage_c1)
destroy(this.tabpage_c2)
destroy(this.tabpage_c3)
destroy(this.tabpage_c4)
destroy(this.tabpage_c5)
destroy(this.tabpage_c6)
destroy(this.tabpage_c7)
destroy(this.tabpage_c8)
destroy(this.tabpage_c9)
destroy(this.tabpage_c10)
end on

type tabpage_all from userobject within tab_c
integer x = 18
integer y = 112
integer width = 1522
integer height = 1712
long backcolor = 67108864
string text = "Tous"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_chaiseall st_chaiseall
st_heureall st_heureall
st_dateall st_dateall
lb_call lb_call
end type

on tabpage_all.create
this.st_chaiseall=create st_chaiseall
this.st_heureall=create st_heureall
this.st_dateall=create st_dateall
this.lb_call=create lb_call
this.Control[]={this.st_chaiseall,&
this.st_heureall,&
this.st_dateall,&
this.lb_call}
end on

on tabpage_all.destroy
destroy(this.st_chaiseall)
destroy(this.st_heureall)
destroy(this.st_dateall)
destroy(this.lb_call)
end on

type st_chaiseall from statictext within tabpage_all
integer x = 946
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "chaise"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Chair"
end if
end event

type st_heureall from statictext within tabpage_all
integer x = 667
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "heure"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Hour"
end if
end event

type st_dateall from statictext within tabpage_all
integer x = 357
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "Date"
alignment alignment = center!
boolean focusrectangle = false
end type

type lb_call from listbox within tabpage_all
integer x = 96
integer y = 68
integer width = 1422
integer height = 1644
integer taborder = 50
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "HyperLink!"
long textcolor = 33554432
long backcolor = 80269524
boolean border = false
boolean vscrollbar = true
boolean sorted = false
end type

event doubleclicked;uf_gotohor(this.selecteditem())
end event

type tabpage_c1 from userobject within tab_c
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 1522
integer height = 1712
long backcolor = 67108864
string text = "1"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
lb_c1 lb_c1
st_date1 st_date1
st_chaise1 st_chaise1
st_heure1 st_heure1
end type

on tabpage_c1.create
this.lb_c1=create lb_c1
this.st_date1=create st_date1
this.st_chaise1=create st_chaise1
this.st_heure1=create st_heure1
this.Control[]={this.lb_c1,&
this.st_date1,&
this.st_chaise1,&
this.st_heure1}
end on

on tabpage_c1.destroy
destroy(this.lb_c1)
destroy(this.st_date1)
destroy(this.st_chaise1)
destroy(this.st_heure1)
end on

event constructor;if v_langue = 'an' then
	this.Text = "Chair 1"
end if
end event

type lb_c1 from listbox within tabpage_c1
integer x = 96
integer y = 68
integer width = 1422
integer height = 1644
integer taborder = 40
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "HyperLink!"
long textcolor = 33554432
long backcolor = 80269524
boolean border = false
boolean vscrollbar = true
boolean sorted = false
end type

event doubleclicked;uf_gotohor(this.selecteditem())
end event

type st_date1 from statictext within tabpage_c1
integer x = 357
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "Date"
alignment alignment = center!
boolean focusrectangle = false
end type

type st_chaise1 from statictext within tabpage_c1
integer x = 946
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "chaise"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Chair"
end if
end event

type st_heure1 from statictext within tabpage_c1
integer x = 667
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "heure"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Hour"
end if
end event

type tabpage_c2 from userobject within tab_c
integer x = 18
integer y = 112
integer width = 1522
integer height = 1712
long backcolor = 67108864
string text = "2"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_chaise2 st_chaise2
st_heure2 st_heure2
st_date2 st_date2
lb_c2 lb_c2
end type

on tabpage_c2.create
this.st_chaise2=create st_chaise2
this.st_heure2=create st_heure2
this.st_date2=create st_date2
this.lb_c2=create lb_c2
this.Control[]={this.st_chaise2,&
this.st_heure2,&
this.st_date2,&
this.lb_c2}
end on

on tabpage_c2.destroy
destroy(this.st_chaise2)
destroy(this.st_heure2)
destroy(this.st_date2)
destroy(this.lb_c2)
end on

event constructor;if v_langue = 'an' then
	this.Text = "Chair 2"
end if
end event

type st_chaise2 from statictext within tabpage_c2
integer x = 946
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "chaise"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Chair"
end if
end event

type st_heure2 from statictext within tabpage_c2
integer x = 667
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "heure"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Hour"
end if
end event

type st_date2 from statictext within tabpage_c2
integer x = 357
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "Date"
alignment alignment = center!
boolean focusrectangle = false
end type

type lb_c2 from listbox within tabpage_c2
integer x = 96
integer y = 68
integer width = 1422
integer height = 1644
integer taborder = 60
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "HyperLink!"
long textcolor = 33554432
long backcolor = 80269524
boolean border = false
boolean vscrollbar = true
boolean sorted = false
end type

event doubleclicked;uf_gotohor(this.selecteditem())
end event

type tabpage_c3 from userobject within tab_c
integer x = 18
integer y = 112
integer width = 1522
integer height = 1712
long backcolor = 67108864
string text = "3"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_chaise3 st_chaise3
st_heure3 st_heure3
st_date3 st_date3
lb_c3 lb_c3
end type

on tabpage_c3.create
this.st_chaise3=create st_chaise3
this.st_heure3=create st_heure3
this.st_date3=create st_date3
this.lb_c3=create lb_c3
this.Control[]={this.st_chaise3,&
this.st_heure3,&
this.st_date3,&
this.lb_c3}
end on

on tabpage_c3.destroy
destroy(this.st_chaise3)
destroy(this.st_heure3)
destroy(this.st_date3)
destroy(this.lb_c3)
end on

event constructor;if v_langue = 'an' then
	this.Text = "Chair 3"
end if
end event

type st_chaise3 from statictext within tabpage_c3
integer x = 946
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "chaise"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Chair"
end if
end event

type st_heure3 from statictext within tabpage_c3
integer x = 667
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "heure"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Hour"
end if
end event

type st_date3 from statictext within tabpage_c3
integer x = 357
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "Date"
alignment alignment = center!
boolean focusrectangle = false
end type

type lb_c3 from listbox within tabpage_c3
integer x = 96
integer y = 68
integer width = 1422
integer height = 1644
integer taborder = 60
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "HyperLink!"
long textcolor = 33554432
long backcolor = 80269524
boolean border = false
boolean vscrollbar = true
boolean sorted = false
end type

event doubleclicked;uf_gotohor(this.selecteditem())
end event

type tabpage_c4 from userobject within tab_c
integer x = 18
integer y = 112
integer width = 1522
integer height = 1712
long backcolor = 67108864
string text = "4"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_chaise4 st_chaise4
st_heure4 st_heure4
st_date4 st_date4
lb_c4 lb_c4
end type

on tabpage_c4.create
this.st_chaise4=create st_chaise4
this.st_heure4=create st_heure4
this.st_date4=create st_date4
this.lb_c4=create lb_c4
this.Control[]={this.st_chaise4,&
this.st_heure4,&
this.st_date4,&
this.lb_c4}
end on

on tabpage_c4.destroy
destroy(this.st_chaise4)
destroy(this.st_heure4)
destroy(this.st_date4)
destroy(this.lb_c4)
end on

event constructor;if v_langue = 'an' then
	this.Text = "Chair 4"
end if
end event

type st_chaise4 from statictext within tabpage_c4
integer x = 946
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "chaise"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Chair"
end if
end event

type st_heure4 from statictext within tabpage_c4
integer x = 667
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "heure"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Hour"
end if
end event

type st_date4 from statictext within tabpage_c4
integer x = 357
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "Date"
alignment alignment = center!
boolean focusrectangle = false
end type

type lb_c4 from listbox within tabpage_c4
integer x = 96
integer y = 68
integer width = 1422
integer height = 1644
integer taborder = 60
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "HyperLink!"
long textcolor = 33554432
long backcolor = 80269524
boolean border = false
boolean vscrollbar = true
boolean sorted = false
end type

event doubleclicked;uf_gotohor(this.selecteditem())
end event

type tabpage_c5 from userobject within tab_c
integer x = 18
integer y = 112
integer width = 1522
integer height = 1712
long backcolor = 67108864
string text = "5"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_chaise5 st_chaise5
st_heure5 st_heure5
st_date5 st_date5
lb_c5 lb_c5
end type

on tabpage_c5.create
this.st_chaise5=create st_chaise5
this.st_heure5=create st_heure5
this.st_date5=create st_date5
this.lb_c5=create lb_c5
this.Control[]={this.st_chaise5,&
this.st_heure5,&
this.st_date5,&
this.lb_c5}
end on

on tabpage_c5.destroy
destroy(this.st_chaise5)
destroy(this.st_heure5)
destroy(this.st_date5)
destroy(this.lb_c5)
end on

event constructor;if v_langue = 'an' then
	this.Text = "Chair 5"
end if
end event

type st_chaise5 from statictext within tabpage_c5
integer x = 946
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "chaise"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Chair"
end if
end event

type st_heure5 from statictext within tabpage_c5
integer x = 667
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "heure"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Hour"
end if
end event

type st_date5 from statictext within tabpage_c5
integer x = 357
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "Date"
alignment alignment = center!
boolean focusrectangle = false
end type

type lb_c5 from listbox within tabpage_c5
integer x = 96
integer y = 68
integer width = 1422
integer height = 1644
integer taborder = 60
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "HyperLink!"
long textcolor = 33554432
long backcolor = 80269524
boolean border = false
boolean vscrollbar = true
boolean sorted = false
end type

event doubleclicked;uf_gotohor(this.selecteditem())
end event

type tabpage_c6 from userobject within tab_c
integer x = 18
integer y = 112
integer width = 1522
integer height = 1712
long backcolor = 67108864
string text = "6"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_chaise6 st_chaise6
st_heure6 st_heure6
st_date6 st_date6
lb_c6 lb_c6
end type

on tabpage_c6.create
this.st_chaise6=create st_chaise6
this.st_heure6=create st_heure6
this.st_date6=create st_date6
this.lb_c6=create lb_c6
this.Control[]={this.st_chaise6,&
this.st_heure6,&
this.st_date6,&
this.lb_c6}
end on

on tabpage_c6.destroy
destroy(this.st_chaise6)
destroy(this.st_heure6)
destroy(this.st_date6)
destroy(this.lb_c6)
end on

type st_chaise6 from statictext within tabpage_c6
integer x = 946
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "chaise"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Chair"
end if
end event

type st_heure6 from statictext within tabpage_c6
integer x = 667
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "heure"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Hour"
end if
end event

type st_date6 from statictext within tabpage_c6
integer x = 357
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "Date"
alignment alignment = center!
boolean focusrectangle = false
end type

type lb_c6 from listbox within tabpage_c6
integer x = 96
integer y = 68
integer width = 1422
integer height = 1644
integer taborder = 70
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "HyperLink!"
long textcolor = 33554432
long backcolor = 80269524
boolean border = false
boolean vscrollbar = true
boolean sorted = false
end type

event doubleclicked;uf_gotohor(this.selecteditem())
end event

type tabpage_c7 from userobject within tab_c
integer x = 18
integer y = 112
integer width = 1522
integer height = 1712
long backcolor = 67108864
string text = "7"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_chaise7 st_chaise7
st_heure7 st_heure7
st_date7 st_date7
lb_c7 lb_c7
end type

on tabpage_c7.create
this.st_chaise7=create st_chaise7
this.st_heure7=create st_heure7
this.st_date7=create st_date7
this.lb_c7=create lb_c7
this.Control[]={this.st_chaise7,&
this.st_heure7,&
this.st_date7,&
this.lb_c7}
end on

on tabpage_c7.destroy
destroy(this.st_chaise7)
destroy(this.st_heure7)
destroy(this.st_date7)
destroy(this.lb_c7)
end on

type st_chaise7 from statictext within tabpage_c7
integer x = 946
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "chaise"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Chair"
end if
end event

type st_heure7 from statictext within tabpage_c7
integer x = 667
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "heure"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Hour"
end if
end event

type st_date7 from statictext within tabpage_c7
integer x = 357
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "Date"
alignment alignment = center!
boolean focusrectangle = false
end type

type lb_c7 from listbox within tabpage_c7
integer x = 96
integer y = 68
integer width = 1422
integer height = 1644
integer taborder = 50
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "HyperLink!"
long textcolor = 33554432
long backcolor = 80269524
boolean border = false
boolean vscrollbar = true
boolean sorted = false
end type

event doubleclicked;uf_gotohor(this.selecteditem())
end event

type tabpage_c8 from userobject within tab_c
integer x = 18
integer y = 112
integer width = 1522
integer height = 1712
long backcolor = 67108864
string text = "8"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_chaise8 st_chaise8
st_heure8 st_heure8
st_date8 st_date8
lb_c8 lb_c8
end type

on tabpage_c8.create
this.st_chaise8=create st_chaise8
this.st_heure8=create st_heure8
this.st_date8=create st_date8
this.lb_c8=create lb_c8
this.Control[]={this.st_chaise8,&
this.st_heure8,&
this.st_date8,&
this.lb_c8}
end on

on tabpage_c8.destroy
destroy(this.st_chaise8)
destroy(this.st_heure8)
destroy(this.st_date8)
destroy(this.lb_c8)
end on

type st_chaise8 from statictext within tabpage_c8
integer x = 946
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "chaise"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Chair"
end if
end event

type st_heure8 from statictext within tabpage_c8
integer x = 667
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "heure"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Hour"
end if
end event

type st_date8 from statictext within tabpage_c8
integer x = 357
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "Date"
alignment alignment = center!
boolean focusrectangle = false
end type

type lb_c8 from listbox within tabpage_c8
integer x = 96
integer y = 68
integer width = 1422
integer height = 1644
integer taborder = 50
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "HyperLink!"
long textcolor = 33554432
long backcolor = 80269524
boolean border = false
boolean vscrollbar = true
boolean sorted = false
end type

event doubleclicked;uf_gotohor(this.selecteditem())
end event

type tabpage_c9 from userobject within tab_c
integer x = 18
integer y = 112
integer width = 1522
integer height = 1712
long backcolor = 67108864
string text = "9"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_chaise9 st_chaise9
st_heure9 st_heure9
st_date9 st_date9
lb_c9 lb_c9
end type

on tabpage_c9.create
this.st_chaise9=create st_chaise9
this.st_heure9=create st_heure9
this.st_date9=create st_date9
this.lb_c9=create lb_c9
this.Control[]={this.st_chaise9,&
this.st_heure9,&
this.st_date9,&
this.lb_c9}
end on

on tabpage_c9.destroy
destroy(this.st_chaise9)
destroy(this.st_heure9)
destroy(this.st_date9)
destroy(this.lb_c9)
end on

type st_chaise9 from statictext within tabpage_c9
integer x = 946
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "chaise"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Chair"
end if
end event

type st_heure9 from statictext within tabpage_c9
integer x = 667
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "heure"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Hour"
end if
end event

type st_date9 from statictext within tabpage_c9
integer x = 357
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "Date"
alignment alignment = center!
boolean focusrectangle = false
end type

type lb_c9 from listbox within tabpage_c9
integer x = 96
integer y = 68
integer width = 1422
integer height = 1644
integer taborder = 50
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "HyperLink!"
long textcolor = 33554432
long backcolor = 80269524
boolean border = false
boolean vscrollbar = true
boolean sorted = false
end type

event doubleclicked;uf_gotohor(this.selecteditem())
end event

type tabpage_c10 from userobject within tab_c
integer x = 18
integer y = 112
integer width = 1522
integer height = 1712
long backcolor = 67108864
string text = "10"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_chaise10 st_chaise10
st_heure10 st_heure10
st_date10 st_date10
lb_c10 lb_c10
end type

on tabpage_c10.create
this.st_chaise10=create st_chaise10
this.st_heure10=create st_heure10
this.st_date10=create st_date10
this.lb_c10=create lb_c10
this.Control[]={this.st_chaise10,&
this.st_heure10,&
this.st_date10,&
this.lb_c10}
end on

on tabpage_c10.destroy
destroy(this.st_chaise10)
destroy(this.st_heure10)
destroy(this.st_date10)
destroy(this.lb_c10)
end on

type st_chaise10 from statictext within tabpage_c10
integer x = 946
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "chaise"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Chair"
end if
end event

type st_heure10 from statictext within tabpage_c10
integer x = 667
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "heure"
alignment alignment = center!
boolean focusrectangle = false
end type

event constructor;if v_langue = 'an' then
	this.text = "Hour"
end if
end event

type st_date10 from statictext within tabpage_c10
integer x = 357
integer width = 402
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 8388608
long backcolor = 67108864
string text = "Date"
alignment alignment = center!
boolean focusrectangle = false
end type

type lb_c10 from listbox within tabpage_c10
integer x = 96
integer y = 68
integer width = 1422
integer height = 1644
integer taborder = 50
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string pointer = "HyperLink!"
long textcolor = 33554432
long backcolor = 80269524
boolean border = false
boolean vscrollbar = true
boolean sorted = false
end type

event doubleclicked;uf_gotohor(this.selecteditem())
end event

type dw_traitements from u_dw within w_horaire_find
integer x = 14
integer y = 12
integer width = 1175
integer height = 1896
integer taborder = 80
string title = "types_traitements_hor"
string dataobject = "d_types_traitements_hor_rech"
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event constructor;this.SetTransObject(sqlca)
this.SetRowFocusIndicator(Hand!)
this.retrieve(v_no_ortho)
end event

event dberror;str_error  ErrorStr
//populate the error structure
ErrorStr.sqldbcode = sqldbcode
ErrorStr.sqlerrtext = sqlerrtext
ErrorStr.sqlsyntax = sqlsyntax
ErrorStr.buffer = buffer
ErrorStr.row = row

//open the error window
OpenWithParm ( w_error , ErrorStr )
//do not display the error message
RETURN 1
end event

