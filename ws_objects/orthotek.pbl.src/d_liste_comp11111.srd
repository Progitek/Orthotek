$PBExportHeader$d_liste_comp11111.srd
release 9;
datawindow(units=0 timer_interval=0 color=67108864 processing=0 HTMLDW=no print.printername="" print.documentname="" print.orientation = 0 print.margin.left = 110 print.margin.right = 110 print.margin.top = 96 print.margin.bottom = 96 print.paper.source = 0 print.paper.size = 0 print.canusedefaultprinter=yes print.prompt=no print.buttons=no print.preview.buttons=no print.cliptext=no print.overrideprintjob=no print.collate=yes hidegrayline=no )
header(height=544 color="536870912" )
summary(height=92 color="536870912" )
footer(height=56 color="536870912" )
detail(height=72 color="536870912" )
table(column=(type=long updatewhereclause=yes identity=yes name=patient_patient_id dbname="patient.patient_id" )
 column=(type=char(50) updatewhereclause=yes name=patient_patient_nom dbname="patient.patient_nom" )
 column=(type=char(50) updatewhereclause=yes name=patient_patient_prenom dbname="patient.patient_prenom" )
 column=(type=long updatewhereclause=yes name=patient_no_ortho dbname="patient.no_ortho" )
 column=(type=char(30) updatewhereclause=yes name=ortho_id_dr_nom_complet dbname="ortho_id.dr_nom_complet" )
 column=(type=long updatewhereclause=yes identity=yes name=traitements_traitement_id dbname="traitements.traitement_id" )
 column=(type=decimal(2) updatewhereclause=yes name=traitements_montant_original dbname="traitements.montant_original" )
 column=(type=decimal(2) updatewhereclause=yes name=montantpaye dbname="montantpaye" )
 column=(type=long update=yes updatewhereclause=yes identity=yes name=id_rdv dbname="t_rdv.id_rdv" )
 column=(type=date updatewhereclause=yes name=t_rdv_rdvdate dbname="t_rdv.rdvdate" )
 column=(type=decimal(2) updatewhereclause=yes name=t_rdv_duree dbname="t_rdv.duree" )
 column=(type=char(1) updatewhereclause=yes name=t_rdv_rdvetat dbname="t_rdv.rdvetat" )
 column=(type=long updatewhereclause=yes name=t_rdv_typetraitid dbname="t_rdv.typetraitid" )
 column=(type=long updatewhereclause=yes name=horstep dbname="horstep" )
 column=(type=decimal(2) updatewhereclause=yes name=taux dbname="taux" )
 column=(type=number updatewhereclause=yes name=addtocharge dbname="addtocharge" )
 column=(type=date updatewhereclause=yes name=prchcpd dbname="prchcpd" )
 column=(type=long updatewhereclause=yes name=nbcheques dbname="nbcheques" )
 column=(type=decimal(2) updatewhereclause=yes name=totcheques dbname="totcheques" )
 retrieve="  SELECT patient.patient_id,
			patient.patient_nom,
			patient.patient_prenom,
			patient.no_ortho,
			ortho_id.dr_nom_complet,
			traitements.traitement_id,  
         traitements.montant_original,   
			(select sum(montant_recu) from paiement where traitement_patient_id = traitements.traitement_id) as montantpaye,
			t_rdv.id_rdv,
			t_rdv.rdvdate,
         t_rdv.duree,
			t_rdv.rdvetat,
			t_rdv.typetraitid,
			(select hor_step from t_options where ortho_id = patient.no_ortho) as horstep,
			(select max(chargtaux) from t_charges where ortho_id = patient.no_ortho and chargdate <= t_rdv.rdvdate) as taux,
			(select addtocharge from type_de_traitement where ortho_id = patient.no_ortho and type_traitement_id = t_rdv.typetraitid) as addtocharge,
			(select min(date_cheque) from cheques_postdates where traitement_patient_id = traitements.traitement_id and date_cheque > today()) as prchcpd,
			(select count(*) from cheques_postdates where traitement_patient_id = traitements.traitement_id and date_cheque > today()) as nbcheques,
			(select sum(paiement) from cheques_postdates where traitement_patient_id = traitements.traitement_id and date_cheque > today()) as totcheques
    FROM patient INNER JOIN t_rdv ON patient.patient_id = t_rdv.patient_id
					  LEFT OUTER JOIN traitements ON patient.patient_id = traitements.patient_id
					  INNER JOIN ortho_id ON patient.no_ortho = ortho_id.ortho_id
   WHERE (t_rdv.rdvetat <> 'm' OR t_rdv.rdvetat is null) AND
			addtocharge = 1 AND
			patient.no_ortho = :ra_ortho AND
			t_rdv.rdvdate BETWEEN :ra_debut AND :ra_fin
ORDER BY patient.patient_nom ASC,
			patient.patient_prenom ASC

" arguments=(("ra_ortho", number),("ra_debut", date),("ra_fin", date)) )
text(band=header alignment="0" text="Liste comparative" border="0" color="8388608" x="23" y="12" height="92" width="2551" html.valueishtml="0"  name=t_titre visible="1"  font.face="Arial" font.height="-14" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Montant
CPD" border="0" color="33554432" x="3063" y="400" height="128" width="315" html.valueishtml="0"  name=totcheques_t visible="1"  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
line(band=header x1="5" y1="536" x2="3383" y2="536"  name=l_2 visible="1" pen.style="0" pen.width="5" pen.color="0"  background.mode="2" background.color="16777215" )
column(band=header id=5 alignment="0" tabsequence=32766 border="0" color="8388608" x="224" y="184" height="80" width="2350" format="[general]" html.valueishtml="0"  name=ortho_id_dr_nom_complet visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=no edit.imemode=0  font.face="Arial" font.height="-12" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="0" text="Du" border="0" color="8388608" x="23" y="108" height="72" width="123" html.valueishtml="0"  name=t_du visible="1"  font.face="Arial" font.height="-12" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="0" text="Pour" border="0" color="8388608" x="23" y="184" height="80" width="197" html.valueishtml="0"  name=t_pour visible="1"  font.face="Arial" font.height="-12" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="au" border="0" color="8388608" x="539" y="108" height="72" width="128" html.valueishtml="0"  name=t_au visible="1"  font.face="Arial" font.height="-12" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=header alignment="0" expression=" ra_debut "border="0" color="8388608" x="151" y="108" height="72" width="384" format="[SHORTDATE]" html.valueishtml="0"  name=cp_debut visible="1"  font.face="Arial" font.height="-12" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=header alignment="0" expression=" ra_fin "border="0" color="8388608" x="672" y="108" height="72" width="384" format="[SHORTDATE]" html.valueishtml="0"  name=cp_fin visible="1"  font.face="Arial" font.height="-12" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
line(band=summary x1="814" y1="0" x2="3383" y2="0"  name=l_1 visible="1" pen.style="0" pen.width="5" pen.color="0"  background.mode="2" background.color="16777215" )
text(band=summary alignment="1" text="Total:" border="0" color="33554432" x="631" y="16" height="64" width="165" html.valueishtml="0"  name=t_total visible="1"  font.face="Arial" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Montant
payé" border="0" color="33554432" x="1152" y="400" height="128" width="334" html.valueishtml="0"  name=montant_paye_t visible="1"  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Prochain
CPD" border="0" color="33554432" x="2482" y="400" height="128" width="315" html.valueishtml="0"  name=prchcpd_t visible="1"  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Chèques
restants" border="0" color="33554432" x="2798" y="400" height="128" width="265" html.valueishtml="0"  name=nbcheques_t visible="1"  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=summary alignment="1" expression="sum(  traitements_montant_original  for all )"border="0" color="33554432" x="818" y="16" height="64" width="334" format="#,##0.00 $; (#,##0.00 $)" html.valueishtml="0"  name=cp_tot_cout_traitement visible="1"  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=summary alignment="1" expression="sum(  montantpaye  for all )"border="0" color="33554432" x="1152" y="16" height="64" width="334" format="#,##0.00 $; (#,##0.00 $)" html.valueishtml="0"  name=cp_tot_montantpaye visible="1"  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=summary alignment="1" expression="sum(  cp_charge  for all )"border="0" color="33554432" x="1486" y="16" height="64" width="334" format="#,##0.00 $; (#,##0.00 $)" html.valueishtml="0"  name=cp_tot_charge visible="1"  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=summary alignment="1" expression="sum(  cp_ecart  for all )"border="0" color="33554432" x="1819" y="16" height="64" width="334" format="#,##0.00 $; (#,##0.00 $)" html.valueishtml="0"  name=cp_tot_ecart visible="1"  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=summary alignment="1" expression="sum(  cp_solde  for all )"border="0" color="33554432" x="2153" y="16" height="64" width="329" format="#,##0.00 $; (#,##0.00 $)" html.valueishtml="0"  name=cp_tot_solde visible="1"  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=summary alignment="1" expression="sum(  nbcheques  for all )"border="0" color="33554432" x="2798" y="16" height="64" width="265" format="[General]" html.valueishtml="0"  name=cp_tot_nbcheques visible="1"  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
compute(band=summary alignment="1" expression="sum(  totcheques  for all )"border="0" color="33554432" x="3063" y="16" height="64" width="315" format="#,##0.00 $; (#,##0.00 $)" html.valueishtml="0"  name=cp_tot_totcheques visible="1"  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=footer alignment="0" expression="today()"border="0" color="0" x="251" y="0" height="56" width="334" format="[general]" html.valueishtml="0"  name=date_1 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=footer alignment="0" text="Imprimé le " border="0" color="0" x="14" y="0" height="56" width="229" html.valueishtml="0"  name=t_printedon visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
text(band=footer alignment="0" text="© Orthotek" border="0" color="0" x="1463" y="0" height="56" width="238" html.valueishtml="0"  name=t_1 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
compute(band=footer alignment="1" expression="'Page ' + page() + ' / ' + pageCount()"border="0" color="0" x="2606" y="0" height="56" width="773" format="[general]" html.valueishtml="0"  name=compute_1 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Coût
traitement" border="0" color="33554432" x="818" y="400" height="128" width="334" html.valueishtml="0"  name=cout_traitement_t visible="1"  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="0" text="Patient" border="0" color="33554432" x="18" y="400" height="128" width="800" html.valueishtml="0"  name=patient_t visible="1"  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Charge" border="0" color="33554432" x="1486" y="400" height="128" width="334" html.valueishtml="0"  name=charge_t visible="1"  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Écart" border="0" color="33554432" x="1819" y="400" height="128" width="334" html.valueishtml="0"  name=ecart_t visible="1"  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Solde" border="0" color="33554432" x="2153" y="400" height="128" width="329" html.valueishtml="0"  name=solde_t visible="1"  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=detail alignment="0" expression=" patient_patient_nom + ~", ~" +  patient_patient_prenom "border="0" color="33554432" x="18" y="4" height="64" width="800" format="[GENERAL]" html.valueishtml="0"  name=cp_patient visible="1"  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="536870912~tif ( mod( getrow() , 2 ) = 0 , rgb(220,220,220) , -1 )" )
column(band=detail id=7 alignment="1" tabsequence=32766 border="0" color="33554432" x="818" y="4" height="64" width="334" format="#,##0.00 $; (#,##0.00 $)" html.valueishtml="0"  name=traitements_montant_original visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=no edit.imemode=0  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="536870912~tif ( mod( getrow() , 2 ) = 0 , rgb(220,220,220) , -1 )" )
column(band=detail id=8 alignment="1" tabsequence=32766 border="0" color="33554432" x="1152" y="4" height="64" width="334" format="#,##0.00 $; (#,##0.00 $)" html.valueishtml="0"  name=montantpaye visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=no edit.imemode=0  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="536870912~tif ( mod( getrow() , 2 ) = 0 , rgb(220,220,220) , -1 )" )
compute(band=detail alignment="1" expression=" t_rdv_duree * horstep * taux "border="0" color="33554432" x="1486" y="4" height="64" width="334" format="#,##0.00 $; (#,##0.00 $)" html.valueishtml="0"  name=cp_charge visible="1"  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="536870912~tif ( mod( getrow() , 2 ) = 0 , rgb(220,220,220) , -1 )" )
compute(band=detail alignment="1" expression=" montantpaye - cp_charge "border="0" color="33554432" x="1819" y="4" height="64" width="334" format="#,##0.00 $; (#,##0.00 $)" html.valueishtml="0"  name=cp_ecart visible="1"  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="536870912~tif ( mod( getrow() , 2 ) = 0 , rgb(220,220,220) , -1 )" )
compute(band=detail alignment="1" expression=" traitements_montant_original - montantpaye "border="0" color="33554432" x="2153" y="4" height="64" width="329" format="#,##0.00 $; (#,##0.00 $)" html.valueishtml="0"  name=cp_solde visible="1"  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="536870912~tif ( mod( getrow() , 2 ) = 0 , rgb(220,220,220) , -1 )" )
column(band=detail id=17 alignment="2" tabsequence=32766 border="0" color="33554432" x="2482" y="4" height="64" width="315" format="dd/mm/yyyy" html.valueishtml="0"  name=prchcpd visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=no edit.imemode=0  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="536870912~tif ( mod( getrow() , 2 ) = 0 , rgb(220,220,220) , -1 )" )
column(band=detail id=18 alignment="1" tabsequence=32766 border="0" color="33554432" x="2798" y="4" height="64" width="265" format="[general]" html.valueishtml="0"  name=nbcheques visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=no edit.imemode=0  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="536870912~tif ( mod( getrow() , 2 ) = 0 , rgb(220,220,220) , -1 )" )
column(band=detail id=19 alignment="1" tabsequence=32766 border="0" color="33554432" x="3063" y="4" height="64" width="315" format="#,##0.00 $; (#,##0.00 $)" html.valueishtml="0"  name=totcheques visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=no edit.imemode=0  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="536870912~tif ( mod( getrow() , 2 ) = 0 , rgb(220,220,220) , -1 )" )
htmltable(border="1" )
htmlgen(clientevents="1" clientvalidation="1" clientcomputedfields="1" clientformatting="0" clientscriptable="0" generatejavascript="1" encodeselflinkargs="1" netscapelayers="0" )
export.xml(headgroups="1" includewhitespace="0" metadatatype=0 savemetadata=0 )
import.xml()
export.pdf(method=0 distill.custompostscript="0" xslfop.print="0" )
