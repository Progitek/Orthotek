$PBExportHeader$r_horimppaysage.srd
release 10.5;
datawindow(units=2 timer_interval=0 color=16777215 processing=0 HTMLDW=no print.printername="" print.documentname="Horaire" print.orientation = 1 print.margin.left = 0 print.margin.right = 0 print.margin.top = 250 print.margin.bottom = 250 print.paper.source = 0 print.paper.size = 0 print.canusedefaultprinter=yes print.prompt=no print.buttons=no print.preview.buttons=no print.cliptext=no print.overrideprintjob=no print.collate=yes print.preview.outline=yes hidegrayline=no )
header(height=302 color="536870912" )
summary(height=0 color="536870912" )
footer(height=0 color="536870912" )
detail(height=270 color="536870912" )
table(column=(type=date updatewhereclause=yes name=datecal dbname="horaire.datecal" )
 column=(type=time updatewhereclause=yes name=heure dbname="horaire.heure" )
 column=(type=char(100) updatewhereclause=yes name=patient_nom_1 dbname="horaire.patient_nom_1" )
 column=(type=char(100) updatewhereclause=yes name=patient_nom_2 dbname="horaire.patient_nom_2" )
 column=(type=char(100) updatewhereclause=yes name=patient_nom_3 dbname="horaire.patient_nom_3" )
 column=(type=char(100) updatewhereclause=yes name=patient_nom_4 dbname="horaire.patient_nom_4" )
 column=(type=char(100) updatewhereclause=yes name=horaire_patient_nom_5 dbname="horaire.patient_nom_5" )
 column=(type=char(100) updatewhereclause=yes name=horaire_patient_nom_6 dbname="horaire.patient_nom_6" )
 column=(type=char(100) updatewhereclause=yes name=ortho_id_dr_nom_complet dbname="ortho_id.dr_nom_complet" )
 column=(type=char(20) updatewhereclause=yes name=horaire_no_dossier1 dbname="horaire.no_dossier1" )
 column=(type=char(20) updatewhereclause=yes name=horaire_no_dossier2 dbname="horaire.no_dossier2" )
 column=(type=char(20) updatewhereclause=yes name=horaire_no_dossier3 dbname="horaire.no_dossier3" )
 column=(type=char(20) updatewhereclause=yes name=horaire_no_dossier4 dbname="horaire.no_dossier4" )
 column=(type=char(20) updatewhereclause=yes name=horaire_no_dossier5 dbname="horaire.no_dossier5" )
 column=(type=char(20) updatewhereclause=yes name=horaire_no_dossier6 dbname="horaire.no_dossier6" )
 column=(type=long updatewhereclause=yes name=horaire_duree1 dbname="horaire.duree1" )
 column=(type=long updatewhereclause=yes name=horaire_duree2 dbname="horaire.duree2" )
 column=(type=long updatewhereclause=yes name=horaire_duree3 dbname="horaire.duree3" )
 column=(type=long updatewhereclause=yes name=horaire_duree4 dbname="horaire.duree4" )
 column=(type=long updatewhereclause=yes name=horaire_duree5 dbname="horaire.duree5" )
 column=(type=long updatewhereclause=yes name=horaire_duree6 dbname="horaire.duree6" )
 column=(type=long updatewhereclause=yes name=horaire_patient_id_1 dbname="horaire.patient_id_1" )
 column=(type=long updatewhereclause=yes name=horaire_patient_id_2 dbname="horaire.patient_id_2" )
 column=(type=long updatewhereclause=yes name=horaire_patient_id_3 dbname="horaire.patient_id_3" )
 column=(type=long updatewhereclause=yes name=horaire_patient_id_4 dbname="horaire.patient_id_4" )
 column=(type=long updatewhereclause=yes name=horaire_patient_id_5 dbname="horaire.patient_id_5" )
 column=(type=long updatewhereclause=yes name=horaire_patient_id_6 dbname="horaire.patient_id_6" )
 column=(type=char(40) updatewhereclause=yes name=traitnom1 dbname="traitnom1" )
 column=(type=char(40) updatewhereclause=yes name=traitnom2 dbname="traitnom2" )
 column=(type=char(40) updatewhereclause=yes name=traitnom3 dbname="traitnom3" )
 column=(type=char(40) updatewhereclause=yes name=traitnom4 dbname="traitnom4" )
 column=(type=char(40) updatewhereclause=yes name=traitnom5 dbname="traitnom5" )
 column=(type=char(40) updatewhereclause=yes name=traitnom6 dbname="traitnom6" )
 column=(type=long updatewhereclause=yes name=horaire_couleur_text_1 dbname="horaire.couleur_text_1" )
 column=(type=long updatewhereclause=yes name=horaire_couleur_text_2 dbname="horaire.couleur_text_2" )
 column=(type=long updatewhereclause=yes name=horaire_couleur_text_3 dbname="horaire.couleur_text_3" )
 column=(type=long updatewhereclause=yes name=horaire_couleur_text_4 dbname="horaire.couleur_text_4" )
 column=(type=long updatewhereclause=yes name=horaire_couleur_text_5 dbname="horaire.couleur_text_5" )
 column=(type=long updatewhereclause=yes name=horaire_couleur_text_6 dbname="horaire.couleur_text_6" )
 column=(type=long updatewhereclause=yes name=horaire_colortemplate1 dbname="horaire.colortemplate1" )
 column=(type=long updatewhereclause=yes name=horaire_colortemplate2 dbname="horaire.colortemplate2" )
 column=(type=long updatewhereclause=yes name=horaire_colortemplate3 dbname="horaire.colortemplate3" )
 column=(type=long updatewhereclause=yes name=horaire_colortemplate4 dbname="horaire.colortemplate4" )
 column=(type=long updatewhereclause=yes name=horaire_colortemplate5 dbname="horaire.colortemplate5" )
 column=(type=long updatewhereclause=yes name=horaire_colortemplate6 dbname="horaire.colortemplate6" )
 column=(type=number updatewhereclause=yes name=v_arrow dbname="v_arrow" )
 column=(type=long updatewhereclause=yes name=horstep dbname="horstep" )
 column=(type=number updatewhereclause=yes name=horcolor dbname="horcolor" )
 column=(type=number updatewhereclause=yes name=horimpaff dbname="horimpaff" )
 column=(type=number updatewhereclause=yes name=horimpdubalance dbname="horimpdubalance" )
 column=(type=long updatewhereclause=yes name=v_color dbname="v_color" )
 column=(type=long updatewhereclause=yes name=traitid1 dbname="traitid1" )
 column=(type=decimal(2) updatewhereclause=yes name=totfact1 dbname="totfact1" )
 column=(type=decimal(2) updatewhereclause=yes name=fact1 dbname="fact1" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie1a dbname="totpaie1a" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie1 dbname="totpaie1" )
 column=(type=decimal(2) updatewhereclause=yes name=balance1 dbname="balance1" )
 column=(type=decimal(2) updatewhereclause=yes name=mdu1 dbname="mdu1" )
 column=(type=long updatewhereclause=yes name=traitid2 dbname="traitid2" )
 column=(type=decimal(2) updatewhereclause=yes name=totfact2 dbname="totfact2" )
 column=(type=decimal(2) updatewhereclause=yes name=fact2 dbname="fact2" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie2a dbname="totpaie2a" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie2 dbname="totpaie2" )
 column=(type=decimal(2) updatewhereclause=yes name=balance2 dbname="balance2" )
 column=(type=decimal(2) updatewhereclause=yes name=mdu2 dbname="mdu2" )
 column=(type=long updatewhereclause=yes name=traitid3 dbname="traitid3" )
 column=(type=decimal(2) updatewhereclause=yes name=totfact3 dbname="totfact3" )
 column=(type=decimal(2) updatewhereclause=yes name=fact3 dbname="fact3" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie3a dbname="totpaie3a" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie3 dbname="totpaie3" )
 column=(type=decimal(2) updatewhereclause=yes name=balance3 dbname="balance3" )
 column=(type=decimal(2) updatewhereclause=yes name=mdu3 dbname="mdu3" )
 column=(type=long updatewhereclause=yes name=traitid4 dbname="traitid4" )
 column=(type=decimal(2) updatewhereclause=yes name=totfact4 dbname="totfact4" )
 column=(type=decimal(2) updatewhereclause=yes name=fact4 dbname="fact4" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie4a dbname="totpaie4a" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie4 dbname="totpaie4" )
 column=(type=decimal(2) updatewhereclause=yes name=balance4 dbname="balance4" )
 column=(type=decimal(2) updatewhereclause=yes name=mdu4 dbname="mdu4" )
 column=(type=long updatewhereclause=yes name=traitid5 dbname="traitid5" )
 column=(type=decimal(2) updatewhereclause=yes name=totfact5 dbname="totfact5" )
 column=(type=decimal(2) updatewhereclause=yes name=fact5 dbname="fact5" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie5a dbname="totpaie5a" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie5 dbname="totpaie5" )
 column=(type=decimal(2) updatewhereclause=yes name=balance5 dbname="balance5" )
 column=(type=decimal(2) updatewhereclause=yes name=mdu5 dbname="mdu5" )
 column=(type=long updatewhereclause=yes name=traitid6 dbname="traitid6" )
 column=(type=decimal(2) updatewhereclause=yes name=totfact6 dbname="totfact6" )
 column=(type=decimal(2) updatewhereclause=yes name=fact6 dbname="fact6" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie6a dbname="totpaie6a" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie6 dbname="totpaie6" )
 column=(type=decimal(2) updatewhereclause=yes name=balance6 dbname="balance6" )
 column=(type=decimal(2) updatewhereclause=yes name=mdu6 dbname="mdu6" )
 column=(type=char(2) updatewhereclause=yes name=horaire_dt1 dbname="horaire.dt1" )
 column=(type=char(2) updatewhereclause=yes name=horaire_dt2 dbname="horaire.dt2" )
 column=(type=char(2) updatewhereclause=yes name=horaire_dt3 dbname="horaire.dt3" )
 column=(type=char(2) updatewhereclause=yes name=horaire_dt4 dbname="horaire.dt4" )
 column=(type=char(2) updatewhereclause=yes name=horaire_dt5 dbname="horaire.dt5" )
 column=(type=char(2) updatewhereclause=yes name=horaire_dt6 dbname="horaire.dt6" )
 column=(type=long updatewhereclause=yes name=colorspec dbname="colorspec" )
 column=(type=long updatewhereclause=yes name=colorhyg dbname="colorhyg" )
 retrieve="  SELECT horaire.datecal,   
         horaire.heure,   
         horaire.patient_nom_1,   
         horaire.patient_nom_2,   
         horaire.patient_nom_3,   
         horaire.patient_nom_4,  
			horaire.patient_nom_5,
			horaire.patient_nom_6,
         ortho_id.dr_nom_complet,   
         horaire.no_dossier1,   
         horaire.no_dossier2,   
         horaire.no_dossier3,   
         horaire.no_dossier4,   
         horaire.no_dossier5,
			horaire.no_dossier6, 
			horaire.duree1,   
         horaire.duree2,   
         horaire.duree3,   
         horaire.duree4,   
         horaire.duree5,
			horaire.duree6,
			horaire.patient_id_1,   
         horaire.patient_id_2,   
         horaire.patient_id_3,   
         horaire.patient_id_4,   
         horaire.patient_id_5,
			horaire.patient_id_6,
         (if horaire.traitementid1 > 0 then (select nom_traitement from type_de_traitement where type_de_traitement.type_traitement_id = horaire.traitementid1 and ortho_id = :ra_ortho) else '' endif) as traitnom1,   
			(if horaire.traitementid2 > 0 then (select nom_traitement from type_de_traitement where type_de_traitement.type_traitement_id = horaire.traitementid2 and ortho_id = :ra_ortho) else '' endif) as traitnom2,   
			(if horaire.traitementid3 > 0 then (select nom_traitement from type_de_traitement where type_de_traitement.type_traitement_id = horaire.traitementid3 and ortho_id = :ra_ortho) else '' endif) as traitnom3,   
			(if horaire.traitementid4 > 0 then (select nom_traitement from type_de_traitement where type_de_traitement.type_traitement_id = horaire.traitementid4 and ortho_id = :ra_ortho) else '' endif) as traitnom4,   
			(if horaire.traitementid5 > 0 then (select nom_traitement from type_de_traitement where type_de_traitement.type_traitement_id = horaire.traitementid5 and ortho_id = :ra_ortho) else '' endif) as traitnom5,
			(if horaire.traitementid6 > 0 then (select nom_traitement from type_de_traitement where type_de_traitement.type_traitement_id = horaire.traitementid6 and ortho_id = :ra_ortho) else '' endif) as traitnom6,   
			horaire.couleur_text_1,
			horaire.couleur_text_2,
			horaire.couleur_text_3,
			horaire.couleur_text_4,
			horaire.couleur_text_5,
			horaire.couleur_text_6,
			horaire.colortemplate1,
			horaire.colortemplate2,
			horaire.colortemplate3,
			horaire.colortemplate4,
			horaire.colortemplate5,
			horaire.colortemplate6,
			(select horarrow from t_options where ortho_id = :ra_ortho) as v_arrow,
			(select hor_step from t_options where ortho_id = :ra_ortho) as horstep,
			(select horcolor from t_options where ortho_id = :ra_ortho) as horcolor,
			(select horimpaff from t_options where ortho_id = :ra_ortho) as horimpaff,
			(select horimpdubalance from t_options where ortho_id = :ra_ortho) as horimpdubalance,
			(select fond_horaire from couleurs where ortho_id = :ra_ortho) as v_color,
			(select max(traitement_id) from traitements where patient_id = horaire.patient_id_1) as traitid1,
			(select sum(montant) from factures_traitements where traitement_id = traitid1) as totfact1,
			(select sum(montant) from factures_traitements where traitement_id = traitid1 and date_facture <= horaire.datecal) as fact1,
			(select sum(montant_recu) from paiement where traitement_patient_id = traitid1) as totpaie1a,
			(if totpaie1a is null then 0 else totpaie1a endif) as totpaie1,
			(totfact1 - totpaie1) as balance1,
			(fact1 - totpaie1) as mdu1,
			(select max(traitement_id) from traitements where patient_id = horaire.patient_id_2) as traitid2,
			(select sum(montant) from factures_traitements where traitement_id = traitid2) as totfact2,
			(select sum(montant) from factures_traitements where traitement_id = traitid2 and date_facture <= horaire.datecal) as fact2,
			(select sum(montant_recu) from paiement where traitement_patient_id = traitid2) as totpaie2a,
			(if totpaie2a is null then 0 else totpaie2a endif) as totpaie2,			
			(totfact2 - totpaie2) as balance2,
			(fact2 - totpaie2) as mdu2,
			(select max(traitement_id) from traitements where patient_id = horaire.patient_id_3) as traitid3,
			(select sum(montant) from factures_traitements where traitement_id = traitid3) as totfact3,
			(select sum(montant) from factures_traitements where traitement_id = traitid3 and date_facture <= horaire.datecal) as fact3,
			(select sum(montant_recu) from paiement where traitement_patient_id = traitid3) as totpaie3a,
			(if totpaie3a is null then 0 else totpaie3a endif) as totpaie3,			
			(totfact3 - totpaie3) as balance3,
			(fact3 - totpaie3) as mdu3,
			(select max(traitement_id) from traitements where patient_id = horaire.patient_id_4) as traitid4,
			(select sum(montant) from factures_traitements where traitement_id = traitid4) as totfact4,
			(select sum(montant) from factures_traitements where traitement_id = traitid4 and date_facture <= horaire.datecal) as fact4,
			(select sum(montant_recu) from paiement where traitement_patient_id = traitid4) as totpaie4a,
			(if totpaie4a is null then 0 else totpaie4a endif) as totpaie4,			
			(totfact4 - totpaie4) as balance4,
			(fact4 - totpaie4) as mdu4,
			(select max(traitement_id) from traitements where patient_id = horaire.patient_id_5) as traitid5,
			(select sum(montant) from factures_traitements where traitement_id = traitid5) as totfact5,
			(select sum(montant) from factures_traitements where traitement_id = traitid5 and date_facture <= horaire.datecal) as fact5,
			(select sum(montant_recu) from paiement where traitement_patient_id = traitid5) as totpaie5a,
			(if totpaie5a is null then 0 else totpaie5a endif) as totpaie5,			
			(totfact5 - totpaie5) as balance5,
			(fact5 - totpaie5) as mdu5,
			(select max(traitement_id) from traitements where patient_id = horaire.patient_id_6) as traitid6,
			(select sum(montant) from factures_traitements where traitement_id = traitid6) as totfact6,
			(select sum(montant) from factures_traitements where traitement_id = traitid6 and date_facture <= horaire.datecal) as fact6,
			(select sum(montant_recu) from paiement where traitement_patient_id = traitid6) as totpaie6a,
			(if totpaie6a is null then 0 else totpaie6a endif) as totpaie6,			
			(totfact6 - totpaie6) as balance6,
			(fact6 - totpaie6) as mdu6,
			horaire.dt1,
			horaire.dt2,
			horaire.dt3,
			horaire.dt4,
			horaire.dt5,
			horaire.dt6,
			(select color from t_color where spec = 1 and ortho_id = :ra_ortho) as colorspec,
			(select color from t_color where hyg = 1 and ortho_id = :ra_ortho) as colorhyg
    FROM horaire INNER JOIN ortho_id ON horaire.no_ortho = ortho_id.ortho_id
   WHERE ortho_id.ortho_id = :ra_ortho AND
			horaire.datecal = :ra_date AND
         (horaire.heure BETWEEN :ra_start AND :ra_end or
			 horaire.heure BETWEEN :ra_start2 AND :ra_end2)     
ORDER BY horaire.datecal ASC,   
         horaire.heure ASC " arguments=(("ra_ortho", number),("ra_date", date),("ra_start", time),("ra_end", time),("ra_start2", time),("ra_end2", time)) )
compute(band=detail alignment="0" expression="if ( horimpaff = 1 , if ( patient_nom_3 =  traitnom3[-1] and  horaire_patient_id_3 > 0, 'X' , if ( horimpdubalance = 1 and balance3 = 0 and horaire_duree3 > 0, 'K_' ,  if ( horimpdubalance = 1 and mdu3 > 0 and  horaire_duree3 > 0, '*_' , '' ) ) + patient_nom_3 ) , if ( horimpdubalance = 1 and balance3 = 0 and  horaire_duree3 > 0, 'K_' ,  if ( horimpdubalance = 1 and mdu3 > 0 and horaire_duree3 > 0, '*_' , '' ) ) + patient_nom_3 )"border="0" color="0~tif ( (patient_nom_3 = 'X' or patient_nom_3 = 'XX') and  v_arrow = 1 ,  rgb(255,255,255)  , rgb(0,0,0) )" x="3645" y="0" height="135" width="1562" format="[GENERAL]" html.valueishtml="0"  name=c3 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="553648127~tif (  horcolor = 1 , if ( patient_nom_3 = '' , if ( isnull(horaire_colortemplate3) , rgb(255,255,255) , horaire_colortemplate3 ) , horaire_couleur_text_3 ) , rgb(255,255,255) )" )
compute(band=detail alignment="0" expression="if ( horimpaff = 1 , if ( patient_nom_4 =  traitnom4[-1] and  horaire_patient_id_4 > 0, 'X' , if ( horimpdubalance = 1 and balance4 = 0 and horaire_duree4 > 0, 'K_' ,  if ( horimpdubalance = 1 and mdu4 > 0 and  horaire_duree4 > 0, '*_' , '' ) ) + patient_nom_4 ) , if ( horimpdubalance = 1 and balance4 = 0 and  horaire_duree4 > 0, 'K_' ,  if ( horimpdubalance = 1 and mdu4 > 0 and horaire_duree4 > 0, '*_' , '' ) ) + patient_nom_4 )"border="0" color="0~tif ( (patient_nom_4 = 'X' or patient_nom_4 = 'XX') and  v_arrow = 1 ,  rgb(255,255,255)  , rgb(0,0,0) )" x="5239" y="0" height="135" width="1562" format="[GENERAL]" html.valueishtml="0"  name=c4 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="553648127~tif (  horcolor = 1 , if ( patient_nom_4 = '' , if ( isnull(horaire_colortemplate4) , rgb(255,255,255) , horaire_colortemplate4 ) , horaire_couleur_text_4 ) , rgb(255,255,255) )" )
compute(band=detail alignment="0" expression="if (  horimpaff = 1 , if ( horaire_patient_nom_5 =  traitnom5[-1] and  horaire_patient_id_5 > 0, 'X' , if ( horimpdubalance = 1 and balance5 = 0 and  horaire_duree5 > 0, 'K_' ,  if ( horimpdubalance = 1 and mdu5 > 0 and horaire_duree5 > 0, '*_' , '' ) ) + horaire_patient_nom_5 ) , if ( horimpdubalance = 1 and balance5 = 0 and  horaire_duree5 > 0, 'K_' ,  if ( horimpdubalance = 1 and mdu5 > 0 and horaire_duree5 > 0, '*_' , '' ) ) + horaire_patient_nom_5 )"border="0" color="0~tif (  (horaire_patient_nom_5 = 'X' or  horaire_patient_nom_5 = 'XX') and  v_arrow = 1 ,  rgb(255,255,255)  , rgb(0,0,0) )" x="6833" y="0" height="135" width="1562" format="[GENERAL]" html.valueishtml="0"  name=c5 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="553648127~tif (  horcolor = 1 , if (  horaire_patient_nom_5 = '' , if ( isnull(horaire_colortemplate5) , rgb(255,255,255) , horaire_colortemplate5 ) , horaire_couleur_text_5 ) ,  rgb(255,255,255) )" )
compute(band=detail alignment="0" expression="if (  horimpaff = 1 , if ( horaire_patient_nom_6 =  traitnom6[-1] and  horaire_patient_id_6 > 0, 'X' , if ( horimpdubalance = 1 and balance6 = 0 and  horaire_duree6 > 0, 'K_' ,  if ( horimpdubalance = 1 and mdu6 > 0 and horaire_duree6 > 0, '*_' , '' ) ) + horaire_patient_nom_6 ) , if ( horimpdubalance = 1 and balance6 = 0 and  horaire_duree6 > 0, 'K_' ,  if ( horimpdubalance = 1 and mdu6 > 0 and horaire_duree6 > 0, '*_' , '' ) ) + horaire_patient_nom_6 )"border="0" color="0~tif (  (horaire_patient_nom_6 = 'X' or  horaire_patient_nom_6 = 'XX') and  v_arrow = 1 ,  rgb(255,255,255)  , rgb(0,0,0) )" x="8427" y="0" height="135" width="1562" format="[GENERAL]" html.valueishtml="0"  name=compute_6 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="553648127~tif (  horcolor = 1 , if (  horaire_patient_nom_6 = '' , if ( isnull(horaire_colortemplate6) , rgb(255,255,255) , horaire_colortemplate6 ) , horaire_couleur_text_6 ) ,  rgb(255,255,255) )" )
compute(band=detail alignment="0" expression="if (  horimpaff = 1 , if ( horaire_duree6 > 0, if ( isnull(traitnom6), if ( isnull ( horaire_no_dossier6 ), '' , horaire_no_dossier6 ) ,traitnom6 + '  ' + if ( isnull ( horaire_no_dossier6 ), '' , horaire_no_dossier6 ) ) , '' ) , '' )
"border="0" color="0" x="8427" y="135" height="125" width="1562" format="[GENERAL]" html.valueishtml="0"  name=compute_7 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" font.italic="1" background.mode="0" background.color="553648127~tif (  horcolor = 1 , if (  horaire_patient_nom_6 = '' , if ( isnull(horaire_colortemplate6) , rgb(255,255,255) , horaire_colortemplate6 ) , horaire_couleur_text_6 ) , rgb(255,255,255) )" )
line(band=header x1="0" y1="291" x2="10489" y2="291"  name=l_1 visible="1" pen.style="0" pen.width="10" pen.color="0"  background.mode="1" background.color="553648127" )
text(band=header alignment="0" text="Horaire pour :" border="0" color="0" x="0" y="0" height="156" width="1229" html.valueishtml="0"  name=t_squedfor visible="1"  font.face="Arial" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
text(band=header alignment="1" text="date" border="0" color="0" x="8645" y="0" height="156" width="1843" html.valueishtml="0"  name=t_date visible="1"  font.face="Arial" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" font.italic="1" background.mode="2" background.color="16777215" )
column(band=header id=9 alignment="0" tabsequence=32766 border="0" color="0" x="1270" y="0" height="156" width="4781" format="[general]" html.valueishtml="0"  name=ortho_id_dr_nom_complet visible="1" edit.limit=0 edit.case=any edit.autoselect=yes  font.face="Arial" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
text(band=header alignment="2" text="Chaise 1" border="0" color="0" x="458" y="166" height="125" width="1562" html.valueishtml="0"  name=t_c1 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127"  height.autosize=yes)
text(band=header alignment="2" text="Chaise 2" border="0" color="0" x="2052" y="166" height="125" width="1562" html.valueishtml="0"  name=t_c2 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127"  height.autosize=yes)
text(band=header alignment="2" text="Chaise 3" border="0" color="0" x="3645" y="166" height="125" width="1562" html.valueishtml="0"  name=t_c3 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127"  height.autosize=yes)
text(band=header alignment="2" text="Chaise 4" border="0" color="0" x="5239" y="166" height="125" width="1562" html.valueishtml="0"  name=t_c4 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127"  height.autosize=yes)
text(band=header alignment="2" text="Chaise 5" border="0" color="0" x="6833" y="166" height="125" width="1562" html.valueishtml="0"  name=t_c5 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127"  height.autosize=yes)
text(band=header alignment="2" text="Chaise 6" border="0" color="0" x="8427" y="166" height="145" width="1562" html.valueishtml="0"  name=t_2 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127"  height.autosize=yes)
line(band=detail x1="427" y1="0" x2="427" y2="260"  name=l_3 visible="1" pen.style="0" pen.width="10" pen.color="0"  background.mode="1" background.color="553648127" )
line(band=detail x1="2031" y1="0" x2="2031" y2="260"  name=l_7 visible="1" pen.style="0" pen.width="10" pen.color="0"  background.mode="1" background.color="553648127" )
line(band=detail x1="1239" y1="0" x2="1239" y2="250"  name=l_13 visible="1~tif ( patient_nom_1 = 'X' and  v_arrow = 1 , 1 , 0 )" pen.style="0" pen.width="31" pen.color="0"  background.mode="2" background.color="16777215" )
bitmap(band=detail filename="C:\ii4net\orthotek\images\arrow.gif" x="1104" y="0" height="239" width="291" border="0"  name=p_1 visible="1~tif ( patient_nom_1 = 'XX' and  v_arrow = 1 , 1 , 0 )" )
column(band=detail id=2 alignment="0" tabsequence=32766 border="0" color="0" x="20" y="31" height="166" width="395" format="[time]" html.valueishtml="0"  name=heure visible="1" height.autosize=yes editmask.mask="hh:mm" editmask.focusrectangle=no  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
line(band=detail x1="6812" y1="0" x2="6812" y2="260"  name=l_4 visible="1" pen.style="0" pen.width="10" pen.color="0"  background.mode="1" background.color="553648127" )
line(band=detail x1="8406" y1="0" x2="8406" y2="260"  name=l_8 visible="1" pen.style="0" pen.width="10" pen.color="0"  background.mode="1" background.color="553648127" )
line(band=detail x1="3625" y1="0" x2="3625" y2="260"  name=l_5 visible="1" pen.style="0" pen.width="10" pen.color="0"  background.mode="1" background.color="553648127" )
line(band=detail x1="5218" y1="0" x2="5218" y2="260"  name=l_6 visible="1" pen.style="0" pen.width="10" pen.color="0"  background.mode="1" background.color="553648127" )
line(band=detail x1="7593" y1="0" x2="7593" y2="250"  name=l_12 visible="1~tif (  horaire_patient_nom_5 = 'X' and  v_arrow = 1 , 1 , 0 )" pen.style="0" pen.width="31" pen.color="0"  background.mode="2" background.color="16777215" )
line(band=detail x1="2958" y1="0" x2="2958" y2="250"  name=l_11 visible="1~tif ( patient_nom_2 = 'X' and  v_arrow = 1 , 1 , 0 )" pen.style="0" pen.width="31" pen.color="0"  background.mode="2" background.color="16777215" )
bitmap(band=detail filename="C:\ii4net\orthotek\images\arrow.gif" x="2822" y="0" height="239" width="291" border="0"  name=p_2 visible="1~tif ( patient_nom_2 = 'XX' and  v_arrow = 1 , 1 , 0 )" )
line(band=detail x1="4416" y1="0" x2="4416" y2="250"  name=l_10 visible="1~tif ( patient_nom_3 = 'X' and  v_arrow = 1 , 1 , 0 )" pen.style="0" pen.width="31" pen.color="0"  background.mode="2" background.color="16777215" )
bitmap(band=detail filename="C:\ii4net\orthotek\images\arrow.gif" x="4270" y="0" height="239" width="291" border="0"  name=p_3 visible="1~tif ( patient_nom_3 = 'XX' and  v_arrow = 1 , 1 , 0 )" )
line(band=detail x1="6000" y1="0" x2="6000" y2="250"  name=l_9 visible="1~tif ( patient_nom_4 = 'X' and  v_arrow = 1 , 1 , 0 )" pen.style="0" pen.width="31" pen.color="0"  background.mode="2" background.color="16777215" )
line(band=detail x1="10000" y1="0" x2="10000" y2="260"  name=l_15 visible="1" pen.style="0" pen.width="10" pen.color="0"  background.mode="1" background.color="553648127" )
line(band=detail x1="9197" y1="0" x2="9197" y2="250"  name=l_16 visible="1~tif (  horaire_patient_nom_6 = 'X' and  v_arrow = 1 , 1 , 0 )" pen.style="0" pen.width="31" pen.color="0"  background.mode="2" background.color="16777215" )
line(band=detail x1="20" y1="260" x2="10500" y2="260"  name=l_14 visible="1~tif (  minute ( heure ) >= ( 60 -  horstep ) , 1 , 0 )" pen.style="0" pen.width="20" pen.color="0"  background.mode="1" background.color="553648127" )
compute(band=detail alignment="0" expression="if ( horimpaff = 1 , if ( patient_nom_1 =  traitnom1[-1] and  horaire_patient_id_1 > 0, 'X' , if ( horimpdubalance = 1 and balance1 = 0 and horaire_duree1 > 0, 'K_' ,  if ( horimpdubalance = 1 and mdu1 > 0 and  horaire_duree1 > 0, '*_' , '' ) ) + patient_nom_1 ) , if ( horimpdubalance = 1 and balance1 = 0 and  horaire_duree1 > 0, 'K_' ,  if ( horimpdubalance = 1 and mdu1 > 0 and horaire_duree1 > 0, '*_' , '' ) ) + patient_nom_1 )"border="0" color="0~tif ( (patient_nom_1 = 'X' or patient_nom_1 = 'XX') and  v_arrow = 1 ,  rgb(255,255,255)  , rgb(0,0,0) )" x="458" y="0" height="135" width="1562" format="[GENERAL]" html.valueishtml="0"  name=c1 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="553648127~tif (  horcolor = 1 , if ( patient_nom_1 = '' , if ( isnull(horaire_colortemplate1) , rgb(255,255,255) , horaire_colortemplate1 ) , horaire_couleur_text_1 ) , rgb(255,255,255) )       " )
compute(band=detail alignment="0" expression="if (  horimpaff = 1 , if ( horaire_duree1 > 0, if ( isnull(traitnom1), if ( isnull ( horaire_no_dossier1 ), '' , horaire_no_dossier1 ) ,traitnom1 + '  ' + if ( isnull ( horaire_no_dossier1 ), '' , horaire_no_dossier1 ) ) , '' ) , '' )
"border="0" color="0" x="458" y="135" height="125" width="1562" format="[GENERAL]" html.valueishtml="0"  name=compute_1 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" font.italic="1" background.mode="0" background.color="553648127~tif (  horcolor = 1 , if ( patient_nom_1 = '' , if ( isnull(horaire_colortemplate1) , rgb(255,255,255) , horaire_colortemplate1 ) , horaire_couleur_text_1 ) , rgb(255,255,255) )" )
compute(band=detail alignment="0" expression="if (  horimpaff = 1 , if ( patient_nom_2 =  traitnom2[-1] and  horaire_patient_id_2 > 0, 'X' , if ( horimpdubalance = 1 and balance2 = 0 and  horaire_duree2 > 0, 'K_' ,  if ( horimpdubalance = 1 and mdu2 > 0 and horaire_duree2 > 0, '*_' , '' ) ) + patient_nom_2 ) , if ( horimpdubalance = 1 and balance2 = 0 and  horaire_duree2 > 0, 'K_' ,  if ( horimpdubalance = 1 and mdu2 > 0 and horaire_duree2 > 0, '*_' , '' ) ) + patient_nom_2 )"border="0" color="0~tif ( (patient_nom_2 = 'X' or patient_nom_2 = 'XX') and  v_arrow = 1 ,  rgb(255,255,255)  , rgb(0,0,0) )" x="2052" y="0" height="135" width="1562" format="[GENERAL]" html.valueishtml="0"  name=c2 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="553648127~tif (  horcolor = 1 , if ( patient_nom_2 = '' , if ( isnull(horaire_colortemplate2) , rgb(255,255,255) , horaire_colortemplate2 ) , horaire_couleur_text_2 ) ,  rgb(255,255,255) )" )
compute(band=detail alignment="0" expression="if (  horimpaff = 1 , if ( horaire_duree2 > 0, if ( isnull(traitnom2), if ( isnull ( horaire_no_dossier2 ), '' , horaire_no_dossier2 ) ,traitnom2 + '  ' + if ( isnull ( horaire_no_dossier2 ), '' , horaire_no_dossier2 ) ) , '' ) , '' )
"border="0" color="0" x="2052" y="135" height="125" width="1562" format="[GENERAL]" html.valueishtml="0"  name=compute_2 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" font.italic="1" background.mode="0" background.color="553648127~tif (  horcolor = 1 , if ( patient_nom_2 = '' , if ( isnull(horaire_colortemplate2) , rgb(255,255,255) , horaire_colortemplate2 ) , horaire_couleur_text_2 ) , rgb(255,255,255) )" )
compute(band=detail alignment="0" expression="if (  horimpaff = 1 , if ( horaire_duree3 > 0, if ( isnull(traitnom3), if ( isnull ( horaire_no_dossier3 ), '' , horaire_no_dossier3 ) ,traitnom3 + '  ' + if ( isnull ( horaire_no_dossier3 ), '' , horaire_no_dossier3 ) ) , '' ) , '' )
"border="0" color="0" x="3645" y="135" height="125" width="1562" format="[GENERAL]" html.valueishtml="0"  name=compute_3 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" font.italic="1" background.mode="0" background.color="553648127~tif (  horcolor = 1 , if ( patient_nom_3 = '' , if ( isnull(horaire_colortemplate3) , rgb(255,255,255) , horaire_colortemplate3 ) , horaire_couleur_text_3 ) , rgb(255,255,255) )" )
compute(band=detail alignment="0" expression="if (  horimpaff = 1 , if ( horaire_duree4 > 0, if ( isnull(traitnom4), if ( isnull ( horaire_no_dossier4 ), '' , horaire_no_dossier4 ) ,traitnom4 + '  ' + if ( isnull ( horaire_no_dossier4 ), '' , horaire_no_dossier4 ) ) , '' ) , '' )
"border="0" color="0" x="5239" y="135" height="125" width="1562" format="[GENERAL]" html.valueishtml="0"  name=compute_4 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" font.italic="1" background.mode="0" background.color="553648127~tif (  horcolor = 1 , if ( patient_nom_4 = '' , if ( isnull(horaire_colortemplate4) , rgb(255,255,255) , horaire_colortemplate4 ) , horaire_couleur_text_4 ) , rgb(255,255,255) )" )
compute(band=detail alignment="0" expression="if (  horimpaff = 1 , if ( horaire_duree5 > 0, if ( isnull(traitnom5), if ( isnull ( horaire_no_dossier5 ), '' , horaire_no_dossier5 ) ,traitnom5 + '  ' + if ( isnull ( horaire_no_dossier5 ), '' , horaire_no_dossier5 ) ) , '' ) , '' )
"border="0" color="0" x="6833" y="135" height="125" width="1562" format="[GENERAL]" html.valueishtml="0"  name=compute_5 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" font.italic="1" background.mode="0" background.color="553648127~tif (  horcolor = 1 , if (  horaire_patient_nom_5 = '' , if ( isnull(horaire_colortemplate5) , rgb(255,255,255) , horaire_colortemplate5 ) , horaire_couleur_text_5 ) , rgb(255,255,255) )" )
column(band=detail id=94 alignment="0" tabsequence=32766 border="2" color="0" x="10041" y="42" height="166" width="62" format="[general]" html.valueishtml="0"  name=horaire_dt1 visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=no  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="16777215~tif (   horaire_dt1  = 'H' ,  colorhyg , if ( horaire_dt1  = 'D' ,  colorspec  , rgb ( 255,255,255 ) ) )" )
column(band=detail id=95 alignment="0" tabsequence=32766 border="2" color="0" x="10114" y="42" height="166" width="62" format="[general]" html.valueishtml="0"  name=horaire_dt2 visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=no  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="16777215~tif (   horaire_dt2  = 'H' ,  colorhyg , if ( horaire_dt2  = 'D' ,  colorspec  , rgb ( 255,255,255 ) ) )" )
column(band=detail id=96 alignment="0" tabsequence=32766 border="2" color="0" x="10187" y="42" height="166" width="62" format="[general]" html.valueishtml="0"  name=horaire_dt3 visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=no  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="16777215~tif (   horaire_dt3  = 'H' ,  colorhyg , if ( horaire_dt3  = 'D' ,  colorspec  , rgb ( 255,255,255 ) ) )" )
column(band=detail id=97 alignment="0" tabsequence=32766 border="2" color="0" x="10260" y="42" height="166" width="62" format="[general]" html.valueishtml="0"  name=horaire_dt4 visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=no  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="16777215~tif (   horaire_dt4  = 'H' ,  colorhyg , if ( horaire_dt4  = 'D' ,  colorspec  , rgb ( 255,255,255 ) ) )" )
column(band=detail id=98 alignment="0" tabsequence=32766 border="2" color="0" x="10333" y="42" height="166" width="62" format="[general]" html.valueishtml="0"  name=horaire_dt5 visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=no  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="16777215~tif (   horaire_dt5  = 'H' ,  colorhyg , if ( horaire_dt5  = 'D' ,  colorspec  , rgb ( 255,255,255 ) ) )" )
column(band=detail id=99 alignment="0" tabsequence=32766 border="2" color="0" x="10406" y="42" height="166" width="62" format="[general]" html.valueishtml="0"  name=horaire_dt6 visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=no  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="0" background.color="16777215~tif (   horaire_dt6  = 'H' ,  colorhyg , if ( horaire_dt6  = 'D' ,  colorspec  , rgb ( 255,255,255 ) ) )" )
line(band=detail x1="0" y1="250" x2="10479" y2="250"  name=l_2 visible="1" pen.style="0" pen.width="10~tif (  integer( mid ( string(  heure ) , 4 , 2 ) ) >= 45  , 3 , 1 )" pen.color="0"  background.mode="1" background.color="553648127" )
bitmap(band=detail filename="C:\ii4net\orthotek\images\arrow.gif" x="5864" y="0" height="239" width="291" border="0"  name=p_4 visible="1~tif ( patient_nom_4 = 'XX' and  v_arrow = 1 , 1 , 0 )" )
bitmap(band=detail filename="C:\ii4net\orthotek\images\arrow.gif" x="7458" y="0" height="239" width="291" border="0"  name=p_5 visible="1~tif (  horaire_patient_nom_5 = 'XX' and  v_arrow = 1 , 1 , 0 )" )
bitmap(band=detail filename="C:\ii4net\orthotek\images\arrow.gif" x="9062" y="0" height="239" width="291" border="0"  name=p_6 visible="1~tif (  horaire_patient_nom_6 = 'XX' and  v_arrow = 1 , 1 , 0 )" )
htmltable(border="1" )
htmlgen(clientevents="1" clientvalidation="1" clientcomputedfields="1" clientformatting="0" clientscriptable="0" generatejavascript="1" encodeselflinkargs="1" netscapelayers="0" pagingmethod=0 generatedddwframes="1" )
xhtmlgen() cssgen(sessionspecific="0" )
xmlgen(inline="0" )
xsltgen()
jsgen()
export.xml(headgroups="1" includewhitespace="0" metadatatype=0 savemetadata=0 )
import.xml()
export.pdf(method=0 distill.custompostscript="0" xslfop.print="0" )
export.xhtml()
 