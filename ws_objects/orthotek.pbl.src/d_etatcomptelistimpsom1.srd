$PBExportHeader$d_etatcomptelistimpsom1.srd
release 7;
datawindow(units=0 timer_interval=0 color=80269524 processing=0 HTMLDW=no print.documentname="" print.orientation = 0 print.margin.left = 300 print.margin.right = 110 print.margin.top = 96 print.margin.bottom = 96 print.paper.source = 0 print.paper.size = 0 print.prompt=no print.buttons=no print.preview.buttons=no )
header(height=1932 color="536870912" )
summary(height=4 color="536870912" )
footer(height=80 color="536870912" )
detail(height=184 color="536870912" )
table(column=(type=long updatewhereclause=yes identity=yes name=trait dbname="traitements.trait" )
 column=(type=decimal(2) updatewhereclause=yes name=traitements_montant_original dbname="traitements.montant_original" )
 column=(type=decimal(2) updatewhereclause=yes name=totfact1 dbname="totfact1" )
 column=(type=decimal(2) updatewhereclause=yes name=totfact dbname="totfact" )
 column=(type=decimal(2) updatewhereclause=yes name=dufact1 dbname="dufact1" )
 column=(type=decimal(2) updatewhereclause=yes name=dufact dbname="dufact" )
 column=(type=decimal(2) updatewhereclause=yes name=paie1 dbname="paie1" )
 column=(type=decimal(2) updatewhereclause=yes name=totpaie dbname="totpaie" )
 column=(type=char(50) updatewhereclause=yes name=patient_patient_nom dbname="patient.patient_nom" )
 column=(type=char(50) updatewhereclause=yes name=patient_patient_prenom dbname="patient.patient_prenom" )
 column=(type=char(27) updatewhereclause=yes name=patient_nom_pere dbname="patient.nom_pere" )
 column=(type=char(15) updatewhereclause=yes name=patient_no_tel_pere dbname="patient.no_tel_pere" )
 column=(type=char(27) updatewhereclause=yes name=patient_nom_mere dbname="patient.nom_mere" )
 column=(type=char(15) updatewhereclause=yes name=patient_no_tel_mere dbname="patient.no_tel_mere" )
 column=(type=long updatewhereclause=yes name=patient_no_dossier dbname="patient.no_dossier" )
 column=(type=long updatewhereclause=yes identity=yes name=patient_patient_id dbname="patient.patient_id" )
 column=(type=char(30) updatewhereclause=yes name=ortho_id_dr_nom_complet dbname="ortho_id.dr_nom_complet" )
 column=(type=char(50) updatewhereclause=yes name=ortho_id_dr_adresse dbname="ortho_id.dr_adresse" )
 column=(type=char(30) updatewhereclause=yes name=ortho_id_dr_ville dbname="ortho_id.dr_ville" )
 column=(type=char(30) updatewhereclause=yes name=ortho_id_dr_province dbname="ortho_id.dr_province" )
 column=(type=char(7) updatewhereclause=yes name=ortho_id_dr_code_postal dbname="ortho_id.dr_code_postal" )
 column=(type=char(15) updatewhereclause=yes name=ortho_id_dr_tel_bur dbname="ortho_id.dr_tel_bur" )
 column=(type=date updatewhereclause=yes name=lastpaie dbname="lastpaie" )
 retrieve="  SELECT 	traitements.traitement_id as trait,
				traitements.montant_original,
            (select sum(montant) from factures_traitements where traitement_id = trait) as totfact1,
				(if totfact1 is null then 0 else totfact1 endif) as totfact,
				(select sum(montant) from factures_traitements where traitement_id = trait) as dufact1,
				(if dufact1 is null then 0 else dufact1 endif) as dufact,
				(select sum(montant_recu) from paiement where traitement_patient_id = trait ) as paie1 ,
            (if paie1 is null then 0 else paie1 endif) as totpaie,
				patient.patient_nom,
            patient.patient_prenom,
				patient.nom_pere,
				patient.no_tel_pere,
				patient.nom_mere,
				patient.no_tel_mere,
				patient.no_dossier,
				patient.patient_id,
				ortho_id.dr_nom_complet,
				ortho_id.dr_adresse,
				ortho_id.dr_ville,
				ortho_id.dr_province,
				ortho_id.dr_code_postal,
				ortho_id.dr_tel_bur,
				(select max(date_paiement) from paiement where traitement_patient_id = trait) as lastpaie
	  FROM 	patient  INNER JOIN traitements ON traitements.patient_id = patient.patient_id   
   						INNER JOIN ortho_id ON patient.no_ortho = ortho_id.ortho_id
		WHERE totfact > totpaie
   ORDER BY patient_nom ASC, patient_prenom ASC
" )
group(level=1 header.height=180 trailer.height=1432 by=("patient_patient_id" ) newpage=yes header.color="536870912" trailer.color="536870912" )
roundrectangle(band=header ellipseheight="36" ellipsewidth="41"x="14" y="836" height="664" width="3090"  name=rr_3 brush.hatch="6" brush.color="16777215" pen.style="0" pen.width="5" pen.color="0"  background.mode="2" background.color="16777215" )
roundrectangle(band=header ellipseheight="36" ellipsewidth="41"x="567" y="1172" height="216" width="485"  name=rr_8 brush.hatch="6" brush.color="16777215" pen.style="0" pen.width="5" pen.color="0"  background.mode="2" background.color="16777215" )
rectangle(band=header x="18" y="1764" height="172" width="3090"  name=r_1 brush.hatch="6" brush.color="16777215" pen.style="0" pen.width="5" pen.color="0"  background.mode="2" background.color="16777215" )
roundrectangle(band=header ellipseheight="36" ellipsewidth="41"x="1998" y="1172" height="216" width="485"  name=rr_9 brush.hatch="6" brush.color="16777215" pen.style="0" pen.width="9" pen.color="0"  background.mode="2" background.color="16777215" )
roundrectangle(band=header ellipseheight="36" ellipsewidth="41"x="14" y="1544" height="180" width="3090"  name=rr_5 brush.hatch="6" brush.color="16777215" pen.style="0" pen.width="5" pen.color="0"  background.mode="2" background.color="16777215" )
text(band=header alignment="2" text="ÉTAT DE COMPTE / STATEMENT" border="0" color="0" x="37" y="1592" height="92" width="3031"  name=t_3  font.face="Arial" font.height="-14" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
text(band=header alignment="1" text="Mère:" border="0" color="0" x="87" y="936" height="64" width="151"  name=t_5  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="1" text="Tél.:" border="0" color="0" x="123" y="1020" height="64" width="114"  name=t_7  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Veuillez détacher cette partie et la retourner avec votre paiement / Please detach this portion and return with your payment" border="0" color="0" x="37" y="1428" height="60" width="3045"  name=t_2  font.face="Arial" font.height="-9" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=header id=13 alignment="0" tabsequence=32766 border="0" color="0" x="274" y="936" height="64" width="731" format="[general]"  name=patient_nom_mere edit.limit=0 edit.case=any edit.autoselect=yes  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=header id=14 alignment="0" tabsequence=32766 border="0" color="0" x="274" y="1020" height="64" width="731" format="[general]"  name=patient_no_tel_mere editmask.mask="(XXX) XXX-XXXX" editmask.focusrectangle=no  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="1" text="Père:" border="0" color="0" x="1083" y="936" height="64" width="142"  name=t_6  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="1" text="Tél.:" border="0" color="0" x="1111" y="1020" height="64" width="114"  name=t_8  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=header id=12 alignment="0" tabsequence=32766 border="0" color="0" x="1257" y="1020" height="64" width="731" format="[general]"  name=patient_no_tel_pere editmask.mask="(XXX) XXX-XXXX" editmask.focusrectangle=no  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=header id=11 alignment="0" tabsequence=32766 border="0" color="0" x="1257" y="936" height="64" width="731" format="[general]"  name=patient_nom_pere edit.limit=0 edit.case=any edit.autoselect=yes  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
roundrectangle(band=header ellipseheight="36" ellipsewidth="41"x="14" y="684" height="112" width="3090"  name=rr_2 brush.hatch="6" brush.color="16777215" pen.style="0" pen.width="5" pen.color="0"  background.mode="2" background.color="16777215" )
text(band=header alignment="2" text="Date:" border="0" color="0" x="41" y="708" height="64" width="142"  name=t_9  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=header alignment="0" expression="today()"border="0" color="0" x="206" y="708" height="64" width="457" format="[general]"  name=date_1  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Dossier:" border="0" color="0" x="2181" y="708" height="64" width="219"  name=t_11  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=header id=15 alignment="0" tabsequence=32766 border="0" color="0" x="2427" y="708" height="64" width="645" format="[general]"  name=patient_no_dossier edit.limit=0 edit.case=any edit.autoselect=yes  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Référence:" border="0" color="0" x="681" y="708" height="64" width="283"  name=t_10  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=header alignment="0" expression=" patient_patient_nom + ' ' + patient_patient_prenom "border="0" color="0" x="987" y="708" height="64" width="1170" format="[GENERAL]"  name=compute_1  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
roundrectangle(band=header ellipseheight="36" ellipsewidth="41"x="14" y="64" height="572" width="3090"  name=rr_1 brush.hatch="6" brush.color="16777215" pen.style="0" pen.width="5" pen.color="0"  background.mode="2" background.color="16777215" )
column(band=header id=17 alignment="2" tabsequence=32766 border="0" color="0" x="46" y="156" height="64" width="3031" format="[general]"  name=ortho_id_dr_nom_complet edit.limit=0 edit.case=any edit.autoselect=yes  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=header id=18 alignment="2" tabsequence=32766 border="0" color="0" x="46" y="236" height="64" width="3031" format="[general]"  name=ortho_id_dr_adresse edit.limit=0 edit.case=any edit.autoselect=yes  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=header alignment="2" expression=" ortho_id_dr_ville  + ' ( ' +  ortho_id_dr_province  + ' )'"border="0" color="0" x="46" y="316" height="64" width="3031" format="[GENERAL]"  name=compute_9  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=header id=21 alignment="2" tabsequence=32766 border="0" color="0" x="46" y="396" height="64" width="3031" format="[general]"  name=ortho_id_dr_code_postal editmask.mask="XXX XXX" editmask.focusrectangle=no  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=header id=22 alignment="2" tabsequence=32766 border="0" color="0" x="46" y="476" height="64" width="3031" format="[general]"  name=ortho_id_dr_tel_bur editmask.mask="(###) ###-####" editmask.focusrectangle=no  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Paiement inclus" border="0" color="0" x="2075" y="1184" height="56" width="338"  name=t_18  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
text(band=header alignment="2" text="Payment enclosed" border="0" color="0" x="2043" y="1236" height="56" width="402"  name=t_19  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
rectangle(band=header.1 x="14" y="0" height="172" width="3090"  name=r_2 brush.hatch="6" brush.color="16777215" pen.style="0" pen.width="5" pen.color="0"  background.mode="2" background.color="16777215" )
roundrectangle(band=detail ellipseheight="36" ellipsewidth="41"x="14" y="0" height="180" width="3090"  name=rr_4 brush.hatch="6" brush.color="16777215" pen.style="0" pen.width="5" pen.color="0"  background.mode="2" background.color="16777215" )
text(band=detail alignment="1" text="Veuillez payer ce montantPlease pay this amount" border="0" color="0" x="640" y="28" height="128" width="1371"  name=t_12  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=detail alignment="0" expression="   dufact -  totpaie "border="0" color="0" x="2117" y="56" height="64" width="622" format="#,##0.00 $; (#,##0.00 $)"  name=compute_2  font.face="Arial" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
roundrectangle(band=trailer.1 ellipseheight="36" ellipsewidth="41"x="14" y="12" height="1412" width="3090"  name=rr_6 brush.hatch="6" brush.color="16777215" pen.style="0" pen.width="5" pen.color="0"  background.mode="2" background.color="16777215" )
text(band=trailer.1 alignment="1" text="Remarques / Remarks" border="0" color="0" x="46" y="40" height="64" width="594"  name=t_13  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=footer alignment="0" text="Imprimer par ©Orthotek le " border="0" color="0" x="14" y="8" height="64" width="704"  name=t_4  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
compute(band=footer alignment="0" expression="today()"border="0" color="0" x="745" y="8" height="64" width="421" format="[SHORTDATE]"  name=compute_8  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
text(band=header alignment="2" text="Dernier paiementreçu" border="0" color="0" x="50" y="1788" height="128" width="617"  name=t_1  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=header.1 id=23 alignment="2" tabsequence=32766 border="0" color="0" x="50" y="52" height="64" width="617" format="[general]"  name=lastpaie editmask.mask="dd/mm/yyyy" editmask.focusrectangle=no  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Solde" border="0" color="0" x="2528" y="1852" height="64" width="544"  name=fact90_t  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=header.1 alignment="2" expression=" totfact  -  totpaie "border="0" color="0" x="2528" y="52" height="64" width="544" format="#,##0.00 $; (#,##0.00 $)"  name=compute_90  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Versement dû" border="0" color="0" x="1883" y="1852" height="64" width="622"  name=fact60_t  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=header.1 alignment="2" expression="   dufact -  totpaie "border="0" color="0" x="1883" y="52" height="64" width="622" format="#,##0.00 $; (#,##0.00 $)"  name=compute_60  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Total des 
 versements effectués" border="0" color="0" x="1248" y="1784" height="132" width="613"  name=fact30_t  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=header.1 id=8 alignment="2" tabsequence=32766 border="0" color="0" x="1248" y="52" height="64" width="613" format="#,##0.00 $; (#,##0.00 $)"  name=totpaie edit.limit=0 edit.case=any edit.autoselect=yes  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Coût dutraitement" border="0" color="0" x="695" y="1788" height="128" width="526"  name=factc_t  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=header.1 id=2 alignment="2" tabsequence=32766 border="0" color="0" x="695" y="52" height="64" width="526" format="#,##0.00 $; (#,##0.00 $)"  name=traitements_montant_original edit.limit=0 edit.case=any edit.autoselect=yes  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header alignment="2" text="Versement dû" border="0" color="0" x="654" y="1184" height="56" width="311"  name=t_16  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
compute(band=header alignment="2" expression="  dufact -  totpaie "border="0" color="0" x="608" y="1304" height="64" width="407" format="#,##0.00 $; (#,##0.00 $)"  name=compute_4  font.face="Arial" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
htmltable(border="1" )
htmlgen(clientevents="1" clientvalidation="1" clientcomputedfields="1" clientformatting="0" clientscriptable="0" generatejavascript="1" )
